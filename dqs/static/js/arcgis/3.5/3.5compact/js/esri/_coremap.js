/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
define("esri/_coremap",["require","dojo/_base/kernel","dojo/_base/declare","dojo/_base/connect","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/array","dojo/_base/event","dojo/_base/unload","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/sniff","dijit/registry","dojox/gfx/matrix","esri/kernel","esri/config","esri/lang","esri/Evented","esri/fx","esri/deferredUtils","esri/tileUtils","esri/geometry/Point","esri/geometry/ScreenPoint","esri/geometry/Extent","esri/geometry/Rect","esri/geometry/mathUtils","esri/geometry/scaleUtils","esri/geometry/screenUtils","esri/geometry/webMercatorUtils","esri/layers/GraphicsLayer","esri/layers/TileInfo","esri/layers/LOD","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/OpenStreetMapLayer","esri/dijit/Popup","dojo/uacss"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,LOD,_23,_24,_25){var _26=_1f.toMapPoint,_27=_1f.toScreenPoint,dc=_4.connect,ddc=_4.disconnect,dh=_6.hitch,ds=_f.set,iOf=_7.indexOf,_28=_6.mixin,uid=0,_29=_13.defaults.map,_2a=1000000,_2b=0.75,_2c=0.25,_2d=3,_2e=20,_2f=40;function _30(_31,_32){var _33=_31.lods;_33.sort(function(l1,l2){if(l1.scale>l2.scale){return -1;}else{if(l1.scale<l2.scale){return 1;}}return 0;});var _34=[];_33=_7.filter(_33,function(l){if(iOf(_34,l.scale)===-1){_34.push(l.scale);return true;}});var pl=(_32.lods=[]),l;_7.forEach(_33,function(lod,_35){l=(pl[_35]=new LOD(lod));l.level=_35;});_32.tileInfo=new _22(_28(_31,{lods:pl}));};var _36=_3([_15],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:"Unable to find basemap definition for: \"${basemapName}\". Try one of these: ${list}",invalidBasemap:"Unable to add basemap: \"${basemapName}\".",unknownLayerType:"Unknown basemap layer type: \"${type}\" found in basemap definition for: \"${basemapName}\".",constructor:function(_37,_38){this.registerConnectEvents("esri._CoreMap",{"basemap-change":true,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":true,"layers-reordered":["layerIds"],"load":["map"],"pan":["extent","delta"],"pan-end":["extent","delta"],"pan-start":["extent","screenPoint"],"reposition":["x","y"],"resize":["extent","width","height"],"scale":["matrix","immediate"],"time-extent-change":["timeExtent"],"unload":["map"],"update-end":["error"],"update-start":true,"zoom":["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],"click":true,"dbl-click":true,"key-down":true,"key-up":true,"mouse-down":true,"mouse-drag":true,"mouse-drag-end":true,"mouse-drag-start":true,"mouse-move":true,"mouse-out":true,"mouse-over":true,"mouse-up":true,"mouse-wheel":true,"basic-tap":true,"double-tap":true,"pinch-end":true,"pinch-move":true,"pinch-start":true,"processed-double-tap":true,"processed-tap":true,"swipe-end":true,"swipe-move":true,"swipe-start":true,"tap":true,"two-finger-tap":true});_28(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_clickHandles:[],_connects:[]});_28(this,{_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,_cursor:null,_ratioW:1,_ratioH:1,_params:null});_28(this,{cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,loaded:false});_28(this,{__panning:false,__zooming:false,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null});this._rids=[];var _39=(this.container=_a.byId(_37));var id=(this.id=_b.get(_39,"id")||_10.getUniqueId(this.declaredClass));_c.add(_39,"map");var box=_e.getContentBox(_39),dac=_c.add,dcr=_d.create;this.position=new _1a(0,0);this._reposition();var _3a=(this.width=(box.w||_29.width));var _3b=(this.height=box.h||_29.height);if(box.w===0){ds(_39,"width",_3a+"px");}if(box.h===0){ds(_39,"height",_3b+"px");}var _3c=(this.root=dcr("div",{id:id+"_root",style:{width:_3a+"px",height:_3b+"px",direction:"ltr"}}));dac(_3c,"container");var _3d=(this.__container=dcr("div",{id:id+"_container"},_3c));ds(_3d,"position","absolute");dac(_3d,"container");_39.appendChild(_3c);var _3e=(this._params=_28({slider:true,nav:false,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:true,displayGraphicsOnPan:true,wrapAround180:true,fitExtent:false},_38||{}));this.wrapAround180=_3e.wrapAround180;if(_14.isDefined(_3e.resizeDelay)){this.resizeDelay=_3e.resizeDelay;}if(_3e.lods){_30({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:_3e.lods},_3e);this.__tileInfo=_3e.tileInfo;}var ext=(this.extent=_3e.extent);this._extentUtil({mapCenter:_3e.center,targetLevel:_3e.zoom,targetScale:_3e.scale});this.__visibleRect=new _1c(0,0,_3a,_3b);this.__visibleDelta=new _1c(0,0,_3a,_3b);var _3f=(this._layersDiv=dcr("div",{id:id+"_layers"}));dac(_3f,"layersDiv");_3d.appendChild(_3f);this._zoomAnimDiv=dcr("div",{style:{position:"absolute"}});if(_3e.infoWindow){this.infoWindow=_3e.infoWindow;}else{var iw=(this.infoWindow=new _25(_3e.popupOptions,dcr("div")));iw.startup();iw._ootb=true;ds(iw.domNode,"zIndex",_2f);}this._zoomStartHandler=dh(this,this._zoomStartHandler);this._zoomingHandler=dh(this,this._zoomingHandler);this._zoomEndHandler=dh(this,this._zoomEndHandler);this._panningHandler=dh(this,this._panningHandler);this._panEndHandler=dh(this,this._panEndHandler);this._endTranslate=dh(this,this._endTranslate);_9.addOnWindowUnload(this,this.destroy);},_cleanUp:function(){var iw=this.infoWindow;if(iw){if(iw._ootb&&iw.destroy){iw.destroy();}else{iw.unsetMap(this);}delete this.infoWindow;}var _40=this._connects,i;for(i=_40.length-1;i>=0;i--){ddc(_40[i]);delete _40[i];}ddc(this._tsTimeExtentChange_connect);this.setInfoWindowOnClick(false);_d.destroy(this.root);this.root=null;},_addLayer:function(_41,_42,_43){var id=(_41.id=_41.id||(_41 instanceof _21?_29.graphicsLayerNamePrefix:_29.layerNamePrefix)+(uid++));this._layers[id]=_41;var i,lyr;if(_42===this.layerIds||_42===this.graphicsLayerIds){i=this._layerSize;this._layerSize++;}_41._isRefLayer=(_43==="top");_43=(!_14.isDefined(_43)||_43<0||_43>_42.length||_43==="top")?_42.length:_43;if(i===0){this._firstLayerId=id;}if(!_41._isRefLayer){while((lyr=this.getLayer(_42[_43-1]))&&lyr._isRefLayer){_43--;}}_42.splice(_43,0,id);var _44=dh(this,this._addLayerHandler),_45=this,_46=this._connects,_47=function(){if(_41.loaded){if(_45._onLoadFix){_45._onLoadFix=false;setTimeout(function(){_44(_41);},0);}else{_44(_41);}}else{_45[id+"_addtoken_load"]=dc(_41,"onLoad",_45,"_addLayerHandler");_45[id+"_addtoken_err"]=dc(_41,"onError",_45,function(_48){_44(_41,_48,_42);});}};if(this.loaded||i===0||(_41.loaded&&iOf(this.graphicsLayerIds,id)===-1)){_47();}else{_46.push(dc(this,"onLoad",_47));}return _41;},_addLayerHandler:function(_49,_4a,_4b){var id=this.id,_4c=_49.id,_4d=iOf(_49 instanceof _21?this.graphicsLayerIds:this.layerIds,_4c),_4e=_4d,_4f=false,_50=this._params,_51,_52,_53,_54;ddc(this[_4c+"_addtoken_load"]);ddc(this[_4c+"_addtoken_err"]);if(_4a){delete this._layers[_4c];if(_4d!==-1){_4b.splice(_4d,1);this.onLayerAddResult(_49,_4a);}return;}if(_4d===-1){_4d=iOf(this._internalLayerIds,_4c);_4e=_2e+_4d;_4f=true;}if(_4c===this._firstLayerId){_52=_49.spatialReference;_53=(this.extent&&this.extent.spatialReference);if(_53&&!_53.equals(_52)&&(_49.tileInfo||!_49.url)){_53=null;}_51=(this.spatialReference=(_53||_52));this.wrapAround180=(this.wrapAround180&&_51&&_51._isWrappable())?true:false;if(_49.tileInfo){if(!this.__tileInfo){_30(_28({},_49.tileInfo),_50);this.__tileInfo=_50.tileInfo;}else{_54=this.__tileInfo.lods;this.__tileInfo=_28({},_49.tileInfo);this.__tileInfo.lods=_54;}}if(this.wrapAround180){var _55=this.__tileInfo,_56=_51._getInfo();if(!_55||Math.abs(_56.origin[0]-_55.origin.x)>_56.dx){this.wrapAround180=false;}if(this.wrapAround180&&_55){_18._addFrameInfo(_55,_56);}}_50.units=_49.units;_54=this.__tileInfo&&this.__tileInfo.lods;if(_54&&_54.length){var _57=_50.minScale,_58=_50.maxScale,_59=-1,_5a=-1,_5b=false,_5c=false,i;for(i=0;i<_54.length;i++){if(_57>0&&!_5b&&_57>=_54[i].scale){_59=_54[i].level;_5b=true;}if(_58>0&&!_5c&&_58>=_54[i].scale){_5a=(i>0)?_54[i-1].level:-1;_5c=true;}}if(_50.minZoom===-1){_50.minZoom=(_57===0)?_54[0].level:_59;}if(_50.maxZoom===-1){_50.maxZoom=(_58===0)?_54[_54.length-1].level:_5a;}for(i=0;i<_54.length;i++){if(_50.minZoom===_54[i].level){_50.minScale=_54[i].scale;}if(_50.maxZoom===_54[i].level){_50.maxScale=_54[i].scale;}}}else{_50.minZoom=_50.maxZoom=_50.zoom=-1;}}if(_49 instanceof _21){if(!this._gc){this._gc=new _21._GraphicsContainer();var gc=this._gc._setMap(this,this._layersDiv);gc.id=id+"_gc";}var _5d=_49._setMap(this,this._gc._surface);_5d.id=id+"_"+_4c;this._layerDivs[_4c]=_5d;this._reorderLayers(this.graphicsLayerIds);if(_50.showInfoWindowOnClick){this._clickHandles.push(dc(_49,"onClick",this,"_gClickHandler"));}}else{var _5e=_49._setMap(this,this._layersDiv,_4e,this.__LOD);_5e.id=id+"_"+_4c;this._layerDivs[_4c]=_5e;this._reorderLayers(this.layerIds);if(!_4f&&_49.declaredClass.indexOf("VETiledLayer")!==-1){this._onBingLayerAdd(_49);}}if(_4c===this._firstLayerId){this.graphics=new _21({id:id+"_graphics",displayOnPan:_50.displayGraphicsOnPan});this._addLayer(this.graphics,this._internalLayerIds,_2e);}if(_49===this.graphics){var _5f,_60=this._layers[this._firstLayerId],_61,_62=_50.zoom,_63=_50.scale,_64=_50.center,_65=_60.initialExtent||_60.fullExtent;this._firstLayerId=null;if(this.extent){this.extent=this._convertGeometry(this,this.extent);}if(!this.extent&&_65){if(_64){_64=this._convertGeometry(_65,_64);}if(_64){_65=_65.centerAt(_64);_64=null;}}_61=this.extent||(_65&&new _1b(_65.toJson()));if(_61){if(_62>-1){_61=this.__getExtentForLevel(_62,null,_61).extent;}else{if(_63>0){_61=_1e.getExtentForScale(this,_63,_61);}}}if(!_61){console.log("Map: "+this.invalidExtent);return;}_5f=this._fixExtent(_61,_50.fitExtent);this.extent=_5f.extent;this.__LOD=_5f.lod;this.__setExtent(this.extent,null,null,_50.fitExtent);this.loaded=true;this.infoWindow.setMap(this);this.onLoad(this);}if(!_4f){this.onLayerAdd(_49);this.onLayerAddResult(_49);}ddc(this[_4c+"_addLayerHandler_connect"]);},_convertGeometry:function(_66,_67){var _68=_66&&_66.spatialReference,_69=_67&&_67.spatialReference;if(_68&&_69&&!_68.equals(_69)){if(_68._canProject(_69)){if(_68.isWebMercator()){_67=_20.geographicToWebMercator(_67);}else{if(_68.wkid===4326){_67=_20.webMercatorToGeographic(_67,true);}}}else{console.log("Map: "+_14.substitute({geometry:_69.wkid||_69.wkt,map:_68.wkid||_68.wkt},this.invalidGeometry));_67=null;}}return _67;},_reorderLayers:function(_6a){var _6b=this.onLayerReorder,djp=_d.place,_6c=this._layerDivs,_6d=this._layers,_6e=this._gc?this._gc._surface.getEventSource():null;if(_6a===this.graphicsLayerIds){_7.forEach(_6a,function(id,i){var _6f=_6c[id];if(_6f){djp(_6f.getEventSource(),_6e,i);_6b(_6d[id],i);}});}else{var g=this.graphics,gId=g?g.id:null,_70=this._layersDiv,_71;_7.forEach(_6a,function(id,i){_71=_6c[id];if(id!==gId&&_71){djp(_71,_70,i);_6b(_6d[id],i);}});if(_6e){_6e=(has("ie")<9)?_6e.parentNode:_6e;djp(_6e,_6e.parentNode,_6a.length);}}this.onLayersReordered([].concat(_6a));},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor);},_zoomingHandler:function(_72){var rl=parseFloat(_72.left),rt=parseFloat(_72.top),_73=new _1b(rl,rt-parseFloat(_72.height),rl+parseFloat(_72.width),rt,this.spatialReference),_74=this.extent.getWidth()/_73.getWidth();this.__zoom(_73,_74,this._zoomAnimDiv.anchor);},_zoomEndHandler:function(){var _75=this._zoomAnimDiv,_76=_75.extent,_77=this.extent.getWidth()/_76.getWidth();var _78=_75.anchor,_79=_75.newLod,_7a=_75.levelChange;_75.extent=_75.anchor=_75.levelChange=_75.startingExtent=_75.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(_76,_77,_78,_79,_7a);},_panningHandler:function(_7b){if(isNaN(parseFloat(_7b.left))||isNaN(parseFloat(_7b.top))){var _7c=Math.round,_7d=this._panAnim.node;_7b.left=(-1*(this._delta.x-_7c(this.width/2)))+"px";_7b.top=(-1*(this._delta.y-_7c(this.height/2)))+"px";_f.set(_7d,"left",_7b.left);_f.set(_7d,"top",_7b.top);}var d=new _1a(parseFloat(_7b.left),parseFloat(_7b.top)),dm=this.toMap(d);this.onPan(this.extent.offset(dm.x,dm.y),d);},_panEndHandler:function(_7e){this.__panning=false;var _7f=Math.round,_80=new _1a(-_7f(parseFloat(_7e.style.left)),-_7f(parseFloat(_7e.style.top))),dx=_80.x,dy=_80.y,_81=this.__visibleRect,_82=this.__visibleDelta;_81.x+=-dx;_81.y+=-dy;_82.x+=-dx;_82.y+=-dy;ds(this._zoomAnimDiv,{left:"0px",top:"0px"});var _83=this.extent,rw=this._ratioW,rh=this._ratioH;_83=new _1b(_83.xmin+(dx/rw),_83.ymin-(dy/rh),_83.xmax+(dx/rw),_83.ymax-(dy/rh),this.spatialReference);_80.setX(-_80.x);_80.setY(-_80.y);this._delta=this._panAnim=null;this._updateExtent(_83);this.onPanEnd(_83,_80);this._fireExtChg([_83,_80,false,this.__LOD]);},_fixExtent:function(_84,fit){var _85=this._reshapeExtent(_84),_86=1+_2c;while(fit===true&&(_85.extent.getWidth()<_84.getWidth()||_85.extent.getHeight()<_84.getHeight())&&_85.lod.level>0&&_86<=_2d){_85=this._reshapeExtent(_84.expand(_86));_86+=_2c;}return _85;},_getFrameWidth:function(){var _87=-1,_88=this.spatialReference._getInfo();if(this.__LOD){var _89=this.__LOD._frameInfo;if(_89){_87=_89[3];}}else{if(_88){_87=Math.round((2*_88.valid[1])/(this.extent.getWidth()/this.width));}}return _87;},_reshapeExtent:function(_8a){var w=_8a.getWidth(),h=_8a.getHeight(),r=w/h,_8b=this.width/this.height,dw=0,dh=0;if(this.width>this.height){if(w>h){if(_8b>r){dw=(h*_8b)-w;}else{dh=(w/_8b)-h;}}else{if(w<h){dw=(h*_8b)-w;}else{dw=(h*_8b)-w;}}}else{if(this.width<this.height){if(w>h){dh=(w/_8b)-h;}else{if(w<h){if(_8b>r){dw=(h*_8b)-w;}else{dh=(w/_8b)-h;}}else{dh=(w/_8b)-h;}}}else{if(w<h){dw=h-w;}else{if(w>h){dh=(w/_8b)-h;}}}}if(dw){_8a.xmin-=dw/2;_8a.xmax+=dw/2;}if(dh){_8a.ymin-=dh/2;_8a.ymax+=dh/2;}return this._getAdjustedExtent(_8a);},_getAdjustedExtent:function(_8c){if(this.__tileInfo){return _18.getCandidateTileInfo(this,this.__tileInfo,_8c);}else{var _8d=_1e.getScale(this,_8c),_8e=this.getMinScale(),_8f=this.getMaxScale(),_90=!_8e||(_8d<=_8e),_91=!_8f||(_8d>=_8f);if(!_90){_8c=_1e.getExtentForScale(this,_8e,_8c);}else{if(!_91){_8c=_1e.getExtentForScale(this,_8f,_8c);}}return {extent:_8c};}},_gClickHandler:function(evt){var _92=evt.graphic,iw=this.infoWindow;if(_92._getEffInfoTemplate()&&iw){_8.stop(evt);var _93=_92.geometry,_94=(_93&&_93.type==="point")?_93:evt.mapPoint,_95,_96;if(iw.setFeatures){iw.setFeatures([_92]);}else{iw.setTitle(_92.getTitle());_95=_92.getContent();if(_95&&_6.isString(_95.id)){_96=_10.byId(_95.id);if(_96&&_96.set&&/_PopupRenderer/.test(_96.declaredClass)){_96.set("showTitle",false);}}iw.setContent(_95);}iw.show(_94);}},_onBingLayerAdd:function(_97){this["__"+_97.id+"_vis_connect"]=_4.connect(_97,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(_97.visible);},_onBingLayerRemove:function(_98){_4.disconnect(this["__"+_98.id+"_vis_connect"]);delete this["__"+_98.id+"_vis_connect"];var _99=this.layerIds;var _9a=_7.some(_99,function(_9b){var _9c=this._layers[_9b];return _9c&&_9c.visible&&_9c.declaredClass.indexOf("VETiledLayer")!==-1;},this);this._toggleBingLogo(_9a);},_toggleBingLogo:function(_9d){if(_9d&&!this._bingLogo){var _9e={left:(this._mapParams&&this._mapParams.nav?"25px":"")};if(has("ie")===6){_9e.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', sizingMethod='crop', src='"+_1.toUrl("esri")+"/images/map/bing-logo-lg.png"+"')";}var _9f=this._bingLogo=_d.create("div",{style:_9e},this.root);_c.add(_9f,"bingLogo-lg");}else{if(!_9d&&this._bingLogo){_d.destroy(this._bingLogo);delete this._bingLogo;}}},__panStart:function(x,y){var _a0=this._zoomAnim,_a1=this._panAnim;if(_a0&&_a0._active){_a0.stop();_a0._fire("onEnd",[_a0.node]);}else{if(_a1&&_a1._active){_a1.stop();this._panAnim=null;var _a2=_a1.curve.getValue(_a1._getStep()),rl=Math.round(parseFloat(_a2.left)),rt=Math.round(parseFloat(_a2.top)),_a3=this.navigationManager._dragOrigin;this.__pan(rl,rt);if(_a3){_a3.x-=rl;_a3.y-=rt;}return;}}this.__panning=true;this.onPanStart(this.extent,new _1a(x,y));},__pan:function(dx,dy){var _a4=this.extent,rw=this._ratioW,rh=this._ratioH;this.onPan(new _1b(_a4.xmin-(dx/rw),_a4.ymin+(dy/rh),_a4.xmax-(dx/rw),_a4.ymax+(dy/rh),this.spatialReference),new _1a(dx,dy));},__panEnd:function(dx,dy){var _a5=this.__visibleRect,_a6=this.__visibleDelta;_a5.x+=dx;_a5.y+=dy;_a6.x+=dx;_a6.y+=dy;var d=new _1a(dx,dy),_a7=this.extent,rw=this._ratioW,rh=this._ratioH;_a7=new _1b(_a7.xmin-(dx/rw),_a7.ymin+(dy/rh),_a7.xmax-(dx/rw),_a7.ymax+(dy/rh),this.spatialReference);this.__panning=false;this._updateExtent(_a7);this.onPanEnd(_a7,d);this._fireExtChg([_a7,d,false,this.__LOD]);},__zoomStart:function(_a8,_a9){this.__zooming=true;this.onZoomStart(_a8,1,_a9,this.__LOD?this.__LOD.level:null);},__zoom:function(_aa,_ab,_ac){this.onZoom(_aa,_ab,_ac);},__zoomEnd:function(_ad,_ae,_af,lod,_b0){ds(this._layersDiv,{left:"0px",top:"0px"});this._delta=new _1a(0,0);this.__visibleRect.x=(this.__visibleRect.y=0);_ad=new _1b(_ad);this.__LOD=lod;this._ratioW=this.width/_ad.getWidth();this._ratioH=this.height/_ad.getHeight();var _b1=this._delta;this._delta=null;this.__zooming=false;this._updateExtent(_ad,_b0);this.onZoomEnd(_ad,_ae,_af,lod?lod.level:null);this._fireExtChg([_ad,_b1,_b0,lod]);},_extentUtil:function(_b2,pan,_b3,fit,_b4){var dfd=new _5(),_b5,_b6,_b7,_b8,_b9,_ba,_bb,_bc,dx,dy,_bd=this.width,_be=this.height,_bf,_c0,_c1;if(_b2){_b5=_b2.numLevels;_b6=_b2.targetLevel;_bf=_14.isDefined(_b6);_b7=_b2.factor;_b8=_b2.mapAnchor;_b9=_b2.screenAnchor;_ba=_b2.mapCenter;_c0=_b2.levelOrFactor;_bb=_b2.targetScale;_bc=_14.isDefined(_bb)&&_bb>0;}if(pan){dx=pan.dx;dy=pan.dy;_ba=pan.mapCenter;}if(_6.isArray(_ba)){_ba=new _19(_ba);}var _c2=this._panAnim,_c3=this._stopAnim(),_c4=_c3?_c3.divExtent:this.extent,_c5=this.__tileInfo,_c6,_c7,ewd,eht,_c8=this._params;if(!this.loaded){if(_b3){if(_c4){_b3=this._convertGeometry(_c4,_b3);}if(_b3){this.extent=_b3;_c8.zoom=_c8.scale=-1;_c8.center=null;}}else{if(_ba||_bf||_bc){if(_ba){if(_c4){_ba=this._convertGeometry(_c4,_ba);if(_ba){this.extent=_c4.centerAt(_ba);_c8.center=null;}}else{_c8.center=_ba;}}if(_bf&&_b6>-1){_c8.zoom=_b6;_c8.scale=-1;}else{if(_bc){_c8.scale=_bb;_c8.zoom=-1;}}}}dfd.resolve();return dfd;}if(_ba){_ba=this._convertGeometry(this,_ba);if(!_ba){dfd.reject();return dfd;}}if(_b8){_b8=this._convertGeometry(this,_b8);if(!_b8){dfd.reject();return dfd;}}if(_b3){_b3=this._convertGeometry(this,_b3);if(!_b3){dfd.reject();return dfd;}}if(_c2&&_b8&&_b9){_b8=_26(this.extent,_bd,_be,_b9);}if(_c3&&_b8&&_b9){_b8=_26(_c3.divExtent,_bd,_be,_b9);}if(_bf){if(_c5){var _c9=this.getMinZoom(),_ca=this.getMaxZoom();if(_b6<_c9){_b6=_c9;}else{if(_b6>_ca){_b6=_ca;}}_b5=_b6-(_c3?_c3.level:this.getLevel());}else{_b5=_b6>0?-1:1;_c1=_c0?_b6:null;}}if(_b3){}else{if(_14.isDefined(_b5)){var _cb;if(_c5){var _cc=_c3?_c3.level:this.getLevel();_cb=this.__getExtentForLevel(_cc+_b5,_ba,_c4).extent;}else{var _cd=_c3?_c3.end:this.extent;_cb=_cd.expand(_c1||(_b5>0?0.5*_b5:2*-_b5));if(_c1&&_ba){_cb=_cb.centerAt(_ba);}}if(_cb){if(_ba){_b3=_cb;}else{var _ce=_b8||_c4.getCenter(),_cf=_c4.ymax-((_cb.getHeight()-_c4.getHeight())*(_ce.y-_c4.ymax)/_c4.getHeight());_c6=_c4.xmin-((_cb.getWidth()-_c4.getWidth())*(_ce.x-_c4.xmin)/_c4.getWidth());_b3=new _1b(_c6,_cf-_cb.getHeight(),_c6+_cb.getWidth(),_cf,this.spatialReference);}}}else{if(_bc){_b3=_1e.getExtentForScale(this,_bb,_c4);}else{if(_14.isDefined(_b7)){_b3=_c4.expand(_b7);}else{if(dx||dy){if(_c3){var end=_c3.end,c1=end.getCenter(),c2=_27(end,_bd,_be,c1);c2.x+=dx;c2.y+=dy;c2=_26(end,_bd,_be,c2);_b3=end.offset(c2.x-c1.x,c2.y-c1.y);}else{var _d0=new _1a((_bd/2)+dx,(_be/2)+dy),_d1=_26(_c4,_bd,_be,_d0);ewd=_c4.getWidth();eht=_c4.getHeight();_c6=_d1.x-(ewd/2);_c7=_d1.y-(eht/2);_b3=new _1b(_c6,_c7,_c6+ewd,_c7+eht,this.spatialReference);}}}}}}if(!_b3){if(_ba){var ext=_c3?_c3.end:_c4;ewd=ext.getWidth();eht=ext.getHeight();_c6=_ba.x-(ewd/2);_c7=_ba.y-(eht/2);_b3=new _1b(_c6,_c7,_c6+ewd,_c7+eht,this.spatialReference);}else{if(_c3){_b3=_c3.end;}}}if(_b3){if(this._extentDfd&&this._extentDfd.fired===-1){this._extentDfd.reject();}this._extentDfd=dfd;this.__setExtent(_b3,null,_b9,fit,_c3,_b4);}else{dfd.reject();}return dfd;},__setExtent:function(_d2,_d3,_d4,fit,_d5,_d6){try{if(this._firstLayerId){this.extent=_d2;return;}var _d7=true,sr=this.spatialReference,ext=_d5?_d5.divExtent:this.extent,_d8=this._fixExtent(_d2,fit||false);_d2=_d8.extent;var _d9=_d2.getWidth(),_da=_d2.getHeight(),_db=Math.round;if(ext){var tw=_db(ext.getWidth()*_2a),w=_db(_d9*_2a),th=_db(ext.getHeight()*_2a),h=_db(_da*_2a);_d7=(tw!==w)||(th!==h);}var _dc,end,_dd,_de,_df=_d5&&_d5.rect,_e0=_d5&&_d5.divExtent;if(_29.zoomDuration&&_d7&&ext){_e0=_e0||new _1b(ext);_df=_df||{left:ext.xmin,top:ext.ymax,width:ext.getWidth(),height:ext.getHeight()};end={left:_d2.xmin,top:_d2.ymax,width:_d9,height:_da};_dd=_df.width/end.width;_de=_df.height/end.height;var mtl=new _19(_d2.xmin,_d2.ymax,sr),mbl=new _19(_d2.xmin,_d2.ymin,sr),etl=new _19(this.extent.xmin,this.extent.ymax,sr),ebl=new _19(this.extent.xmin,this.extent.ymin,sr);_dc=_1d.getLineIntersection(etl,mtl,ebl,mbl,sr);if(!_dc&&!_d5){_d7=false;}}this._ratioW=this.width/_d9;this._ratioH=this.height/_da;var _e1=this._zoomAnimDiv;if(_d7){ds(this._layersDiv,{left:"0px",top:"0px"});_d3=new _1a(0,0);this.__visibleRect.x=(this.__visibleRect.y=0);if(_df&&end){this._delta=_d3;_e1.id="_zAD";_e1.startingExtent=_e0;_e1.extent=_d2;_e1.levelChange=_d7;_e1.newLod=_d8.lod;if(_d4){_e1.anchor=_d4;}else{if(!_dc&&_d5){_e1.anchor=_d5.anchor;}else{_e1.anchor=_27(this.extent,this.width,this.height,_dc);}}this._zoomAnim=_16.resize({node:_e1,start:_df,end:end,duration:_29.zoomDuration,rate:_29.zoomRate,beforeBegin:!_d5?this._zoomStartHandler:null,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play();this._fireOnScale(this.extent.getWidth()/_d2.getWidth(),_e1.anchor);}else{this._updateExtent(_d2,_d7);this._fireExtChg([this.extent,_d3,_d7,(this.__LOD=_d8.lod)]);}}else{if(!this.__panning){if(this.loaded===false||_d6){this._updateExtent(_d2,_d7);this._fireExtChg([this.extent,_d3,_d7,(this.__LOD=_d8.lod)]);}else{this.__panning=true;_df=new _1c(0,0,this.width,this.height,this.spatialReference).getCenter();_df.x=_db(_df.x);_df.y=_db(_df.y);this.onPanStart(this.extent,new _1a(0,0));var _e2=(this._delta=this.toScreen(_d2.getCenter()));this._panAnim=_16.slideTo({node:_e1,left:_df.x-_e2.x,top:_df.y-_e2.y,duration:_29.panDuration,rate:_29.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler});this._panAnim.play();}}}}catch(e){console.log(e.stack);console.error(e);}},_fireOnScale:function(_e3,_e4,_e5){if(this.navigationMode==="css-transforms"){var vd=this.__visibleDelta;this.onScale(_11.scaleAt(_e3,{x:-1*((this.width/2)-(_e4.x-vd.x)),y:-1*((this.height/2)-(_e4.y-vd.y))}),_e5);}},_stopAnim:function(){var _e6=this._zoomAnim,_e7=this._panAnim;if(_e6&&_e6._active){_e6.stop();var _e8=_e6.curve.getValue(_e6._getStep()),rl=parseFloat(_e8.left),rt=parseFloat(_e8.top),_e9=_e6.node;return {anchor:_e9.anchor,start:_e9.startingExtent,end:_e9.extent,level:_e9.newLod&&_e9.newLod.level,rect:_e8,divExtent:new _1b(rl,rt-parseFloat(_e8.height),rl+parseFloat(_e8.width),rt,this.spatialReference)};}else{if(_e7&&_e7._active){_e7.stop();_e7._fire("onEnd",[_e7.node]);}}},__getExtentForLevel:function(_ea,_eb,_ec){var ti=this.__tileInfo,_ed=ti&&ti.lods;_ea=_14.isDefined(_ea)?_ea:0;_ec=_ec||this.extent;_eb=_eb||(_ec&&_ec.getCenter());if(_ed){if(!_eb){console.log("Map: "+this.invalidExtent);return;}var _ee=this.getMinZoom(),_ef=this.getMaxZoom();if(_ea>_ef){_ea=_ef;}if(_ea<_ee){_ea=_ee;}var lod=_ed[_ea],_f0=this.width*lod.resolution/2,_f1=this.height*lod.resolution/2;return {extent:new _1b(_eb.x-_f0,_eb.y-_f1,_eb.x+_f0,_eb.y+_f1,_eb.spatialReference),lod:lod};}else{if(!_ec){console.log("Map: "+this.invalidExtent);return;}_ea=(!_ea||_ea<1)?1:_ea;return {extent:_ec.expand(_ea).centerAt(_eb)};}},_jobs:0,_incr:function(){if((++this._jobs)===1){this.updating=true;this.onUpdateStart();}},_decr:function(){var _f2=--this._jobs;if(!_f2){this.updating=false;this.onUpdateEnd();}else{if(_f2<0){this._jobs=0;}}},_fireEvent:function(_f3,_f4){if(this[_f3]){this[_f3].apply(this,_f4);}},_updateExtent:function(_f5,_f6){this.extent=_f5;if(_f6){this._setClipRect();}var _f7=this.spatialReference;if(_f7){if(_f7.isWebMercator()){this.geographicExtent=_20.webMercatorToGeographic(this._getAvailExtent(),true);}else{if(_f7.wkid===4326){this.geographicExtent=new _1b(this._getAvailExtent().toJson());}}}},_fireExtChg:function(_f8){this._fireEvent("onExtentChange",_f8);var dfd=this._extentDfd;if(dfd){delete this._extentDfd;dfd.resolve();}},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect();},onUnload:function(){},onExtentChange:function(a,b,_f9){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect();},onReposition:function(){},destroy:function(){if(!this._destroyed){this.removeAllLayers();this._cleanUp();if(this._gc){this._gc._cleanUp();}this._destroyed=true;this.onUnload(this);}},setCursor:function(_fa){ds(this.__container,"cursor",(this.cursor=_fa));},setMapCursor:function(c){this.setCursor((this._cursor=c));},resetMapCursor:function(){this.setCursor(this._cursor);},setInfoWindow:function(_fb){var iw=this.infoWindow;if(iw){iw.unsetMap(this);}this.infoWindow=_fb;if(this.loaded&&_fb){_fb.setMap(this);}},setInfoWindowOnClick:function(_fc){var _fd=this._params;if(_fc){if(!_fd.showInfoWindowOnClick){var _fe=[this.graphics].concat(_7.map(this.graphicsLayerIds,this.getLayer,this));_7.map(_fe,function(_ff){if(_ff&&_ff.loaded){this._clickHandles.push(dc(_ff,"onClick",this,"_gClickHandler"));}},this);}}else{_7.forEach(this._clickHandles,ddc);this._clickHandles=[];}_fd.showInfoWindowOnClick=_fc;},getInfoWindowAnchor:function(pt){return (this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(pt))||"upperright";},toScreen:function(pt,_100){return _27(this.extent,this.width,this.height,pt,_100);},toMap:function(pt){return _26(this.extent,this.width,this.height,pt);},addLayer:function(_101,_102){if(_101&&!this.getLayer(_101.id)){this._addLayer(_101,_101 instanceof _21?this.graphicsLayerIds:this.layerIds,_102);}return _101;},addLayers:function(_103){var _104=[],_105=_103.length,_106,i,len=_103.length;var _107=function(_108,_109){if(_7.indexOf(_103,_108)!==-1){_105--;_104.push({"layer":_108,"success":!_109,"error":_109});if(!_105){_4.disconnect(_106);this.onLayersAddResult(_104);}}};_106=_4.connect(this,"onLayerAddResult",_107);for(i=0;i<len;i++){this.addLayer(_103[i]);}return this;},removeLayer:function(_10a,_10b){var id=_10a.id,ids=_10a instanceof _21?this.graphicsLayerIds:this.layerIds,i=iOf(ids,id);if(i>=0){ids.splice(i,1);if(_10a instanceof _21){ddc(this["_gl_"+_10a.id+"_click_connect"]);if(_10a.loaded){_10a._unsetMap(this,this._gc._surface);}}else{if(_10a.loaded){_10a._unsetMap(this,this._layersDiv);if(_10a.declaredClass.indexOf("VETiledLayer")!==-1){this._onBingLayerRemove(_10a);}}}delete this._layers[id];delete this._layerDivs[id];if(!_10b){this._reorderLayers(ids);}this.onLayerRemove(_10a);}},removeAllLayers:function(){var ids=this.layerIds,i;for(i=ids.length-1;i>=0;i--){this.removeLayer(this._layers[ids[i]],1);}ids=this.graphicsLayerIds;for(i=ids.length-1;i>=0;i--){this.removeLayer(this._layers[ids[i]],1);}this.onLayersRemoved();},reorderLayer:function(_10c,_10d){if(_6.isString(_10c)){_2.deprecated(this.declaredClass+": "+"Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",null,"v2.0");_10c=this.getLayer(_10c);}var id=_10c.id,i,ids=_10c instanceof _21?this.graphicsLayerIds:this.layerIds;if(_10d<0){_10d=0;}else{if(_10d>=ids.length){_10d=ids.length-1;}}i=iOf(ids,id);if(i===-1||i===_10d){return;}ids.splice(i,1);ids.splice(_10d,0,id);this._reorderLayers(ids);},getLayer:function(id){return this._layers[id];},setExtent:function(_10e,fit){_10e=new _1b(_10e.toJson());var _10f=_10e.getWidth(),_110=_10e.getHeight(),dfd;if(_10f===0&&_110===0){dfd=this.centerAt(new _19({x:_10e.xmin,y:_10e.ymin,spatialReference:_10e.spatialReference&&_10e.spatialReference.toJson()}));}else{dfd=this._extentUtil(null,null,_10e,fit);}return dfd;},centerAt:function(_111){return this._extentUtil(null,{mapCenter:_111});},centerAndZoom:function(_112,_113){return this._extentUtil({targetLevel:_113,mapCenter:_112,levelOrFactor:true});},getScale:function(){return this.__LOD?this.__LOD.scale:_1e.getScale(this);},getMinScale:function(){return this._params.minScale;},getMaxScale:function(){return this._params.maxScale;},setScale:function(_114){return this._extentUtil({targetScale:_114});},getLayersVisibleAtScale:function(_115){var _116=[];_115=_115||this.getScale();if(_115){_7.forEach(this.layerIds.concat(this.graphicsLayerIds),function(_117){_117=this.getLayer(_117);if(_117.isVisibleAtScale(_115)){_116.push(_117);}},this);}return _116;},getNumLevels:function(){var _118=this.getMinZoom(),_119=this.getMaxZoom();return ((_118===_119)&&_118<0)?0:(_119-_118+1);},getLevel:function(){return this.__LOD?this.__LOD.level:-1;},setLevel:function(_11a){if(_11a>-1){return this._extentUtil({targetLevel:_11a});}},getZoom:function(){return this.getLevel();},setZoom:function(zoom){return this.setLevel(zoom);},getMinZoom:function(){return this._params.minZoom;},getMaxZoom:function(){return this._params.maxZoom;},setBasemap:function(_11b){var _11c,_11d="Map.setBasemap: ";if(_6.isObject(_11b)){_11c=_11b;_11b=_11c.title;}else{_11c=_29.basemaps&&_29.basemaps[_11b];}if(_11c){if(this._basemapDfd&&this._basemapDfd.fired===-1){this._basemapDfd.cancel();}var _11e=[],_11f=[],_120=0;_7.forEach(_11c.baseMapLayers||_11c.layers,function(_121){var _122,_123={id:_121.id,displayLevels:_121.displayLevels,opacity:_14.isDefined(_121.opacity)?_121.opacity:null,visible:_14.isDefined(_121.visibility)?_121.visibility:null};if(_121.type){switch(_121.type){case "OpenStreetMap":_122=new _24(_123);break;default:console.log(_11d+_14.substitute({basemapName:_11b,type:_121.type},this.unknownLayerType));break;}}else{var url=_121.url;if(window.location.protocol==="https:"&&((url.search(/^http\:\/\/server\.arcgisonline\.com/i)!==-1)||(url.search(/^http\:\/\/services\.arcgisonline\.com/i)!==-1)||(url.search(/^http\:\/\/.+\.arcgis\.com/i)!==-1))){url=url.replace(/http:/i,"https:");}_122=new _23(url,_123);}if(_122){_11e.push(_122);_11f.push(_121);if(!_121.isReference){_120++;}}},this);if(!_11e.length||!_120){console.log(_11d+_14.substitute({basemapName:_11b},this.invalidBasemap));return;}var _124={basemapName:_11b,infos:_11f,layers:_11e};if(!this.loaded){this._basemapLoaded(_124);return;}var self=this,dfd=new _5(_17._dfdCanceller),_125=function(_126){dfd._pendingLayers--;var idx=_7.indexOf(_124.layers,this);if(idx>-1){var _127=dfd._layerEvents[idx];if(_127){_4.disconnect(_127[0]);_4.disconnect(_127[1]);}}if(dfd._pendingLayers<=0){delete dfd._layerEvents;delete self._basemapDfd;dfd.callback(_124);}};this._basemapDfd=dfd;dfd._pendingLayers=0;dfd._layerEvents={};_7.forEach(_11e,function(_128,i){if(_128){dfd._pendingLayers++;if(_128.loaded){_125(_128);}else{dfd._layerEvents[i]=[_4.connect(_128,"onLoad",_128,_125),_4.connect(_128,"onError",_128,_125)];}}});dfd.addCallback(_6.hitch(this,this._basemapLoaded));}else{var _129=[],_12a;for(_12a in _29.basemaps){_129.push(_12a);}console.log(_11d+_14.substitute({basemapName:_11b,list:_129.join(",")},this.unknownBasemap));}},_basemapLoaded:function(_12b){var _12c=_12b.layers,_12d=_12b.infos,_12e=0,_12f=true;if(this.loaded){_7.forEach(_12c,function(_130,i){if(_130.loaded){if(!_12d[i].isReference){_12e++;}}});_12f=_12e;}if(_12f){this._removeBasemap();this._basemap=_12b.basemapName;this.basemapLayerIds=this._addBasemap(_12c,_12d);this._fireEvent("onBasemapChange");}},_addBasemap:function(_131,_132){var _133=[],ids=[],_134=0;_7.forEach(_131,function(_135,i){if(_132[i].isReference){_133.push(_135);}else{this.addLayer(_135,_134++);ids.push(_135.id);}},this);if(_133.length){_7.forEach(_133,function(_136){this.addLayer(_136,"top");ids.push(_136.id);},this);}return ids;},_removeBasemap:function(){var ids=this.basemapLayerIds,_137;if(ids&&ids.length){_7.forEach(ids,function(id){_137=this.getLayer(id);if(_137){this.removeLayer(_137);}},this);}},getBasemap:function(){return this._basemap||"";},translate:function(dx,dy){dx=dx||0;dy=dy||0;if(!this._txTimer){this._tx=this._ty=0;var _138=this.toScreen(this.extent.getCenter());this.__panStart(_138.x,_138.y);}this._tx+=dx;this._ty+=dy;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150);},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var dx=this._tx,dy=this._ty;this._tx=this._ty=0;this.__panEnd(dx,dy);},setTimeExtent:function(_139){this.timeExtent=_139;var arg=_139?new _139.constructor(_139.toJson()):null;this.onTimeExtentChange(arg);},setTimeSlider:function(_13a){if(this.timeSlider){ddc(this._tsTimeExtentChange_connect);this._tsTimeExtentChange_connect=null;this.timeSlider=null;}if(_13a){this.timeSlider=_13a;this.setTimeExtent(_13a.getCurrentTimeExtent());this._tsTimeExtentChange_connect=dc(_13a,"onTimeExtentChange",this,"setTimeExtent");}},resize:function(_13b){var self=this,_13c=function(){clearTimeout(self._resizeT);self.reposition();self._resize();};clearTimeout(self._resizeT);if(_13b===true){_13c();}else{self._resizeT=setTimeout(_13c,self.resizeDelay);}},_resize:function(){var w=this.width,h=this.height,box=_e.getContentBox(this.container);if(w===box.w&&h===box.h){return;}var _13d=this._zoomAnim||this._panAnim;if(_13d){_13d.stop();_13d._fire("onEnd",[_13d.node]);}ds(this.root,{width:(this.width=box.w)+"px",height:(this.height=box.h)+"px"});var wd=this.width,ht=this.height;if(this.attribution&&this.attribution.domNode){_f.set(this.attribution.domNode,"width",Math.floor(wd*this._mapParams.attributionWidth)+"px");}this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,wd,ht);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,wd,ht);var r=new _1c(this.extent),ne=(new _1c(r.x,r.y,r.width*(wd/w),r.height*(ht/h),this.spatialReference)).getExtent();this.onResize(ne,wd,ht);this._extentUtil(null,null,ne,null,true);},reposition:function(){this._reposition();this.onReposition(this.position.x,this.position.y);},_reposition:function(){var pos=_e.position(this.container,true),brdr=_e.getPadBorderExtents(this.container);this.position.update(pos.x+brdr.l,pos.y+brdr.t);},_setClipRect:function(){delete this._clip;var _13e=has("ie")?"rect(auto,auto,auto,auto)":null;if(this.wrapAround180){var _13f=this.width,_140=this.height,_141=this._getFrameWidth(),diff=_13f-_141;if(diff>0){var left=diff/2;_13e="rect(0px,"+(left+_141)+"px,"+_140+"px,"+left+"px)";var _142=this.extent.getWidth(),_143=_142*(_141/_13f);this._clip=[(_142-_143)/2,_143];}}ds(this.__container,"clip",_13e);},_getAvailExtent:function(){var _144=this.extent,clip=this._clip;if(clip){if(!_144._clip){var rect=new _1c(_144);rect.width=clip[1];rect.x=rect.x+clip[0];_144._clip=rect.getExtent();}return _144._clip;}return _144;},_fixedPan:function(dx,dy){return this._extentUtil(null,{dx:dx,dy:dy});},panUp:function(){return this._fixedPan(0,this.height*-_2b);},panUpperRight:function(){return this._fixedPan(this.width*_2b,this.height*-_2b);},panRight:function(){return this._fixedPan(this.width*_2b,0);},panLowerRight:function(){return this._fixedPan(this.width*_2b,this.height*_2b);},panDown:function(){return this._fixedPan(0,this.height*_2b);},panLowerLeft:function(){return this._fixedPan(this.width*-_2b,this.height*_2b);},panLeft:function(){return this._fixedPan(this.width*-_2b,0);},panUpperLeft:function(){return this._fixedPan(this.width*-_2b,this.height*-_2b);},enableSnapping:function(_145){_145=_145||{};if(_145.declaredClass==="esri.SnappingManager"){this.snappingManager=_145;}else{var _146=["esri/SnappingManager"],rid=uid++,self=this;this._rids&&this._rids.push(rid);_1(_146,function(_147){var idx=self._rids?_7.indexOf(self._rids,rid):-1;if(idx!==-1){self._rids.splice(idx,1);self.snappingManager=new _147(_6.mixin({map:self},_145));}});}return this.snappingManager;},disableSnapping:function(){if(this.snappingManager){this.snappingManager.destroy();}this.snappingManager=null;}});if(has("extend-esri")){_12._CoreMap=_36;}return _36;});