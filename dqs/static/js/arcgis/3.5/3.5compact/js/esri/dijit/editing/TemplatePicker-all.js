/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_1(null,{declaredClass:"esri.layers.FeatureType",constructor:function(_d){if(_d&&_2.isObject(_d)){this.id=_d.id;this.name=_d.name;var _e=_d.symbol;if(_e){this.symbol=_7.fromJson(_e);}var _f=_d.domains,_10,i;var _11=this.domains={};for(_10 in _f){if(_f.hasOwnProperty(_10)){var _12=_f[_10];switch(_12.type){case "range":_11[_10]=new _8(_12);break;case "codedValue":_11[_10]=new _9(_12);break;case "inherited":_11[_10]=new _a(_12);break;}}}var _13=_d.templates;if(_13){var _14=this.templates=[];for(i=0;i<_13.length;i++){_14.push(new _b(_13[i]));}}}},toJson:function(){var _15={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16,_17=this.domains,_18=this.templates,_19=_6.fixJson;if(_17){var _1a=_15.domains={};for(_16 in _17){if(_17.hasOwnProperty(_16)){_1a[_16]=_17[_16]&&_17[_16].toJson();}}_19(_1a);}if(_18){_15.templates=_3.map(_18,function(_1b){return _1b.toJson();});}return _19(_15);}});if(_4("extend-esri")){_2.setObject("layers.FeatureType",_c,_5);}return _c;});},"dijit/hccss":function(){define("dijit/hccss",["dojo/dom-class","dojo/hccss","dojo/ready","dojo/_base/window"],function(_1c,has,_1d,win){_1d(90,function(){if(has("highcontrast")){_1c.add(win.body(),"dijit_a11y");}});return has;});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_1e,_1f){return _1e("dijit._Contained",null,{_getSibling:function(_20){var _21=this.domNode;do{_21=_21[_20+"Sibling"];}while(_21&&_21.nodeType!=1);return _21&&_1f.byNode(_21);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(_22,_23,_24,_25,_26,_27,_28,has,_29,win,_2a,_2b,_2c,_2d,_2e,_2f,_30,_31,_32,_33){var _34=function(_35,_36){return _35.style.cssText==undefined?_35.getAttribute("style"):_35.style.cssText;};var _37=_25("dojox.grid._View",[_2c,_2d],{defaultWidth:"18em",viewWidth:"",templateString:_2a,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_31._HeaderBuilder,_contentBuilderClass:_31._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");_2f.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);_2f.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){_30.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);_30.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_38){var vs=(this.structure=_38);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_39){if(_39){_26.forEach(_29("[widgetId]",_39).map(_23.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_3a,_3b){this._onBeforeRow(_3a,_3b);if(_3a>=0){this._cleanupRowWidgets(this.getRowNode(_3a));}},onAfterRow:function(_3c,_3d,_3e){this._onAfterRow(_3c,_3d,_3e);var g=this.grid;_26.forEach(_29(".dojoxGridStubNode",_3e),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _3f=window.parseInt(_30.attr(n,"cellIdx"),10);var _40=g.getCell(_3f);var w=_23.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}_22.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,_41;(_41=row[i]);i++){_41.view=this;this.flexCells=this.flexCells||_41.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _42=this.hasVScrollbar();var _43=_30.style(this.scrollboxNode,"overflow");if(this.noscroll||!_43||_43=="hidden"){_42=false;}else{if(_43=="scroll"){_42=true;}}return (_42?_2e.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||_30.style(h.firstChild,"width")):0;},setColumnsWidth:function(_44){this.headerContentNode.firstChild.style.width=_44+"px";if(this.viewWidth){this.viewWidth=_44+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,_30._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _45=this.grid.layout.cells;var _46=_27.hitch(this,function(_47,_48){!this.grid.isLeftToRight()&&(_48=!_48);var inc=_48?-1:1;var idx=this.header.getCellNodeIndex(_47)+inc;var _49=_45[idx];while(_49&&_49.getHeaderNode()&&_49.getHeaderNode().style.display=="none"){idx+=inc;_49=_45[idx];}if(_49){return _49.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _4a="dojoxGrid_bottomMarker";var _4b="dojoxGrid_topMarker";if(this.bottomMarker){_30.destroy(this.bottomMarker);}this.bottomMarker=_30.byId(_4a);if(this.topMarker){_30.destroy(this.topMarker);}this.topMarker=_30.byId(_4b);if(!this.bottomMarker){this.bottomMarker=_30.create("div",{"id":_4a,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=_30.create("div",{"id":_4b,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=_30.contentBox(this.bottomMarker);var _4c=_30.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _2b(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:_27.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_2b.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:_27.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_2b.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:_27.hitch(this,function(_4d){var src=this.source;if(src.current==src.targetAnchor&&src.before==_4d){return;}if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._removeItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}_2b.prototype._markTargetAnchor.call(src,_4d);var _4e=_4d?src.targetAnchor:_46(src.targetAnchor,src.before);var _4f=0;if(!_4e){_4e=src.targetAnchor;_4f=_30.contentBox(_4e).w+this.arrowDim.w/2+2;}var pos=_30.position(_4e,true);var _50=Math.floor(pos.x-this.arrowDim.w/2+_4f);_30.style(this.bottomMarker,"visibility","visible");_30.style(this.topMarker,"visibility","visible");_30.style(this.bottomMarker,{"left":_50+"px","top":(_4c+pos.y)+"px"});_30.style(this.topMarker,{"left":_50+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._addItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:_27.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._removeItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_2b.prototype._unmarkTargetAnchor.call(src);}),destroy:_27.hitch(this,function(){_28.disconnect(this._source_conn);_28.unsubscribe(this._source_sub);_2b.prototype.destroy.call(this.source);if(this.bottomMarker){_30.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){_30.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:_27.hitch(this,function(){_2b.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_28.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_28.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(_51){_30.style(_51,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_52,_53,_54){if(_33.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _55=this.grid.views.views;var _56=_55[_52.viewIndex];var _57=_55[this.index];if(_57!=_56){_56.convertColPctToFixed();_57.convertColPctToFixed();}},_onDndDrop:function(_58,_59,_5a){if(_33.manager().target!==this.source){if(_33.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _5b=function(n){return n?_30.attr(n,"idx"):null;};var w=_30.marginBox(_59[0]).w;if(_58.viewIndex!==this.index){var _5c=this.grid.views.views;var _5d=_5c[_58.viewIndex];var _5e=_5c[this.index];if(_5d.viewWidth&&_5d.viewWidth!="auto"){_5d.setColumnsWidth(_5d.getColumnsWidth()-w);}if(_5e.viewWidth&&_5e.viewWidth!="auto"){_5e.setColumnsWidth(_5e.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _5f=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_5f.moveColumn(_58.viewIndex,idx,_5b(_59[0]),_5b(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}_2f.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_60){var n=_60.name||_60.grid.getCellName(_60);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_60.index!=_60.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_60.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_60.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_61){var _62=this._hasHScroll||false;if(this._hasHScroll==undefined||_61){if(this.noscroll){this._hasHScroll=false;}else{var _63=_30.style(this.scrollboxNode,"overflow");if(_63=="hidden"){this._hasHScroll=false;}else{if(_63=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_62!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_64){var _65=this._hasVScroll||false;if(this._hasVScroll==undefined||_64){if(this.noscroll){this._hasVScroll=false;}else{var _66=_30.style(this.scrollboxNode,"overflow");if(_66=="hidden"){this._hasVScroll=false;}else{if(_66=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_65!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _67=false;this.grid.initialWidth="";var _68=_29("th",this.headerContentNode);var _69=_26.map(_68,function(c,_6a){var w=c.style.width;_30.attr(c,"vIdx",_6a);if(w&&w.slice(-1)=="%"){_67=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return _30.contentBox(c).w;});if(_67){_26.forEach(this.grid.layout.cells,function(_6b,idx){if(_6b.view==this){var _6c=_6b.view.getHeaderCellNode(_6b.index);if(_6c&&_30.hasAttr(_6c,"vIdx")){var _6d=window.parseInt(_30.attr(_6c,"vIdx"));this.setColWidth(idx,_69[_6d]);_30.removeAttr(_6c,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_6e){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var _6f=this;var _70=function(){var v;for(var i in _6f.grid.views.views){v=_6f.grid.views.views[i];if(v!==_6f&&v.hasHScrollbar()){return true;}}return false;};if(_6e||(this.noscroll&&_70())){h-=_2e.getScrollbar().h;}_2f.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_71){var _72=this.createRowNode(_71);this.buildRow(_71,_72);return _72;},createRowNode:function(_73){var _74=document.createElement("div");_74.className=this.classTag+"Row";if(this instanceof _24.grid._RowSelector){_30.attr(_74,"role","presentation");}else{_30.attr(_74,"role","row");if(this.grid.selectionMode!="none"){_74.setAttribute("aria-selected","false");}}_74[_2f.gridViewTag]=this.id;_74[_2f.rowIndexTag]=_73;this.rowNodes[_73]=_74;return _74;},buildRow:function(_75,_76){this.buildRowContent(_75,_76);this.styleRow(_75,_76);},buildRowContent:function(_77,_78){_78.innerHTML=this.content.generateHtml(_77,_77);if(this.flexCells&&this.contentWidth){_78.firstChild.style.width=this.contentWidth;}_2f.fire(this,"onAfterRow",[_77,this.structure.cells,_78]);},rowRemoved:function(_79){if(_79>=0){this._cleanupRowWidgets(this.getRowNode(_79));}this.grid.edit.save(this,_79);delete this.rowNodes[_79];},getRowNode:function(_7a){return this.rowNodes[_7a];},getCellNode:function(_7b,_7c){var row=this.getRowNode(_7b);if(row){return this.content.getCellNode(row,_7c);}},getHeaderCellNode:function(_7d){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_7d);}},styleRow:function(_7e,_7f){_7f._style=_34(_7f);this.styleRowNode(_7e,_7f);},styleRowNode:function(_80,_81){if(_81){this.doStyleRowNode(_80,_81);}},doStyleRowNode:function(_82,_83){this.grid.styleRowNode(_82,_83);},updateRow:function(_84){var _85=this.getRowNode(_84);if(_85){_85.style.height="";this.buildRow(_84,_85);}return _85;},updateRowStyles:function(_86){this.styleRowNode(_86,this.getRowNode(_86));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_87){if(has("ff")>=13){this._nativeScroll=true;}var _88=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_88&&this.firstScroll==1)||(_88&&this.firstScroll===0)){var s=_30.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_88?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_89){this.lastTop=_89;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_89;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_8a,_8b){this.grid.setCellWidth(_8a,_8b+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var _8c=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=_8c;this.headerNode.scrollLeft=_8c;}});var _8d=_25("dojox.grid._GridAvatar",_32,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _8e=this.manager.source,_8f;if(_8e.creator){_8f=_8e._normalizedCreator(_8e.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{_8f=this.manager.nodes[0].cloneNode(true);var _90,_91;if(_8f.tagName.toLowerCase()=="tr"){_90=dd.createElement("table");_91=dd.createElement("tbody");_91.appendChild(_8f);_90.appendChild(_91);_8f=_90;}else{if(_8f.tagName.toLowerCase()=="th"){_90=dd.createElement("table");_91=dd.createElement("tbody");var r=dd.createElement("tr");_90.cellPadding=_90.cellSpacing="0";r.appendChild(_8f);_91.appendChild(r);_90.appendChild(_91);_8f=_90;}}}_8f.id="";td.appendChild(_8f);tr.appendChild(img);tr.appendChild(td);_30.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_33.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_33.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _92=_33.manager().makeAvatar;_33.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!_30.hasClass(win.body(),"dijit_a11y")){return new _8d(this);}return _92.call(_33.manager());};return _37;});},"esri/toolbars/_Box":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_93,_94,_95,_96,has,_97,_98,_99,_9a,_9b,_9c,_9d,_9e,_9f,_a0){var BOX=_93(null,{declaredClass:"esri.toolbars._Box",constructor:function(_a1,map,_a2,_a3,_a4,_a5){this._graphic=_a1;this._map=map;this._toolbar=_a2;this._scale=_a3;this._rotate=_a4;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_a5;var _a6=_a2._options;this._markerSymbol=_a6.boxHandleSymbol;this._lineSymbol=_a6.boxLineSymbol;this._moveStartHandler=_94.hitch(this,this._moveStartHandler);this._firstMoveHandler=_94.hitch(this,this._firstMoveHandler);this._moveStopHandler=_94.hitch(this,this._moveStopHandler);this._moveHandler=_94.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_95.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_95.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_95.forEach(this._connects,_96.disconnect);}var _a7=this._toolbar._scratchGL;if(this._anchors){_95.forEach(this._anchors,function(_a8){_a7.remove(_a8.graphic);var mov=_a8.moveable;if(mov){mov.destroy();}});}if(this._box){_a7.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_a9=this._toolbar._scratchGL;var _aa=this._getBoxCoords();var _ab=new _9d(map.spatialReference);var _ac=_94.clone(_95.filter(_aa,function(pt,_ad){return (_ad!==8&&_ad%2===0);}));if(_ac[0]){_ac.push([_ac[0][0],_ac[0][1]]);}_ab.addPath(_ac);if(this._rotate){_ab.addPath([_aa[1],_aa[8]]);}if(this._box){this._box.setGeometry(_ab);}else{this._box=new _a0(_ab,this._lineSymbol);_a9.add(this._box);}if(this._anchors){_95.forEach(this._anchors,function(_ae,_af){if(!this._scale){_af=8;}var _b0=new _9c(_aa[_af],map.spatialReference);_ae.graphic.setGeometry(_b0);var mov=_ae.moveable,_b1=_ae.graphic.getDojoShape();if(_b1){if(!mov){_ae.moveable=this._getMoveable(_ae.graphic,_af);}else{if(_b1!==mov.shape){mov.destroy();_ae.moveable=this._getMoveable(_ae.graphic,_af);}}}},this);}else{this._anchors=[];this._connects=[];_95.forEach(_aa,function(_b2,_b3){if(!this._scale&&_b3<8){return;}_b2=new _9c(_b2,map.spatialReference);var _b4=new _a0(_b2,this._markerSymbol);_a9.add(_b4);this._anchors.push({graphic:_b4,moveable:this._getMoveable(_b4,_b3)});},this);}},_getBoxCoords:function(_b5){var _b6=this._graphic,map=this._map,_b7=this._getTransformedBoundingBox(_b6),_b8=[],pt,_b9,_ba;_95.forEach(_b7,function(_bb,_bc,arr){pt=_bb;_b9=arr[_bc+1];if(!_b9){_b9=arr[0];}_ba={x:(pt.x+_b9.x)/2,y:(pt.y+_b9.y)/2};if(!_b5){pt=map.toMap(pt);_ba=map.toMap(_ba);}_b8.push([pt.x,pt.y]);_b8.push([_ba.x,_ba.y]);});if(this._rotate){var _bd=_94.clone(_b8[1]);_bd=_b5?{x:_bd[0],y:_bd[1]}:map.toScreen({x:_bd[0],y:_bd[1],spatialReference:map.spatialReference});_bd.y-=this._toolbar._options.rotateHandleOffset;if(!_b5){_bd=map.toMap(_bd);}_b8.push([_bd.x,_bd.y]);}return _b8;},_getTransformedBoundingBox:function(_be){var map=this._map,_bf=_be.geometry.getExtent(),_c0=_be.geometry.spatialReference,_c1=new _9c(_bf.xmin,_bf.ymax,_c0),_c2=new _9c(_bf.xmax,_bf.ymin,_c0);_c1=map.toScreen(_c1);_c2=map.toScreen(_c2);return [{x:_c1.x,y:_c1.y},{x:_c2.x,y:_c1.y},{x:_c2.x,y:_c2.y},{x:_c1.x,y:_c2.y}];},_getAllGraphics:function(){var _c3=[this._box];if(this._anchors){_95.forEach(this._anchors,function(_c4){_c3.push(_c4.graphic);});}_c3=_95.filter(_c3,_9b.isDefined);return _c3;},_getMoveable:function(_c5,_c6){var _c7=_c5.getDojoShape();if(!_c7){return;}var _c8=new _98(_c7);_c8._index=_c6;this._connects.push(_96.connect(_c8,"onMoveStart",this._moveStartHandler));this._connects.push(_96.connect(_c8,"onFirstMove",this._firstMoveHandler));this._connects.push(_96.connect(_c8,"onMoveStop",this._moveStopHandler));_c8.onMove=this._moveHandler;var _c9=_c7.getEventSource();if(_c9){_97.set(_c9,"cursor",this._toolbar._cursors["box"+_c6]);}return _c8;},_moveStartHandler:function(_ca){this._toolbar["on"+(_ca.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_cb){var _cc=_cb.host._index,_cd=(this._wrapOffset=_cb.host.shape._wrapOffsets[0]||0),_ce=this._graphic.getLayer()._div.getTransform(),mx=_99,_cf,_d0,_d1,_d2=_95.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_cd,y:arr[1]};});_d1={x:_d2[1].x,y:_d2[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_ce),_d1);if(_cc===8){_cf=mx.multiplyPoint(mx.invert(_ce),_d2[1]);this._startLine=[this._centerCoord,_cf];this._moveLine=_94.clone(this._startLine);}else{_cf=mx.multiplyPoint(mx.invert(_ce),_d2[_cc]);_d0=mx.multiplyPoint(mx.invert(_ce),_d2[(_cc+4)%8]);this._firstMoverToCenter=Math.sqrt((_cf.x-this._centerCoord.x)*(_cf.x-this._centerCoord.x)+(_cf.y-this._centerCoord.y)*(_cf.y-this._centerCoord.y));this._startBox=_d0;this._startBox.width=(_d2[4].x-_d2[0].x);this._startBox.height=(_d2[4].y-_d2[0].y);this._moveBox=_94.clone(this._startBox);this._xfactor=_cf.x>_d0.x?1:-1;this._yfactor=_cf.y>_d0.y?1:-1;if(_cc===1||_cc===5){this._xfactor=0;}else{if(_cc===3||_cc===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_cc===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_d3,_d4){var _d5=_d3.host._index,_d6=this._defaultEventArgs,_d7,_d8,tx,pt,_d9,_da,_db,_dc=0,_dd=0,_de,_df,_e0;_d6.angle=0;_d6.scaleX=1;_d6.scaleY=1;if(_d5===8){_d7=this._startLine;_d8=this._moveLine;pt=_d8[1];pt.x+=_d4.dx;pt.y+=_d4.dy;_d9=this._getAngle(_d7,_d8);tx=_99.rotategAt(_d9,_d7[0]);this._graphic.getDojoShape().setTransform(tx);_d6.transform=tx;_d6.angle=_d9;_d6.around=_d7[0];}else{_d7=this._startBox;_d8=this._moveBox;_d8.width+=(_d4.dx*this._xfactor);_d8.height+=(_d4.dy*this._yfactor);if(this._uniformScaling){_de=_d8.x+this._xfactor*_d8.width;_df=_d8.y+this._yfactor*_d8.height;_e0=Math.sqrt((_de-this._centerCoord.x)*(_de-this._centerCoord.x)+(_df-this._centerCoord.y)*(_df-this._centerCoord.y));_da=_db=_e0/this._firstMoverToCenter;_dc=this._xfactor*_d7.width/2;_dd=this._yfactor*_d7.height/2;}else{_da=_d8.width/_d7.width;_db=_d8.height/_d7.height;}if(isNaN(_da)||_da===Infinity||_da===-Infinity){_da=1;}if(isNaN(_db)||_db===Infinity||_db===-Infinity){_db=1;}tx=_99.scaleAt(_da,_db,_d7.x+_dc,_d7.y+_dd);this._graphic.getDojoShape().setTransform(tx);_d6.transform=tx;_d6.scaleX=_da;_d6.scaleY=_db;_d6.around={x:_d7.x+_dc,y:_d7.y+_dd};}this._toolbar["on"+(_d5===8?this._rotateEvent:this._scaleEvent)](this._graphic,_d6);},_moveStopHandler:function(_e1){var _e2=this._graphic,_e3=this._toolbar,_e4=_e3._geo?_9e.geographicToWebMercator(_e2.geometry):_e2.geometry,_e5=_e4.spatialReference,_e6=_e2.getDojoShape(),_e7=_e6.getTransform(),_e8=_e2.getLayer()._div.getTransform();_e4=_e4.toJson();this._updateSegments(_e4.paths||_e4.rings,_e7,_e8,_e5);_e6.setTransform(null);_e4=_9f.fromJson(_e4);_e2.setGeometry(_e3._geo?_9e.webMercatorToGeographic(_e4,true):_e4);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_e3._endOperation("BOX");this._defaultEventArgs.transform=_e7;_e3["on"+(_e1.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_e9,_ea,_eb,_ec){var mx=_99,map=this._map,_ed=this._wrapOffset||0;_95.forEach(_e9,function(_ee){_95.forEach(_ee,function(_ef){var _f0=map.toScreen({x:_ef[0],y:_ef[1],spatialReference:_ec},true);_f0.x+=_ed;_f0=mx.multiplyPoint([_eb,_ea,mx.invert(_eb)],_f0);_f0.x-=_ed;var _f1=map.toMap(_f0);_ef[0]=_f1.x;_ef[1]=_f1.y;});});},_getAngle:function(_f2,_f3){var _f4=Math.atan2(_f2[0].y-_f2[1].y,_f2[0].x-_f2[1].x)*180/Math.PI,_f5=Math.atan2(_f3[0].y-_f3[1].y,_f3[0].x-_f3[1].x)*180/Math.PI;return _f5-_f4;}});if(has("extend-esri")){_94.setObject("toolbars._Box",BOX,_9a);}return BOX;});},"esri/dijit/editing/TemplatePickerItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_f6,_f7,_f8,has,_f9,_fa,_fb,_fc,gfx,_fd,_fe){var TPI=_f6([_fb,_fc],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(_ff,_100,_101,_102,_103){if(!_100){return;}var _104=gfx.createSurface(_ff,_101,_102);if(has("ie")<9){var _105=_104.getEventSource();_fa.set(_105,"position","relative");_fa.set(_105.parentNode,"position","relative");}var _106=(!this.legendOverride&&this._getDrawingToolShape(_100,_103))||_fd.getShapeDescriptors(_100);var _107;try{_107=_104.createShape(_106.defaultShape).setFill(_106.fill).setStroke(_106.stroke);}catch(e){_104.clear();_104.destroy();return;}var bbox=_107.getBoundingBox(),_108=bbox.width,_109=bbox.height,_10a=-(bbox.x+(_108/2)),_10b=-(bbox.y+(_109/2)),dim=_104.getDimensions(),_10c={dx:_10a+dim.width/2,dy:_10b+dim.height/2};if(_108>_101||_109>_102){var _10d=_108>_109?_108:_109;var _10e=_101<_102?_101:_102;var _10f=(_10e-5)/_10d;_f7.mixin(_10c,{xx:_10f,yy:_10f});}_107.applyTransform(_10c);return _104;},_getDrawingToolShape:function(_110,_111){var _112,_113=_111?_111.drawingTool||null:null;switch(_113){case "esriFeatureEditToolArrow":_112={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_112={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_112={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_112={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_112={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_112={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_112={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_112={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_112={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_110.type==="simplelinesymbol"||_110.type==="cartographiclinesymbol"){_112={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_112={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_112,fill:_110.getFill(),stroke:_110.getStroke()};},_repaint:function(_114){if(!_114){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_114.getStroke&&_114.setStroke){_114.setStroke(_114.getStroke());}if(_114.getFill&&_114.setFill){_114.setFill(_114.getFill());}if(_114.children&&_f7.isArray(_114.children)){_f8.forEach(_114.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){_f7.setObject("dijit.editing.TemplatePickerItem",TPI,_fe);}return TPI;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_115,_116,_117,_118,lang,dom,_119,_11a,_11b,on,_11c,dnd,_11d){var _11e=_116("dojo.dnd.Selector",_11d,{constructor:function(node,_11f){if(!_11f){_11f={};}this.singular=_11f.singular;this.autoSync=_11f.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_11c.press,lang.hitch(this,"onMouseDown")),on(this.node,_11c.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _11b();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_119.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_118.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_11e.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_115.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_120,data,_121,_122){var _123=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_123.call(this,item,hint);if(_120){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_11e.superclass.insertNodes.call(this,data,_121,_122);this._normalizedCreator=_123;return this;},destroy:function(){_11e.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_11a.isLeft(e)){_117.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_117.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_11c.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _11e;});},"dojo/parser":function(){define(["require","./_base/kernel","./_base/lang","./_base/array","./_base/config","./_base/html","./_base/window","./_base/url","./_base/json","./aspect","./date/stamp","./Deferred","./has","./query","./on","./ready"],function(_124,dojo,_125,_126,_127,_128,_129,_12a,_12b,_12c,_12d,_12e,has,_12f,don,_130){new Date("X");var _131=0;_12c.after(_125,"extend",function(){_131++;},true);function _132(ctor){var map=ctor._nameCaseMap,_133=ctor.prototype;if(!map||map._extendCnt<_131){map=ctor._nameCaseMap={};for(var name in _133){if(name.charAt(0)==="_"){continue;}map[name.toLowerCase()]=name;}map._extendCnt=_131;}return map;};var _134={};function _135(_136){var ts=_136.join();if(!_134[ts]){var _137=[];for(var i=0,l=_136.length;i<l;i++){var t=_136[i];_137[_137.length]=(_134[t]=_134[t]||(_125.getObject(t)||(~t.indexOf("/")&&_124(t))));}var ctor=_137.shift();_134[ts]=_137.length?(ctor.createSubclass?ctor.createSubclass(_137):ctor.extend.apply(ctor,_137)):ctor;}return _134[ts];};var _138={_clearCache:function(){_131++;_134={};},_functionFromScript:function(_139,_13a){var _13b="",_13c="",_13d=(_139.getAttribute(_13a+"args")||_139.getAttribute("args")),_13e=_139.getAttribute("with");var _13f=(_13d||"").split(/\s*,\s*/);if(_13e&&_13e.length){_126.forEach(_13e.split(/\s*,\s*/),function(part){_13b+="with("+part+"){";_13c+="}";});}return new Function(_13f,_13b+_139.innerHTML+_13c);},instantiate:function(_140,_141,_142){_141=_141||{};_142=_142||{};var _143=(_142.scope||dojo._scopeName)+"Type",_144="data-"+(_142.scope||dojo._scopeName)+"-",_145=_144+"type",_146=_144+"mixins";var list=[];_126.forEach(_140,function(node){var type=_143 in _141?_141[_143]:node.getAttribute(_145)||node.getAttribute(_143);if(type){var _147=node.getAttribute(_146),_148=_147?[type].concat(_147.split(/\s*,\s*/)):[type];list.push({node:node,types:_148});}});return this._instantiate(list,_141,_142);},_instantiate:function(_149,_14a,_14b){var _14c=_126.map(_149,function(obj){var ctor=obj.ctor||_135(obj.types);if(!ctor){throw new Error("Unable to resolve constructor for: '"+obj.types.join()+"'");}return this.construct(ctor,obj.node,_14a,_14b,obj.scripts,obj.inherited);},this);if(!_14a._started&&!_14b.noStart){_126.forEach(_14c,function(_14d){if(typeof _14d.startup==="function"&&!_14d._started){_14d.startup();}});}return _14c;},construct:function(ctor,node,_14e,_14f,_150,_151){var _152=ctor&&ctor.prototype;_14f=_14f||{};var _153={};if(_14f.defaults){_125.mixin(_153,_14f.defaults);}if(_151){_125.mixin(_153,_151);}var _154;if(has("dom-attributes-explicit")){_154=node.attributes;}else{if(has("dom-attributes-specified-flag")){_154=_126.filter(node.attributes,function(a){return a.specified;});}else{var _155=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false),_156=_155.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");_154=_126.map(_156.split(/\s+/),function(name){var _157=name.toLowerCase();return {name:name,value:(node.nodeName=="LI"&&name=="value")||_157=="enctype"?node.getAttribute(_157):node.getAttributeNode(_157).value};});}}var _158=_14f.scope||dojo._scopeName,_159="data-"+_158+"-",hash={};if(_158!=="dojo"){hash[_159+"props"]="data-dojo-props";hash[_159+"type"]="data-dojo-type";hash[_159+"mixins"]="data-dojo-mixins";hash[_158+"type"]="dojoType";hash[_159+"id"]="data-dojo-id";}var i=0,item,_15a=[],_15b,_15c;while(item=_154[i++]){var name=item.name,_15d=name.toLowerCase(),_15e=item.value;switch(hash[_15d]||_15d){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":_15c=_15e;break;case "data-dojo-id":case "jsid":_15b=_15e;break;case "data-dojo-attach-point":case "dojoattachpoint":_153.dojoAttachPoint=_15e;break;case "data-dojo-attach-event":case "dojoattachevent":_153.dojoAttachEvent=_15e;break;case "class":_153["class"]=node.className;break;case "style":_153["style"]=node.style&&node.style.cssText;break;default:if(!(name in _152)){var map=_132(ctor);name=map[_15d]||name;}if(name in _152){switch(typeof _152[name]){case "string":_153[name]=_15e;break;case "number":_153[name]=_15e.length?Number(_15e):NaN;break;case "boolean":_153[name]=_15e.toLowerCase()!="false";break;case "function":if(_15e===""||_15e.search(/[^\w\.]+/i)!=-1){_153[name]=new Function(_15e);}else{_153[name]=_125.getObject(_15e,false)||new Function(_15e);}_15a.push(name);break;default:var pVal=_152[name];_153[name]=(pVal&&"length" in pVal)?(_15e?_15e.split(/\s*,\s*/):[]):(pVal instanceof Date)?(_15e==""?new Date(""):_15e=="now"?new Date():_12d.fromISOString(_15e)):(pVal instanceof _12a)?(dojo.baseUrl+_15e):_12b.fromJson(_15e);}}else{_153[name]=_15e;}}}for(var j=0;j<_15a.length;j++){var _15f=_15a[j].toLowerCase();node.removeAttribute(_15f);node[_15f]=null;}if(_15c){try{_15c=_12b.fromJson.call(_14f.propsThis,"{"+_15c+"}");_125.mixin(_153,_15c);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_15c+"'");}}_125.mixin(_153,_14e);if(!_150){_150=(ctor&&(ctor._noScript||_152._noScript)?[]:_12f("> script[type^='dojo/']",node));}var _160=[],_161=[],_162=[],ons=[];if(_150){for(i=0;i<_150.length;i++){var _163=_150[i];node.removeChild(_163);var _164=(_163.getAttribute(_159+"event")||_163.getAttribute("event")),prop=_163.getAttribute(_159+"prop"),_165=_163.getAttribute(_159+"method"),_166=_163.getAttribute(_159+"advice"),_167=_163.getAttribute("type"),nf=this._functionFromScript(_163,_159);if(_164){if(_167=="dojo/connect"){_160.push({method:_164,func:nf});}else{if(_167=="dojo/on"){ons.push({event:_164,func:nf});}else{_153[_164]=nf;}}}else{if(_167=="dojo/aspect"){_160.push({method:_165,advice:_166,func:nf});}else{if(_167=="dojo/watch"){_162.push({prop:prop,func:nf});}else{_161.push(nf);}}}}}var _168=ctor.markupFactory||_152.markupFactory;var _169=_168?_168(_153,node,ctor):new ctor(_153,node);if(_15b){_125.setObject(_15b,_169);}for(i=0;i<_160.length;i++){_12c[_160[i].advice||"after"](_169,_160[i].method,_125.hitch(_169,_160[i].func),true);}for(i=0;i<_161.length;i++){_161[i].call(_169);}for(i=0;i<_162.length;i++){_169.watch(_162[i].prop,_162[i].func);}for(i=0;i<ons.length;i++){don(_169,ons[i].event,ons[i].func);}return _169;},scan:function(root,_16a){var list=[],mids=[],_16b={};var _16c=(_16a.scope||dojo._scopeName)+"Type",_16d="data-"+(_16a.scope||dojo._scopeName)+"-",_16e=_16d+"type",_16f=_16d+"textdir",_170=_16d+"mixins";var node=root.firstChild;var _171=_16a.inherited;if(!_171){function _172(node,attr){return (node.getAttribute&&node.getAttribute(attr))||(node.parentNode&&_172(node.parentNode,attr));};_171={dir:_172(root,"dir"),lang:_172(root,"lang"),textDir:_172(root,_16f)};for(var key in _171){if(!_171[key]){delete _171[key];}}}var _173={inherited:_171};var _174;var _175;function _176(_177){if(!_177.inherited){_177.inherited={};var node=_177.node,_178=_176(_177.parent);var _179={dir:node.getAttribute("dir")||_178.dir,lang:node.getAttribute("lang")||_178.lang,textDir:node.getAttribute(_16f)||_178.textDir};for(var key in _179){if(_179[key]){_177.inherited[key]=_179[key];}}}return _177.inherited;};while(true){if(!node){if(!_173||!_173.node){break;}node=_173.node.nextSibling;_175=false;_173=_173.parent;_174=_173.scripts;continue;}if(node.nodeType!=1){node=node.nextSibling;continue;}if(_174&&node.nodeName.toLowerCase()=="script"){type=node.getAttribute("type");if(type&&/^dojo\/\w/i.test(type)){_174.push(node);}node=node.nextSibling;continue;}if(_175){node=node.nextSibling;continue;}var type=node.getAttribute(_16e)||node.getAttribute(_16c);var _17a=node.firstChild;if(!type&&(!_17a||(_17a.nodeType==3&&!_17a.nextSibling))){node=node.nextSibling;continue;}var _17b;var ctor=null;if(type){var _17c=node.getAttribute(_170),_17d=_17c?[type].concat(_17c.split(/\s*,\s*/)):[type];try{ctor=_135(_17d);}catch(e){}if(!ctor){_126.forEach(_17d,function(t){if(~t.indexOf("/")&&!_16b[t]){_16b[t]=true;mids[mids.length]=t;}});}var _17e=ctor&&!ctor.prototype._noScript?[]:null;_17b={types:_17d,ctor:ctor,parent:_173,node:node,scripts:_17e};_17b.inherited=_176(_17b);list.push(_17b);}else{_17b={node:node,scripts:_174,parent:_173};}node=_17a;_174=_17e;_175=ctor&&ctor.prototype.stopParser&&!(_16a.template);_173=_17b;}var d=new _12e();if(mids.length){if(has("dojo-debug-messages")){console.warn("WARNING: Modules being Auto-Required: "+mids.join(", "));}_124(mids,function(){d.resolve(_126.filter(list,function(_17f){if(!_17f.ctor){try{_17f.ctor=_135(_17f.types);}catch(e){}}var _180=_17f.parent;while(_180&&!_180.types){_180=_180.parent;}var _181=_17f.ctor&&_17f.ctor.prototype;_17f.instantiateChildren=!(_181&&_181.stopParser&&!(_16a.template));_17f.instantiate=!_180||(_180.instantiate&&_180.instantiateChildren);return _17f.instantiate;}));});}else{d.resolve(list);}return d.promise;},_require:function(_182){var hash=_12b.fromJson("{"+_182.innerHTML+"}"),vars=[],mids=[],d=new _12e();for(var name in hash){vars.push(name);mids.push(hash[name]);}_124(mids,function(){for(var i=0;i<vars.length;i++){_125.setObject(vars[i],arguments[i]);}d.resolve(arguments);});return d.promise;},_scanAmd:function(root){var _183=new _12e(),_184=_183.promise;_183.resolve(true);var self=this;_12f("script[type='dojo/require']",root).forEach(function(node){_184=_184.then(function(){return self._require(node);});node.parentNode.removeChild(node);});return _184;},parse:function(_185,_186){var root;if(!_186&&_185&&_185.rootNode){_186=_185;root=_186.rootNode;}else{if(_185&&_125.isObject(_185)&&!("nodeType" in _185)){_186=_185;}else{root=_185;}}root=root?_128.byId(root):_129.body();_186=_186||{};var _187=_186.template?{template:true}:{},_188=[],self=this;var p=this._scanAmd(root,_186).then(function(){return self.scan(root,_186);}).then(function(_189){return _188=_188.concat(self._instantiate(_189,_187,_186));}).otherwise(function(e){console.error("dojo/parser::parse() error",e);throw e;});_125.mixin(_188,p);return _188;}};if(1){dojo.parser=_138;}if(_127.parseOnLoad){_130(100,_138,"parse");}return _138;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_18a,_18b,_18c){return _18a("dojox.grid.DataSelection",_18c,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _18b(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_18c.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_18d){var _18e=this.grid.getItemIndex(_18d);var idx=_18c.prototype.getNextSelected.call(this,_18e);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _18f=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_18f.push(this.grid.getItem(i));}}return _18f;},addToSelection:function(_190){if(this.mode=="none"){return;}var idx=null;if(typeof _190=="number"||typeof _190=="string"){idx=_190;}else{idx=this.grid.getItemIndex(_190);}_18c.prototype.addToSelection.call(this,idx);},deselect:function(_191){if(this.mode=="none"){return;}var idx=null;if(typeof _191=="number"||typeof _191=="string"){idx=_191;}else{idx=this.grid.getItemIndex(_191);}_18c.prototype.deselect.call(this,idx);},deselectAll:function(_192){var idx=null;if(_192||typeof _192=="number"){if(typeof _192=="number"||typeof _192=="string"){idx=_192;}else{idx=this.grid.getItemIndex(_192);}_18c.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dijit/_Container":function(){define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct"],function(_193,_194,_195){return _194("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_196,_197){var _198=this.containerNode;if(_197&&typeof _197=="number"){var _199=this.getChildren();if(_199&&_199.length>=_197){_198=_199[_197-1].domNode;_197="after";}}_195.place(_196.domNode,_198,_197);if(this._started&&!_196._started){_196.startup();}},removeChild:function(_19a){if(typeof _19a=="number"){_19a=this.getChildren()[_19a];}if(_19a){var node=_19a.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},_getSiblingOfChild:function(_19b,dir){var _19c=this.getChildren(),idx=_193.indexOf(this.getChildren(),_19b);return _19c[idx+dir];},getIndexOfChild:function(_19d){return _193.indexOf(this.getChildren(),_19d);}});});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_19e,_19f,_1a0,lang,win,_1a1,_1a2,has,keys,on,_1a3,_1a4,dnd,_1a5,_1a6){var _1a7=_19f("dojo.dnd.Manager",[_1a2],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_1a8){if(this.avatar){this.target=(_1a8&&_1a8.targetState!="Disabled")?_1a8:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_1a3.publish("/dnd/source/over",_1a8);},outSource:function(_1a9){if(this.avatar){if(this.target==_1a9){this.target=null;this.canDropFlag=false;this.avatar.update();_1a3.publish("/dnd/source/over",null);}}else{_1a3.publish("/dnd/source/over",null);}},startDrag:function(_1aa,_1ab,copy){_1a5.autoScrollStart(win.doc);this.source=_1aa;this.nodes=_1ab;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_1a3.publish("/dnd/start",_1aa,_1ab,this.copy);this.events=[on(win.doc,_1a4.move,lang.hitch(this,"onMouseMove")),on(win.doc,_1a4.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_1a0.stop),on(win.body(),"selectstart",_1a0.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_1a1.add(win.body(),c);},canDrop:function(flag){var _1ac=Boolean(this.target&&flag);if(this.canDropFlag!=_1ac){this.canDropFlag=_1ac;this.avatar.update();}},stopDrag:function(){_1a1.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_19e.forEach(this.events,function(_1ad){_1ad.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _1a6(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_1a5.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_1a3.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_1a3.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_1a3.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_1a3.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_1a1.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_1a7.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _1a7();}return dnd._manager;};return _1a7;});},"dijit/a11yclick":function(){define("dijit/a11yclick",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","dojo/_base/unload","dojo/_base/window"],function(on,_1ae,keys,_1af,has,_1b0,win){var _1b1=null;if(has("dom-addeventlistener")){win.doc.addEventListener("keydown",function(evt){_1b1=evt.target;},true);}else{(function(){var _1b2=function(evt){_1b1=evt.srcElement;};win.doc.attachEvent("onkeydown",_1b2);_1b0.addOnWindowUnload(function(){win.doc.detachEvent("onkeydown",_1b2);});})();}function _1b3(e){return (e.keyCode===keys.ENTER||e.keyCode===keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey;};return function(node,_1b4){if(/input|button/i.test(node.nodeName)){return on(node,"click",_1b4);}else{var _1b5=[on(node,"keydown",function(e){if(_1b3(e)){_1b1=e.target;e.preventDefault();}}),on(node,"keyup",function(e){if(_1b3(e)&&e.target==_1b1){_1b1=null;on.emit(e.target,"click",{cancelable:true,bubbles:true});}}),on(node,"click",function(e){_1b4.call(this,e);})];if(has("touch")){var _1b6;_1b5.push(on(node,"touchend",function(e){var _1b7=e.target;_1b6=setTimeout(function(){_1b6=null;on.emit(_1b7,"click",{cancelable:true,bubbles:true});},600);}),on(node,"click",function(e){if(_1b6){clearTimeout(_1b6);}}));}return {remove:function(){_1ae.forEach(_1b5,function(h){h.remove();});if(_1b6){clearTimeout(_1b6);_1b6=null;}}};}};return ret;});},"esri/toolbars/draw":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/_base/window","dojo/has","dojo/keys","dojo/dom-construct","dojo/dom-style","esri/kernel","esri/sniff","esri/toolbars/_toolbar","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/graphic","esri/geometry/jsonUtils","esri/geometry/webMercatorUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/Multipoint","esri/geometry/Rect","dojo/i18n!esri/nls/jsapi"],function(_1b8,lang,_1b9,_1ba,_1bb,win,has,keys,_1bc,_1bd,_1be,_1bf,_1c0,_1c1,_1c2,_1c3,_1c4,_1c5,_1c6,_1c7,_1c8,_1c9,Rect,_1ca){var DRAW=_1b8(_1c0,{declaredClass:"esri.toolbars.Draw",constructor:function(map,_1cb){this.markerSymbol=new _1c1(_1c1.STYLE_SOLID,10,new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2),new _1bb([0,0,0,0.25]));this.lineSymbol=new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2);this.fillSymbol=new _1c3(_1c3.STYLE_SOLID,new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2),new _1bb([0,0,0,0.25]));this._points=[];this._defaultOptions={showTooltips:true,drawTime:75,tolerance:8,tooltipOffset:15};this._options=lang.mixin(lang.mixin({},this._defaultOptions),_1cb||{});this._mouse=!has("esri-touch")&&!has("esri-pointer");if(!this._mouse){this._options.showTooltips=false;}this._onKeyDownHandler=lang.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=lang.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=lang.hitch(this,this._onMouseUpHandler);this._onClickHandler=lang.hitch(this,this._onClickHandler);this._onMouseMoveHandler=lang.hitch(this,this._onMouseMoveHandler);this._onMouseDragHandler=lang.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=lang.hitch(this,this._onDblClickHandler);this._updateTooltip=lang.hitch(this,this._updateTooltip);this._hideTooltip=lang.hitch(this,this._hideTooltip);this._redrawGraphic=lang.hitch(this,this._redrawGraphic);},_geometryType:null,respectDrawingVertexOrder:false,setRespectDrawingVertexOrder:function(set){this.respectDrawingVertexOrder=set;},setMarkerSymbol:function(_1cc){this.markerSymbol=_1cc;},setLineSymbol:function(_1cd){this.lineSymbol=_1cd;},setFillSymbol:function(_1ce){this.fillSymbol=_1ce;},activate:function(_1cf,_1d0){if(this._geometryType){this.deactivate();}var map=this.map,dc=_1ba.connect,Draw=DRAW;this._options=lang.mixin(lang.mixin({},this._options),_1d0||{});map.navigationManager.setImmediateClick(false);switch(_1cf){case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.TRIANGLE:case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.RECTANGLE:this._deactivateMapTools(true,false,false,true);this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);this._onMouseDownHandler_connect=dc(map,!this._mouse?"onSwipeStart":"onMouseDown",this._onMouseDownHandler);this._onMouseDragHandler_connect=dc(map,!this._mouse?"onSwipeMove":"onMouseDrag",this._onMouseDragHandler);this._onMouseUpHandler_connect=dc(map,!this._mouse?"onSwipeEnd":"onMouseUp",this._onMouseUpHandler);break;case Draw.POINT:this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);break;case Draw.LINE:case Draw.EXTENT:case Draw.FREEHAND_POLYLINE:case Draw.FREEHAND_POLYGON:this._deactivateMapTools(true,false,false,true);this._onMouseDownHandler_connect=dc(map,!this._mouse?"onSwipeStart":"onMouseDown",this._onMouseDownHandler);this._onMouseDragHandler_connect=dc(map,!this._mouse?"onSwipeMove":"onMouseDrag",this._onMouseDragHandler);this._onMouseUpHandler_connect=dc(map,!this._mouse?"onSwipeEnd":"onMouseUp",this._onMouseUpHandler);break;case Draw.POLYLINE:case Draw.POLYGON:case Draw.MULTI_POINT:map.navigationManager.setImmediateClick(true);this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);this._onDblClickHandler_connect=dc(map,"onDblClick",this._onDblClickHandler);map.disableDoubleClickZoom();break;default:console.error("Unsupported geometry type: "+_1cf);return;}this._onKeyDown_connect=dc(map,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=dc(map,"onExtentChange",this._redrawGraphic);this._geometryType=_1cf;this._toggleTooltip(true);if(map.snappingManager&&this._geometryType!=="freehandpolyline"&&this._geometryType!=="freehandpolygon"&&this._mouse){map.snappingManager._startSelectionLayerQuery();map.snappingManager._setUpSnapping();}this.onActivate(this._geometryType);},deactivate:function(){var map=this.map;this._clear();var ddc=_1ba.disconnect;ddc(this._onMouseDownHandler_connect);ddc(this._onMouseMoveHandler_connect);ddc(this._onMouseDragHandler_connect);ddc(this._onMouseUpHandler_connect);ddc(this._onClickHandler_connect);ddc(this._onDblClickHandler_connect);ddc(this._onKeyDown_connect);ddc(this._redrawConnect);this._onMouseDownHandler_connect=this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null;if(map.snappingManager){map.snappingManager._stopSelectionLayerQuery();map.snappingManager._killOffSnapping();}switch(this._geometryType){case DRAW.CIRCLE:case DRAW.ELLIPSE:case DRAW.TRIANGLE:case DRAW.ARROW:case DRAW.LEFT_ARROW:case DRAW.RIGHT_ARROW:case DRAW.UP_ARROW:case DRAW.DOWN_ARROW:case DRAW.RECTANGLE:case DRAW.LINE:case DRAW.EXTENT:case DRAW.FREEHAND_POLYLINE:case DRAW.FREEHAND_POLYGON:this._activateMapTools(true,false,false,true);break;case this.POLYLINE:case this.POLYGON:case this.MULTI_POINT:map.enableDoubleClickZoom();break;}var _1d1=this._geometryType;this._geometryType=null;map.navigationManager.setImmediateClick(false);this._toggleTooltip(false);this.onDeactivate(_1d1);},_clear:function(){if(this._graphic){this.map.graphics.remove(this._graphic,true);}if(this._tGraphic){this.map.graphics.remove(this._tGraphic,true);}this._graphic=this._tGraphic=null;if(this.map.snappingManager){this.map.snappingManager._setGraphic(null);}this._points=[];},finishDrawing:function(){var _1d2,_1d3=this._points,map=this.map,_1d4=map.spatialReference,Draw=DRAW;_1d3=_1d3.slice(0,_1d3.length);switch(this._geometryType){case Draw.POLYLINE:if(!this._graphic||_1d3.length<2){return;}_1d2=new _1c7(_1d4);_1d2.addPath([].concat(_1d3));break;case Draw.POLYGON:if(!this._graphic||_1d3.length<3){return;}_1d2=new _1c8(_1d4);var ring=[].concat(_1d3,[_1d3[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1d2.addRing(ring);break;case Draw.MULTI_POINT:_1d2=new _1c9(_1d4);_1b9.forEach(_1d3,function(pt){_1d2.addPoint(pt);});break;}_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(_1d2);},_drawEnd:function(_1d5){if(_1d5){var _1d6=this.map.spatialReference,geo;this.onDrawEnd(_1d5);if(_1d6){if(_1d6.isWebMercator()){geo=_1c6.webMercatorToGeographic(_1d5,true);}else{if(_1d6.wkid===4326){geo=_1c5.fromJson(_1d5.toJson());}}}this.onDrawComplete({geometry:_1d5,geographicGeometry:geo});}},_normalizeRect:function(_1d7,end,_1d8){var sx=_1d7.x,sy=_1d7.y,ex=end.x,ey=end.y,_1d9=Math.abs(sx-ex),_1da=Math.abs(sy-ey);return {x:Math.min(sx,ex),y:Math.max(sy,ey),width:_1d9,height:_1da,spatialReference:_1d8};},_onMouseDownHandler:function(evt){this._dragged=false;var _1db;if(this.map.snappingManager){_1db=this.map.snappingManager._snappingPoint;}var _1dc=_1db||evt.mapPoint,Draw=DRAW,map=this.map,_1dd=map.spatialReference;this._points.push(_1dc.offset(0,0));switch(this._geometryType){case Draw.LINE:this._graphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1dc.x,_1dc.y],[_1dc.x,_1dc.y]]],spatialReference:_1dd}),this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.EXTENT:break;case Draw.FREEHAND_POLYLINE:this._oldPoint=evt.screenPoint;var _1de=new _1c7(_1dd);_1de.addPath(this._points);this._graphic=map.graphics.add(new _1c4(_1de,this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.TRIANGLE:case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.RECTANGLE:case Draw.FREEHAND_POLYGON:this._oldPoint=evt.screenPoint;var _1df=new _1c8(_1dd);_1df.addRing(this._points);this._graphic=map.graphics.add(new _1c4(_1df,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;}if(has("esri-touch")){evt.preventDefault();}},_onMouseMoveHandler:function(evt){var _1e0;if(this.map.snappingManager){_1e0=this.map.snappingManager._snappingPoint;}var _1e1=this._points[this._points.length-1],end=_1e0||evt.mapPoint,_1e2=this._tGraphic,geom=_1e2.geometry;switch(this._geometryType){case DRAW.POLYLINE:case DRAW.POLYGON:geom.setPoint(0,0,{x:_1e1.x,y:_1e1.y});geom.setPoint(0,1,{x:end.x,y:end.y});_1e2.setGeometry(geom);break;}},_onMouseDragHandler:function(evt){if(has("esri-touch")&&!this._points.length){evt.preventDefault();return;}this._dragged=true;var _1e3;if(this.map.snappingManager){_1e3=this.map.snappingManager._snappingPoint;}var _1e4=this._points[0],end=_1e3||evt.mapPoint,map=this.map,_1e5=map.spatialReference,_1e6=this._graphic,Draw=DRAW,_1e7=map.toScreen(_1e4),_1e8=map.toScreen(end),pts=[],a=_1e8.x-_1e7.x,b=_1e8.y-_1e7.y,_1e9=60,d=Math.sqrt(a*a+b*b);switch(this._geometryType){case Draw.CIRCLE:this._hideTooltip();_1e6.geometry=_1c8.createCircle({center:_1e7,r:d,numberOfPoints:_1e9,map:map});_1e6.setGeometry(_1e6.geometry);break;case Draw.ELLIPSE:this._hideTooltip();_1e6.geometry=_1c8.createEllipse({center:_1e7,longAxis:a,shortAxis:b,numberOfPoints:_1e9,map:map});_1e6.setGeometry(_1e6.geometry);break;case Draw.TRIANGLE:this._hideTooltip();pts=[[0,-d],[0.8660254037844386*d,0.5*d],[-0.8660254037844386*d,0.5*d],[0,-d]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.ARROW:this._hideTooltip();var sina=b/d,cosa=a/d,tana=b/a;var f=cosa*0.25*d,e=0.25*d/tana,g=sina*0.25*d;pts=[[a,b],[a-f*(1+24/e),b+24*cosa-g],[a-f*(1+12/e),b+12*cosa-g],[-12*sina,12*cosa],[12*sina,-12*cosa],[a-f*(1-12/e),b-12*cosa-g],[a-f*(1-24/e),b-24*cosa-g],[a,b]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.LEFT_ARROW:this._hideTooltip();if(a<=0){pts=[[a,0],[0.75*a,b],[0.75*a,0.5*b],[0,0.5*b],[0,-0.5*b],[0.75*a,-0.5*b],[0.75*a,-b],[a,0]];}else{pts=[[0,0],[0.25*a,b],[0.25*a,0.5*b],[a,0.5*b],[a,-0.5*b],[0.25*a,-0.5*b],[0.25*a,-b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.RIGHT_ARROW:this._hideTooltip();if(a>=0){pts=[[a,0],[0.75*a,b],[0.75*a,0.5*b],[0,0.5*b],[0,-0.5*b],[0.75*a,-0.5*b],[0.75*a,-b],[a,0]];}else{pts=[[0,0],[0.25*a,b],[0.25*a,0.5*b],[a,0.5*b],[a,-0.5*b],[0.25*a,-0.5*b],[0.25*a,-b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.UP_ARROW:this._hideTooltip();if(b<=0){pts=[[0,b],[-a,0.75*b],[-0.5*a,0.75*b],[-0.5*a,0],[0.5*a,0],[0.5*a,0.75*b],[a,0.75*b],[0,b]];}else{pts=[[0,0],[-a,0.25*b],[-0.5*a,0.25*b],[-0.5*a,b],[0.5*a,b],[0.5*a,0.25*b],[a,0.25*b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.DOWN_ARROW:this._hideTooltip();if(b>=0){pts=[[0,b],[-a,0.75*b],[-0.5*a,0.75*b],[-0.5*a,0],[0.5*a,0],[0.5*a,0.75*b],[a,0.75*b],[0,b]];}else{pts=[[0,0],[-a,0.25*b],[-0.5*a,0.25*b],[-0.5*a,b],[0.5*a,b],[0.5*a,0.25*b],[a,0.25*b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.RECTANGLE:this._hideTooltip();pts=[[0,0],[a,0],[a,b],[0,b],[0,0]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.LINE:_1e6.setGeometry(lang.mixin(_1e6.geometry,{paths:[[[_1e4.x,_1e4.y],[end.x,end.y]]]}));break;case Draw.EXTENT:if(_1e6){map.graphics.remove(_1e6,true);}var rect=new Rect(this._normalizeRect(_1e4,end,_1e5));rect._originOnly=true;this._graphic=map.graphics.add(new _1c4(rect,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.FREEHAND_POLYLINE:this._hideTooltip();if(this._canDrawFreehandPoint(evt)===false){if(has("esri-touch")){evt.preventDefault();}return;}this._points.push(evt.mapPoint.offset(0,0));_1e6.geometry._insertPoints([end.offset(0,0)],0);_1e6.setGeometry(_1e6.geometry);break;case Draw.FREEHAND_POLYGON:this._hideTooltip();if(this._canDrawFreehandPoint(evt)===false){if(has("esri-touch")){evt.preventDefault();}return;}this._points.push(evt.mapPoint.offset(0,0));_1e6.geometry._insertPoints([end.offset(0,0)],0);_1e6.setGeometry(_1e6.geometry);break;}if(has("esri-touch")){evt.preventDefault();}},_canDrawFreehandPoint:function(evt){if(!this._oldPoint){return false;}var dx=this._oldPoint.x-evt.screenPoint.x;dx=(dx<0)?dx*-1:dx;var dy=this._oldPoint.y-evt.screenPoint.y;dy=(dy<0)?dy*-1:dy;var _1ea=this._options.tolerance;if(dx<_1ea&&dy<_1ea){return false;}var now=new Date();var _1eb=now-this._startTime;if(_1eb<this._options.drawTime){return false;}this._startTime=now;this._oldPoint=evt.screenPoint;return true;},_onMouseUpHandler:function(evt){if(!this._dragged){this._clear();return;}if(this._points.length===0){this._points.push(evt.mapPoint.offset(0,0));}var _1ec;if(this.map.snappingManager){_1ec=this.map.snappingManager._snappingPoint;}var _1ed=this._points[0],end=_1ec||evt.mapPoint,map=this.map,_1ee=map.spatialReference,Draw=DRAW,_1ef;switch(this._geometryType){case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.TRIANGLE:case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.RECTANGLE:_1ef=this._graphic.geometry;break;case Draw.LINE:_1ef=new _1c7({paths:[[[_1ed.x,_1ed.y],[end.x,end.y]]],spatialReference:_1ee});break;case Draw.EXTENT:_1ef=(new Rect(this._normalizeRect(_1ed,end,_1ee))).getExtent();break;case Draw.FREEHAND_POLYLINE:_1ef=new _1c7(_1ee);_1ef.addPath([].concat(this._points,[end.offset(0,0)]));break;case Draw.FREEHAND_POLYGON:_1ef=new _1c8(_1ee);var ring=[].concat(this._points,[end.offset(0,0),this._points[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1ef.addRing(ring);break;}if(has("esri-touch")){evt.preventDefault();}this._clear();this._drawEnd(_1ef);},_onClickHandler:function(evt){var _1f0;if(this.map.snappingManager){_1f0=this.map.snappingManager._snappingPoint;}var _1f1=_1f0||evt.mapPoint,map=this.map,_1f2=map.toScreen(_1f1),Draw=DRAW,pts,dx,dy,_1f3,geom,_1f4;this._points.push(_1f1.offset(0,0));switch(this._geometryType){case Draw.POINT:this._drawEnd(_1f1.offset(0,0));this._setTooltipMessage(0);break;case Draw.POLYLINE:if(this._points.length===1){var _1f5=new _1c7(map.spatialReference);_1f5.addPath(this._points);this._graphic=map.graphics.add(new _1c4(_1f5,this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}this._onMouseMoveHandler_connect=_1ba.connect(map,"onMouseMove",this._onMouseMoveHandler);this._tGraphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1f1.x,_1f1.y],[_1f1.x,_1f1.y]]],spatialReference:map.spatialReference}),this.lineSymbol),true);}else{this._graphic.geometry._insertPoints([_1f1.offset(0,0)],0);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol);_1f3=this._tGraphic;geom=_1f3.geometry;geom.setPoint(0,0,_1f1.offset(0,0));geom.setPoint(0,1,_1f1.offset(0,0));_1f3.setGeometry(geom);}break;case Draw.POLYGON:if(this._points.length===1){_1f4=new _1c8(map.spatialReference);_1f4.addRing(this._points);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}this._onMouseMoveHandler_connect=_1ba.connect(map,"onMouseMove",this._onMouseMoveHandler);this._tGraphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1f1.x,_1f1.y],[_1f1.x,_1f1.y]]],spatialReference:map.spatialReference}),this.fillSymbol),true);}else{this._graphic.geometry._insertPoints([_1f1.offset(0,0)],0);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol);_1f3=this._tGraphic;geom=_1f3.geometry;geom.setPoint(0,0,_1f1.offset(0,0));geom.setPoint(0,1,_1f1.offset(0,0));_1f3.setGeometry(geom);}break;case Draw.MULTI_POINT:var tps=this._points;if(tps.length===1){var _1f6=new _1c9(map.spatialReference);_1f6.addPoint(tps[tps.length-1]);this._graphic=map.graphics.add(new _1c4(_1f6,this.markerSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}}else{this._graphic.geometry.addPoint(tps[tps.length-1]);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol);}break;case Draw.ARROW:pts=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.LEFT_ARROW:pts=[[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.RIGHT_ARROW:pts=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.UP_ARROW:pts=[[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.DOWN_ARROW:pts=[[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.TRIANGLE:pts=[[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.RECTANGLE:pts=[[0,-96],[96,-96],[96,0],[0,0],[0,-96]];dx=_1f2.x-48;dy=_1f2.y+48;this._addShape(pts,dx,dy);break;case Draw.CIRCLE:_1f4=new _1c8(map.spatialReference);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);this._graphic.geometry=_1c8.createCircle({center:_1f2,r:48,numberOfPoints:60,map:map});this._graphic.setGeometry(this._graphic.geometry);this._drawEnd(this._graphic.geometry);break;case Draw.ELLIPSE:_1f4=new _1c8(map.spatialReference);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);this._graphic.geometry=_1c8.createEllipse({center:_1f2,longAxis:48,shortAxis:24,numberOfPoints:60,map:map});this._graphic.setGeometry(this._graphic.geometry);this._drawEnd(this._graphic.geometry);break;}this._setTooltipMessage(this._points.length);},_addShape:function(path,dx,dy){var _1f7=this.map.graphics.add(new _1c4(this._toPolygon(path,dx,dy),this.fillSymbol),true);this._setTooltipMessage(0);var geom;if(_1f7){geom=_1c5.fromJson(_1f7.geometry.toJson());this.map.graphics.remove(_1f7,true);}this._drawEnd(geom);_1f7=geom=null;},_toPolygon:function(path,dx,dy){var map=this.map;var _1f8=new _1c8(map.spatialReference);_1f8.addRing(_1b9.map(path,function(pt){return map.toMap({x:pt[0]+dx,y:pt[1]+dy});}));return _1f8;},_onDblClickHandler:function(evt){var _1f9,_1fa=this._points,map=this.map,_1fb=map.spatialReference,Draw=DRAW;if(has("esri-touch")){_1fa.push(evt.mapPoint);}_1fa=_1fa.slice(0,_1fa.length);switch(this._geometryType){case Draw.POLYLINE:if(!this._graphic||_1fa.length<2){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(evt);return;}_1f9=new _1c7(_1fb);_1f9.addPath([].concat(_1fa));break;case Draw.POLYGON:if(!this._graphic||_1fa.length<2){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(evt);return;}_1f9=new _1c8(_1fb);var ring=[].concat(_1fa,[_1fa[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1f9.addRing(ring);break;case Draw.MULTI_POINT:_1f9=new _1c9(_1fb);_1b9.forEach(_1fa,function(pt){_1f9.addPoint(pt);});break;}_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(_1f9);},_onKeyDownHandler:function(evt){if(evt.keyCode===keys.ESCAPE){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);}},_toggleTooltip:function(show){if(!this._options.showTooltips){return;}if(show){if(this._tooltip){return;}var _1fc=this.map.container;this._tooltip=_1bc.create("div",{"class":"tooltip"},_1fc);this._tooltip.style.display="none";this._tooltip.style.position="fixed";this._setTooltipMessage(0);this._onTooltipMouseEnterHandler_connect=_1ba.connect(this.map,"onMouseOver",this._updateTooltip);this._onTooltipMouseLeaveHandler_connect=_1ba.connect(this.map,"onMouseOut",this._hideTooltip);this._onTooltipMouseMoveHandler_connect=_1ba.connect(this.map,"onMouseMove",this._updateTooltip);}else{if(this._tooltip){_1ba.disconnect(this._onTooltipMouseEnterHandler_connect);_1ba.disconnect(this._onTooltipMouseLeaveHandler_connect);_1ba.disconnect(this._onTooltipMouseMoveHandler_connect);_1bc.destroy(this._tooltip);this._tooltip=null;}}},_hideTooltip:function(){var _1fd=this._tooltip;if(!_1fd){return;}_1fd.style.display="none";},_setTooltipMessage:function(_1fe){var _1ff=this._tooltip;if(!_1ff){return;}var _200=_1fe;var _201="";switch(this._geometryType){case DRAW.POINT:_201=_1ca.toolbars.draw.addPoint;break;case DRAW.ARROW:case DRAW.LEFT_ARROW:case DRAW.RIGHT_ARROW:case DRAW.UP_ARROW:case DRAW.DOWN_ARROW:case DRAW.TRIANGLE:case DRAW.RECTANGLE:case DRAW.CIRCLE:case DRAW.ELLIPSE:_201=_1ca.toolbars.draw.addShape;break;case DRAW.LINE:case DRAW.EXTENT:case DRAW.FREEHAND_POLYLINE:case DRAW.FREEHAND_POLYGON:_201=_1ca.toolbars.draw.freehand;break;case DRAW.POLYLINE:case DRAW.POLYGON:_201=_1ca.toolbars.draw.start;if(_200===1){_201=_1ca.toolbars.draw.resume;}else{if(_200>=2){_201=_1ca.toolbars.draw.complete;}}break;case DRAW.MULTI_POINT:_201=_1ca.toolbars.draw.addMultipoint;if(_200>=1){_201=_1ca.toolbars.draw.finish;}break;}_1ff.innerHTML=_201;},_updateTooltip:function(evt){var _202=this._tooltip;if(!_202){return;}var px,py;if(evt.clientX||evt.pageY){px=evt.clientX;py=evt.clientY;}else{px=evt.clientX+win.body().scrollLeft-win.body().clientLeft;py=evt.clientY+win.body().scrollTop-win.body().clientTop;}_202.style.display="none";_1bd.set(_202,{left:(px+this._options.tooltipOffset)+"px",top:py+"px"});_202.style.display="";},_redrawGraphic:function(_203,_204,_205,lod){if(_205||this.map.wrapAround180){var g=this._graphic;if(g){g.setGeometry(g.geometry);}g=this._tGraphic;if(g){g.setGeometry(g.geometry);}}},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});lang.mixin(DRAW,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"});if(has("extend-esri")){lang.setObject("toolbars.Draw",DRAW,_1be);}return DRAW;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_206,_207){return _206("dojox.grid._RowSelector",_207,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_208,_209){var w=this.contentWidth||0;_209.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_20a,_20b){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_20a)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_20a)){n.push("dojoxGridRowbarSelected");}_20b.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_20c,_20d,_20e,lang,_20f){return _20d("dojox.grid._Layout",null,{constructor:function(_210){this.grid=_210;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_211,_212,_213,_214,_215){var _216=this.structure[_211].cells[0];var _217=this.structure[_212].cells[0];var cell=null;var _218=0;var _219=0;for(var i=0,c;c=_216[i];i++){if(c.index==_213){_218=i;break;}}cell=_216.splice(_218,1)[0];cell.view=this.grid.views.views[_212];for(i=0,c=null;c=_217[i];i++){if(c.index==_214){_219=i;break;}}if(!_215){_219+=1;}_217.splice(_219,0,cell);var _21a=this.grid.getCell(this.grid.getSortIndex());if(_21a){_21a._currentlySorted=this.grid.getSortAsc();}this.cells=[];_213=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_213;this.cells.push(c);if("_currentlySorted" in c){var si=_213+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_213++;}}}_20e.forEach(this.cells,function(c){var _21b=c.markup[2].split(" ");var _21c=parseInt(_21b[1].substring(5));if(_21c!=c.index){_21b[1]="idx=\""+c.index+"\"";c.markup[2]=_21b.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_21d,_21e){var cell=this.cells[_21d];if(cell.hidden==_21e){cell.hidden=!_21e;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_20f.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_21f,_220,_221){var self=this;var _222=function(_223){var w=0;if(_223.colSpan>1){w=0;}else{w=_223.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _224={grid:this.grid,subrow:_21f,layoutIndex:_220,index:this.cells.length};if(_221&&_221 instanceof _20c.grid.cells._Base){var _225=lang.clone(_221);_224.unitWidth=_222(_225._props);_225=lang.mixin(_225,this._defaultCellProps,_221._props,_224);return _225;}var _226=_221.type||_221.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_20c.grid.cells.Cell;if(lang.isString(_226)){_226=lang.getObject(_226);}_224.unitWidth=_222(_221);return new _226(lang.mixin({},this._defaultCellProps,_221,_224));},addRowDef:function(_227,_228){var _229=[];var _22a=0,_22b=0,_22c=true;for(var i=0,def,cell;(def=_228[i]);i++){cell=this.addCellDef(_227,i,def);_229.push(cell);this.cells.push(cell);if(_22c&&cell.relWidth){_22a+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_22b+=window.parseInt(w,10);}else{if(w=="auto"){_22c=false;}}}}}if(_22a&&_22c){_20e.forEach(_229,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_22a)*(100-_22b))+"%";}});}return _229;},addRowsDef:function(_22d){var _22e=[];if(lang.isArray(_22d)){if(lang.isArray(_22d[0])){for(var i=0,row;_22d&&(row=_22d[i]);i++){_22e.push(this.addRowDef(i,row));}}else{_22e.push(this.addRowDef(0,_22d));}}return _22e;},addViewDef:function(_22f){this._defaultCellProps=_22f.defaultCell||{};if(_22f.width&&_22f.width=="auto"){delete _22f.width;}return lang.mixin({},_22f,{cells:this.addRowsDef(_22f.rows||_22f.cells)});},setStructure:function(_230){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_20c._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _231=this.grid.rowSelector;if(_231=="false"){sel=null;}else{if(_231!="true"){sel["width"]=_231;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _232=function(def){return ("name" in def||"field" in def||"get" in def);};var _233=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_232(def[0])){return true;}}return false;};var _234=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_232(def))));};if(lang.isArray(_230)){var _235=false;for(var i=0,st;(st=_230[i]);i++){if(_234(st)){_235=true;break;}}if(!_235){s.push(this.addViewDef({cells:_230}));}else{for(i=0;(st=_230[i]);i++){if(_233(st)){s.push(this.addViewDef({cells:st}));}else{if(_234(st)){s.push(this.addViewDef(st));}}}}}else{if(_234(_230)){s.push(this.addViewDef(_230));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_236,_237,lang,_238,has,_239,_23a){var _23b=_237(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_236._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_23c){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _23d=this._featureMap[oid];if(_23d){_23d._count++;}},_decRefCount:function(oid){var _23e=this._featureMap[oid];if(_23e){_23e._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_23f){var fmap=this._featureMap,_240=fmap[oid],_241=this.featureLayer;if(!_240){fmap[oid]=_23f;_241._add(_23f);_23f._count=0;}return _240||_23f;},_removeFeatureIIf:function(oid){var _242=this._featureMap[oid],_243=this.featureLayer;if(_242){if(_242._count){return;}delete this._featureMap[oid];_243._remove(_242);}return _242;},_clearIIf:function(){var i,_244=this.featureLayer,_245=_244.graphics,_246=_244._selectedFeatures,_247=_244.objectIdField;for(i=_245.length-1;i>=0;i--){var _248=_245[i];var oid=_248.attributes[_247];if(oid in _246){_248._count=1;continue;}_248._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_239[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_239[this._prefix+id];if(dfd){try{dfd.cancel();_239._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_239._validCheck(null);},_toggleVisibility:function(show){var _249=this.featureLayer,_24a=_249.graphics,_24b=show?"show":"hide",i,len=_24a.length;show=show&&_249._ager;for(i=0;i<len;i++){var _24c=_24a[i];_24c[_24b]();if(show){_249._repaint(_24c);}}},_applyTimeFilter:function(_24d){var _24e=this.featureLayer;if(!_24e.timeInfo||_24e.suspended){return;}if(!_24d){_24e._fireUpdateStart();}var _24f=_24e._trackManager;if(_24f){_24f.clearTracks();}var defn=_24e.getTimeDefinition(),_250=_24e._getOffsettedTE(_24e._mapTimeExtent);if(_250){_250=_24e._getTimeOverlap(defn,_250);if(_250){var _251=_24e._filterByTime(_24e.graphics,_250.startTime,_250.endTime);if(_24f){_24f.addFeatures(_251.match);}_238.forEach(_251.match,function(_252){var _253=_252._shape;if(!_252.visible){_252.show();_253=_252._shape;_253&&_253._moveToFront();}if(_24e._ager&&_253){_24e._repaint(_252);}});_238.forEach(_251.noMatch,function(_254){if(_254.visible){_254.hide();}});}else{this._toggleVisibility(false);}}else{if(_24f){_24f.addFeatures(_24e.graphics);}this._toggleVisibility(true);}if(_24f){_24f.moveLatestToFront();_24f.drawTracks();}if(!_24d){_24e._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_23b,_23a);}return _23b;});},"dijit/BackgroundIframe":function(){define("dijit/BackgroundIframe",["require","./main","dojo/_base/config","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window"],function(_255,_256,_257,_258,_259,lang,on,has,win){var _25a=new function(){var _25b=[];this.pop=function(){var _25c;if(_25b.length){_25c=_25b.pop();_25c.style.display="";}else{if(has("ie")<9){var burl=_257["dojoBlankHtmlUrl"]||_255.toUrl("dojo/resources/blank.html")||"javascript:\"\"";var html="<iframe src='"+burl+"' role='presentation'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_25c=win.doc.createElement(html);}else{_25c=_258.create("iframe");_25c.src="javascript:\"\"";_25c.className="dijitBackgroundIframe";_25c.setAttribute("role","presentation");_259.set(_25c,"opacity",0.1);}_25c.tabIndex=-1;}return _25c;};this.push=function(_25d){_25d.style.display="none";_25b.push(_25d);};}();_256.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(has("ie")||has("mozilla")){var _25e=(this.iframe=_25a.pop());node.appendChild(_25e);if(has("ie")<7||has("quirks")){this.resize(node);this._conn=on(node,"resize",lang.hitch(this,function(){this.resize(node);}));}else{_259.set(_25e,{width:"100%",height:"100%"});}}};lang.extend(_256.BackgroundIframe,{resize:function(node){if(this.iframe){_259.set(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){this._conn.remove();this._conn=null;}if(this.iframe){_25a.push(this.iframe);delete this.iframe;}}});return _256.BackgroundIframe;});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_25f,_260,_261,_262,_263,_264,_265,_266,_267,_268,_269,_26a,util,_26b,_26c,_26d,_26e,_26f,_270,lang,has,_271,html,_272){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _273=_260("dojox.grid._Grid",[_26b,_26c,_261],{templateString:_26e,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_263,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_271.initOnFontResize();this.connect(_271,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _274=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_26f.substitute(this.loadingMessage,_274);this.errorMessage=_26f.substitute(this.errorMessage,_274);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_270.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_275){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_275){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _266(this);this.focus=new _267(this);this.edit=new _268(this);},createSelection:function(){this.selection=new _269(this);},createScroller:function(){this.scroller=new _262();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_276){},createViews:function(){this.views=new _265(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_277,idx){var c=lang.getObject(_277);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_25f._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_278){var s=_278;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_279){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_279);},getColumnTogglingItems:function(){var _27a,_27b=[];_27a=_270.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _26d({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_27c){if(self.layout.setColumnVisibility(this._gridCell.index,_27c)){var _27d=this._gridCell.menuItems;if(_27d.length>1){_270.forEach(_27d,function(item){if(item!==this){item.setAttribute("checked",_27c);}},this);}_27c=_270.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_270.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_27c.length==1){_270.forEach(_27c[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _27e=_270.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_27e,1);delete this._gridCell;_26d.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_27b.push(item);}return item;},this);if(_27b.length==1){_27b[0].set("disabled",true);}return _27a;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_270.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_270.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_27f){this.setScrollTop(0);},getItem:function(_280){return null;},showMessage:function(_281){if(_281){this.messagesNode.innerHTML=_281;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_282,_283){this._pendingChangeSize=_282;this._pendingResultSize=_283;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_284,_285){_284=_284||this._pendingChangeSize;_285=_285||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _286=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_286.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_285){_284=_285;}if(!this._autoHeight&&_284){html.marginBox(this.domNode,_284);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _287=_270.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_287&&hh===undefined){hh=this._getHeaderHeight();}}if(_287){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _288=(!this.initialWidth&&this.autoWidth);var w=_288?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_288){this.domNode.style.width=vw+"px";}},adaptHeight:function(_289){var t=_289===undefined?this._getHeaderHeight():_289;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _28a=0,_28b=0;var _28c=_270.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_28a++;}else{_28b++;}return (!has);});if(_28a>0&&_28b>0){_270.forEach(_28c,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_28d,_28e){this.views.renderRow(_28d,_28e,this._skipRowRenormalize);},rowRemoved:function(_28f){this.views.rowRemoved(_28f);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_290){_290=Number(_290);if(this.updating){this.invalidated[_290]=true;}else{this.views.updateRow(_290);this.scroller.rowHeightChanged(_290);}},updateRows:function(_291,_292){_291=Number(_291);_292=Number(_292);var i;if(this.updating){for(i=0;i<_292;i++){this.invalidated[i+_291]=true;}}else{for(i=0;i<_292;i++){this.views.updateRow(i+_291,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_291);}},updateRowCount:function(_293){if(this.updating){this.invalidated.rowCount=_293;}else{this.rowCount=_293;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_293);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_294){this.views.updateRowStyles(_294);},getRowNode:function(_295){if(this.focus.focusView&&!(this.focus.focusView instanceof _26a)){return this.focus.focusView.rowNodes[_295];}else{for(var i=0,_296;(_296=this.views.views[i]);i++){if(!(_296 instanceof _26a)){return _296.rowNodes[_295];}}}return null;},rowHeightChanged:function(_297){this.views.renormalizeRow(_297);this.scroller.rowHeightChanged(_297);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_298){if(!this.fastScroll){this.setScrollTop(_298);return;}var _299=Math.abs(this.lastScrollTop-_298);this.lastScrollTop=_298;if(_299>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_298;this.views.setScrollTop(_298);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _29a=this;this._pendingScroll=window.setTimeout(function(){delete _29a._pendingScroll;_29a.finishScrollJob();},200);}else{this.setScrollTop(_298);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_29b){this.scroller.scroll(this.views.setScrollTop(_29b));},scrollToRow:function(_29c){this.setScrollTop(this.scroller.findScrollTop(_29c)+1);},styleRowNode:function(_29d,_29e){if(_29e){this.rows.styleRowNode(_29d,_29e);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_29f){return this.layout.cells[_29f];},setCellWidth:function(_2a0,_2a1){this.getCell(_2a0).unitWidth=_2a1;},getCellName:function(_2a2){return "Cell "+_2a2.index;},canSort:function(_2a3){},sort:function(){},getSortAsc:function(_2a4){_2a4=_2a4==undefined?this.sortInfo:_2a4;return Boolean(_2a4>0);},getSortIndex:function(_2a5){_2a5=_2a5==undefined?this.sortInfo:_2a5;return Math.abs(_2a5)-1;},setSortIndex:function(_2a6,_2a7){var si=_2a6+1;if(_2a7!=undefined){si*=(_2a7?1:-1);}else{if(this.getSortIndex()==_2a6){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_2a8){if(this.canSort(_2a8)){this.sortInfo=_2a8;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_2a9,_2aa){this.onStartEdit(_2a9,_2aa);},doApplyCellEdit:function(_2ab,_2ac,_2ad){this.onApplyCellEdit(_2ab,_2ac,_2ad);},doCancelEdit:function(_2ae){this.onCancelEdit(_2ae);},doApplyEdit:function(_2af){this.onApplyEdit(_2af);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_273.markupFactory=function(_2b0,node,ctor,_2b1){var _2b2=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_2b0.structure&&node.nodeName.toLowerCase()=="table"){_2b0.structure=_272("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_2b2(cg);}return v;});if(!_2b0.structure.length){_2b0.structure.push({__span:Infinity,cells:[]});}_272("thead > tr",node).forEach(function(tr,_2b3){var _2b4=0;var _2b5=0;var _2b6;var _2b7=null;_272("> th",tr).map(function(th){if(!_2b7){_2b6=0;_2b7=_2b0.structure[0];}else{if(_2b4>=(_2b6+_2b7.__span)){_2b5++;_2b6+=_2b7.__span;var _2b8=_2b7;_2b7=_2b0.structure[_2b5];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_2b4+=cell.colSpan;var _2b9=html.attr(th,"rowspan");if(_2b9){cell.rowSpan=_2b9;}if(html.hasAttr(th,"width")){cell.width=_2b2(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_2b1){_2b1(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_25f.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_2b7.cells[_2b3]){_2b7.cells[_2b3]=[];}_2b7.cells[_2b3].push(cell);});});}return new ctor(_2b0,node);};return _273;});},"dijit/_WidgetsInTemplateMixin":function(){define("dijit/_WidgetsInTemplateMixin",["dojo/_base/array","dojo/_base/declare","dojo/parser"],function(_2ba,_2bb,_2bc){return _2bb("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:false,widgetsInTemplate:true,_beforeFillContent:function(){if(this.widgetsInTemplate){var node=this.domNode;var cw=(this._startupWidgets=_2bc.parse(node,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,scope:"dojo"}));if(!cw.isFulfilled()){throw new Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), "+"unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}this._attachTemplateNodes(cw,function(n,p){return n[p];});}},startup:function(){_2ba.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);}});});},"esri/tasks/query":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/tasks/SpatialRelationship","dojo/has!extend-esri?esri/tasks/QueryTask","dojo/has!extend-esri?esri/tasks/RelationshipQuery","dojo/has!extend-esri?esri/tasks/StatisticDefinition"],function(_2bd,lang,_2be,_2bf,has,_2c0,_2c1,_2c2){var _2c3=_2bd(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=_2c3.SPATIAL_REL_INTERSECTS;},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:false,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,toJson:function(_2c4){var json={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},g=_2c4&&_2c4["geometry"]||this.geometry,ids=this.objectIds,_2c5=this.outFields,_2c6=this.outSpatialReference,_2c7=this.groupByFieldsForStatistics,_2c8=this.orderByFields,_2c9=this.outStatistics;if(g){json.geometry=g;json.geometryType=_2c1.getJsonType(g);json.inSR=g.spatialReference.wkid||_2bf.toJson(g.spatialReference.toJson());}if(ids){json.objectIds=ids.join(",");}if(_2c5){json.outFields=_2c5.join(",");}if(_2c7){json.groupByFieldsForStatistics=_2c7.join(",");}if(_2c8){json.orderByFields=_2c8.join(",");}if(_2c9){var _2ca=[];_2be.forEach(_2c9,function(item,idx){_2ca.push(item.toJson());});json.outStatistics=_2bf.toJson(_2ca);}if(_2c6!==null){json.outSR=_2c6.wkid||_2bf.toJson(_2c6.toJson());}else{if(g){json.outSR=g.spatialReference.wkid||_2bf.toJson(g.spatialReference.toJson());}}var _2cb=this.timeExtent;json.time=_2cb?_2cb.toJson().join(","):null;var _2cc=this.relationParam;if(_2cc&&this.spatialRelationship===_2c3.SPATIAL_REL_RELATION){json.relationParam=_2cc;}json.pixelSize=this.pixelSize?_2bf.toJson(this.pixelSize.toJson()):null;json._ts=this._ts;return json;}});lang.mixin(_2c3,_2c2);if(has("extend-esri")){lang.setObject("tasks.Query",_2c3,_2c0);}return _2c3;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_2cd,lang,has,_2ce,_2cf,_2d0){var _2d1=_2cd(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _2d2=json.prototype;this.prototype=new _2d0(_2d2.geometry,null,_2d2.attributes);}},toJson:function(){return _2cf.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_2d1,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_2d1,_2ce);}return _2d1;});},"dojo/dnd/Mover":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../sniff","../_base/window","../dom","../dom-geometry","../dom-style","../Evented","../on","../touch","./common","./autoscroll"],function(_2d3,_2d4,_2d5,lang,has,win,dom,_2d6,_2d7,_2d8,on,_2d9,dnd,_2da){return _2d4("dojo.dnd.Mover",[_2d8],{constructor:function(node,e,host){this.node=dom.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[on(d,_2d9.move,lang.hitch(this,"onFirstMove")),on(d,_2d9.move,lang.hitch(this,"onMouseMove")),on(d,_2d9.release,lang.hitch(this,"onMouseUp")),on(d,"dragstart",_2d5.stop),on(d.body,"selectstart",_2d5.stop)];_2da.autoScrollStart(d);if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){_2da.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY},e);_2d5.stop(e);},onMouseUp:function(e){if(has("webkit")&&has("mac")&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}_2d5.stop(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=_2d6.getMarginBox(this.node);var b=win.doc.body;var bs=_2d7.getComputedStyle(b);var bm=_2d6.getMarginBox(b,bs);var bc=_2d6.getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}this.events.shift().remove();},destroy:function(){_2d3.forEach(this.events,function(_2db){_2db.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});});},"esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_2dc,lang,has,_2dd){var _2de=_2dc(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(json){if(json&&lang.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});if(has("extend-esri")){lang.setObject("layers.FeatureEditResult",_2de,_2dd);}return _2de;});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _2df={};lang.setObject("dojo.data.util.sorter",_2df);_2df.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_2df.createSortFunction=function(_2e0,_2e1){var _2e2=[];function _2e3(attr,dir,comp,s){return function(_2e4,_2e5){var a=s.getValue(_2e4,attr);var b=s.getValue(_2e5,attr);return dir*comp(a,b);};};var _2e6;var map=_2e1.comparatorMap;var bc=_2df.basicComparator;for(var i=0;i<_2e0.length;i++){_2e6=_2e0[i];var attr=_2e6.attribute;if(attr){var dir=(_2e6.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_2e2.push(_2e3(attr,dir,comp,_2e1));}}return function(rowA,rowB){var i=0;while(i<_2e2.length){var ret=_2e2[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _2df;});},"dojo/touch":function(){define(["./_base/kernel","./aspect","./dom","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(dojo,_2e7,dom,lang,on,has,_2e8,_2e9,win){var _2ea=navigator.msPointerEnabled;var _2eb;function _2ec(_2ed,_2ee,_2ef){if(_2ea&&_2ef){return function(node,_2f0){return on(node,_2ef,_2f0);};}else{if(has("touch")){return function(node,_2f1){var _2f2=on(node,_2ee,_2f1),_2f3=on(node,_2ed,function(evt){if(!_2eb||(new Date()).getTime()>_2eb+1000){_2f1.call(this,evt);}});return {remove:function(){_2f2.remove();_2f3.remove();}};};}else{return function(node,_2f4){return on(node,_2ed,_2f4);};}}};var _2f5,_2f6,_2f7;if(has("touch")&&!_2ea){_2e9(function(){_2f7=win.body();win.doc.addEventListener("touchstart",function(_2f8){_2eb=(new Date()).getTime();var _2f9=_2f7;_2f7=_2f8.target;if(_2f7.dojoElementFromPoint){_2f7=_2f7.dojoElementFromPoint(_2f8.changedTouches[0].clientX,_2f8.changedTouches[0].clientY);}if(_2f9){on.emit(_2f9,"dojotouchout",{target:_2f9,relatedTarget:_2f7,bubbles:true});}if(_2f7){on.emit(_2f7,"dojotouchover",{target:_2f7,relatedTarget:_2f9,bubbles:true});}},true);on(win.doc,"touchmove",function(_2fa){_2eb=(new Date()).getTime();_2f6=_2fa;var _2fb=win.doc.elementFromPoint(_2fa.clientX,_2fa.clientY);if(_2fb){var _2fc=_2fb;if(_2fb.dojoElementFromPoint){_2fb=_2fb.dojoElementFromPoint(_2fa.clientX,_2fa.clientY);}if(_2f7!==_2fb){if(_2f7){on.emit(_2fc,"dojotouchout",{target:_2f7,relatedTarget:_2fb,bubbles:true});}if(_2fb){on.emit(_2fc,"dojotouchover",{target:_2fb,relatedTarget:_2f7,bubbles:true});}_2f7=_2fb;}on.emit(_2fc,"dojotouchmove",{target:_2fb,bubbles:true});}});on(win.doc,"touchend",function(_2fd){var node=win.doc.elementFromPoint(_2fd.clientX,_2fd.clientY);var _2fe=node;if(node.dojoElementFromPoint){node=node.dojoElementFromPoint(_2fd.clientX,_2fd.clientY);}if(node){on.emit(_2fe,"dojotouchend",lang.delegate(_2fd,{target:node,bubbles:true}));}});});_2f5=function(node,_2ff){return on(node,"dojotouchmove",function(_300){_2ff(lang.delegate(_2f6,{target:_300.target,preventDefault:function(){_2f6.preventDefault();},stopPropagation:function(){_300.stopPropagation();}}));});};}var _301={press:_2ec("mousedown","touchstart","MSPointerDown"),move:_2ec("mousemove",_2f5,"MSPointerMove"),release:_2ec("mouseup","dojotouchend","MSPointerUp"),cancel:_2ec(_2e8.leave,"touchcancel",has("touch")?"MSPointerCancel":null),over:_2ec("mouseover","dojotouchover","MSPointerOver"),out:_2ec("mouseout","dojotouchout","MSPointerOut"),enter:_2e8._eventHandler(_2ec("mouseover","dojotouchover","MSPointerOver")),leave:_2e8._eventHandler(_2ec("mouseout","dojotouchout","MSPointerOut"))};1&&(dojo.touch=_301);return _301;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_302,_303,lang,_304){return _302("dojox.grid.Selection",null,{constructor:function(_305){this.grid=_305;this.selected=[];this.setMode(_305.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_306){return this.grid.onCanSelect(_306);},onCanDeselect:function(_307){return this.grid.onCanDeselect(_307);},onSelected:function(_308){},onDeselected:function(_309){},onChanging:function(){},onChanged:function(){},isSelected:function(_30a){if(this.mode=="none"){return false;}return this.selected[_30a];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_30b){if(this.mode=="none"){return -1;}for(var i=_30b+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _30c=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_30c.push(i);}}return _30c;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_30d){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_30d);this.addToSelection(_30d);}else{this.toggleSelect(_30d);}},addToSelection:function(_30e){if(this.mode=="none"){return;}if(lang.isArray(_30e)){_303.forEach(_30e,this.addToSelection,this);return;}_30e=Number(_30e);if(this.selected[_30e]){this.selectedIndex=_30e;}else{if(this.onCanSelect(_30e)!==false){this.selectedIndex=_30e;var _30f=this.grid.getRowNode(_30e);if(_30f){_304.set(_30f,"aria-selected","true");}this._beginUpdate();this.selected[_30e]=true;this.onSelected(_30e);this._endUpdate();}}},deselect:function(_310){if(this.mode=="none"){return;}if(lang.isArray(_310)){_303.forEach(_310,this.deselect,this);return;}_310=Number(_310);if(this.selectedIndex==_310){this.selectedIndex=-1;}if(this.selected[_310]){if(this.onCanDeselect(_310)===false){return;}var _311=this.grid.getRowNode(_310);if(_311){_304.set(_311,"aria-selected","false");}this._beginUpdate();delete this.selected[_310];this.onDeselected(_310);this._endUpdate();}},setSelected:function(_312,_313){this[(_313?"addToSelection":"deselect")](_312);},toggleSelect:function(_314){if(lang.isArray(_314)){_303.forEach(_314,this.toggleSelect,this);return;}this.setSelected(_314,!this.selected[_314]);},_range:function(_315,inTo,func){var s=(_315>=0?_315:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_316,inTo){this._range(_316,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_317,inTo){this._range(_317,inTo,lang.hitch(this,"deselect"));},insert:function(_318){this.selected.splice(_318,0,false);if(this.selectedIndex>=_318){this.selectedIndex++;}},remove:function(_319){this.selected.splice(_319,1);if(this.selectedIndex>=_319){this.selectedIndex--;}},deselectAll:function(_31a){for(var i in this.selected){if((i!=_31a)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_31b,_31c,_31d){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_31b);}else{if(!_31d||this.rangeStartIndex<0){this.rangeStartIndex=_31b;}if(!_31c){this.deselectAll(_31b);}if(_31d){this.selectRange(this.rangeStartIndex,_31b);}else{if(_31c){this.toggleSelect(_31b);}else{this.addToSelection(_31b);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"dijit/_CssStateMixin":function(){define("dijit/_CssStateMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/has","dojo/_base/lang","dojo/on","dojo/ready","dojo/_base/window","./registry"],function(_31e,_31f,dom,_320,has,lang,on,_321,win,_322){var _323=_31f("dijit._CssStateMixin",[],{cssStateNodes:{},hovering:false,active:false,_applyAttributes:function(){this.inherited(arguments);_31e.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active","_opened"],function(attr){this.watch(attr,lang.hitch(this,"_setStateClass"));},this);for(var ap in this.cssStateNodes){this._trackMouseState(this[ap],this.cssStateNodes[ap]);}this._trackMouseState(this.domNode,this.baseClass);this._setStateClass();},_cssMouseEvent:function(_324){if(!this.disabled){switch(_324.type){case "mouseover":this._set("hovering",true);this._set("active",this._mouseDown);break;case "mouseout":this._set("hovering",false);this._set("active",false);break;case "mousedown":case "touchstart":this._set("active",true);break;case "mouseup":case "touchend":this._set("active",false);break;}}},_setStateClass:function(){var _325=this.baseClass.split(" ");function _326(_327){_325=_325.concat(_31e.map(_325,function(c){return c+_327;}),"dijit"+_327);};if(!this.isLeftToRight()){_326("Rtl");}var _328=this.checked=="mixed"?"Mixed":(this.checked?"Checked":"");if(this.checked){_326(_328);}if(this.state){_326(this.state);}if(this.selected){_326("Selected");}if(this._opened){_326("Opened");}if(this.disabled){_326("Disabled");}else{if(this.readOnly){_326("ReadOnly");}else{if(this.active){_326("Active");}else{if(this.hovering){_326("Hover");}}}}if(this.focused){_326("Focused");}var tn=this.stateNode||this.domNode,_329={};_31e.forEach(tn.className.split(" "),function(c){_329[c]=true;});if("_stateClasses" in this){_31e.forEach(this._stateClasses,function(c){delete _329[c];});}_31e.forEach(_325,function(c){_329[c]=true;});var _32a=[];for(var c in _329){_32a.push(c);}tn.className=_32a.join(" ");this._stateClasses=_325;},_subnodeCssMouseEvent:function(node,_32b,evt){if(this.disabled||this.readOnly){return;}function _32c(_32d){_320.toggle(node,_32b+"Hover",_32d);};function _32e(_32f){_320.toggle(node,_32b+"Active",_32f);};function _330(_331){_320.toggle(node,_32b+"Focused",_331);};switch(evt.type){case "mouseover":_32c(true);break;case "mouseout":_32c(false);_32e(false);break;case "mousedown":case "touchstart":_32e(true);break;case "mouseup":case "touchend":_32e(false);break;case "focus":case "focusin":_330(true);break;case "blur":case "focusout":_330(false);break;}},_trackMouseState:function(node,_332){node._cssState=_332;}});_321(function(){function _333(evt){if(!dom.isDescendant(evt.relatedTarget,evt.target)){for(var node=evt.target;node&&node!=evt.relatedTarget;node=node.parentNode){if(node._cssState){var _334=_322.getEnclosingWidget(node);if(_334){if(node==_334.domNode){_334._cssMouseEvent(evt);}else{_334._subnodeCssMouseEvent(node,node._cssState,evt);}}}}}};function _335(evt){evt.target=evt.srcElement;_333(evt);};var body=win.body(),_336=(has("touch")?[]:["mouseover","mouseout"]).concat(["mousedown","touchstart","mouseup","touchend"]);_31e.forEach(_336,function(type){if(body.addEventListener){body.addEventListener(type,_333,true);}else{body.attachEvent("on"+type,_335);}});on(body,"focusin, focusout",function(evt){var node=evt.target;if(node._cssState&&!node.getAttribute("widgetId")){var _337=_322.getEnclosingWidget(node);_337._subnodeCssMouseEvent(node,node._cssState,evt);}});});return _323;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_338,on,_339,_33a){return _338("dojox.gfx.Mover",null,{constructor:function(_33b,e,host){this.shape=_33b;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_33c=on(d,_339.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_339.move,lang.hitch(this,"onMouseMove")),on(d,_339.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_33a,"stop")),on(d,"selectstart",lang.hitch(_33a,"stop")),_33c];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_33a.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_33d){_33d.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_33e,lang,_33f){var _340=function(_341,_342){if(_341.style.cssText==undefined){_341.setAttribute("style",_342);}else{_341.style.cssText=_342;}};return _33e("dojox.grid._RowManager",null,{constructor:function(_343){this.grid=_343;},linesToEms:2,overRow:-2,prepareStylingRow:function(_344,_345){return {index:_344,node:_345,odd:Boolean(_344&1),selected:!!this.grid.selection.isSelected(_344),over:this.isOver(_344),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_346,_347){var row=this.prepareStylingRow(_346,_347);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_348){var i=_348;i.node.className=i.customClasses;var h=i.node.style.height;_340(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_349){this.grid.updateRowStyles(_349);},setOverRow:function(_34a){var last=this.overRow;this.overRow=_34a;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_34b){return (this.overRow==_34b&&!_33f.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"dojo/hccss":function(){define(["require","./_base/config","./dom-class","./dom-style","./has","./ready","./_base/window"],function(_34c,_34d,_34e,_34f,has,_350,win){has.add("highcontrast",function(){var div=win.doc.createElement("div");div.style.cssText="border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;"+"background-image: url("+(_34d.blankGif||_34c.toUrl("./resources/blank.gif"))+");";win.body().appendChild(div);var cs=_34f.getComputedStyle(div),_351=cs.backgroundImage,hc=(cs.borderTopColor==cs.borderRightColor)||(_351&&(_351=="none"||_351=="url(invalid-url:)"));if(has("ie")<=8){div.outerHTML="";}else{win.body().removeChild(div);}return hc;});_350(90,function(){if(has("highcontrast")){_34e.add(win.body(),"dj_a11y");}});return has;});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_352,win,dom,_353,_354,_355,has,_356){return _352("dojo.dnd.Avatar",null,{constructor:function(_357){this.manager=_357;this.construct();},construct:function(){var a=_355.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_358=this.manager.source,node,b=_355.create("tbody",null,a),tr=_355.create("tr",null,b),td=_355.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_355.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_355.create("span",{innerHTML:_358.generateText?this._generateText():""},td);_353.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_358.creator){node=_358._normalizedCreator(_358.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _359=_355.create("table"),_35a=_355.create("tbody",null,_359);_35a.appendChild(node);node=_359;}}node.id="";tr=_355.create("tr",null,b);td=_355.create("td",null,tr);td.appendChild(node);_353.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_355.destroy(this.node);this.node=false;},update:function(){_354.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_356(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_35b,_35c,lang,util,html){var _35d=function(_35e){var i=0,n,p=_35e.parentNode;while((n=p.childNodes[i++])){if(n==_35e){return i-1;}}return -1;};var _35f=function(_360){if(!_360){return;}dojo.forEach(_35b.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_360,true)){w.destroy();}});};var _361=function(_362){var node=html.byId(_362);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _363=function(_364,_365){var _366=[];var i=0,n;while((n=_364.childNodes[i])){i++;if(_361(n)==_365){_366.push(n);}}return _366;};var _367=function(_368){return _363(_368,"div");};return _35c("dojox.grid._Scroller",null,{constructor:function(_369){this.setContentNodes(_369);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_36a,_36b,_36c){switch(arguments.length){case 3:this.rowsPerPage=_36c;case 2:this.keepRows=_36b;case 1:this.rowCount=_36a;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_36d,_36e){return _36d?(Math.ceil(_36d/_36e)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_36f){this.keepRows=_36f;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_370){this.contentNodes=_370;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_371){this.invalidateNodes();this.rowCount=_371;var _372=this.pageCount;if(_372===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_372){for(var i=_372-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_372){this.height+=this.defaultPageHeight*(this.pageCount-_372-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_373){return Boolean(this.getDefaultPageNode(_373));},measurePage:function(_374){if(this.grid.rowHeight){return ((_374+1)*this.rowsPerPage>this.rowCount?this.rowCount-_374*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_374);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_375,_376){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_375].style.top=_376+"px";}},repositionPages:function(_377){var _378=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_378[_377];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_377):0);for(var p=_377+1;p<=last;p++){n=_378[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_379){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_379]);}},preparePage:function(_37a,_37b){var p=(_37b?this.popPage():null);for(var i=0;i<this.colCount;i++){var _37c=this.pageNodes[i];var _37d=(p===null?this.createPageNode():this.invalidatePageNode(p,_37c));_37d.pageIndex=_37a;_37c[_37a]=_37d;}},renderPage:function(_37e){var _37f=[];var i,j;for(i=0;i<this.colCount;i++){_37f[i]=this.pageNodes[i][_37e];}for(i=0,j=_37e*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_37f);}},removePage:function(_380){for(var i=0,j=_380*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_381){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_381,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_382){},pacifying:false,pacifyTicks:200,setPacifying:function(_383){if(this.pacifying!=_383){this.pacifying=_383;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _384=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _384;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _385=(!this._invalidating);if(!_385){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_385=true;}}if(_385){this.needPage(this.page,this.pageTop);}var _386=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _387=this.getPageHeight(this.page);this.averageRowHeight=(_387>0&&_386>0)?(_387/_386):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _388=this.pageCount-1;var _389=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_388]=_389;return _389;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_38a,_38b,_38c){if(this.pageExists(_38a)){var oh=this.getPageHeight(_38a);var h=(this.measurePage(_38a));if(h===undefined){h=oh;}this.pageHeights[_38a]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_38b)){if(!_38c){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_38a);}}else{this.repositionPages(_38a);}}return h;}return 0;},rowHeightChanged:function(_38d,_38e){this.updatePageHeight(Math.floor(_38d/this.rowsPerPage),false,_38e);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_38f){var ph=this.pageHeights[_38f];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_390){return this.stack.push(_390);},popPage:function(){return this.stack.shift();},findPage:function(_391){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_391){break;}}this.page=i;this.pageTop=h;},buildPage:function(_392,_393,_394){this.preparePage(_392,_393);this.positionPage(_392,_394);this.installPage(_392);this.renderPage(_392);this.pushPage(_392);},needPage:function(_395,_396){var h=this.getPageHeight(_395),oh=h;if(!this.pageExists(_395)){this.buildPage(_395,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_396);h=this.updatePageHeight(_395,true);}else{this.positionPage(_395,_396);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_397){this.grid.scrollTop=_397;if(this.colCount){this.startPacify();this.findPage(_397);var h=this.height;var b=this.getScrollBottom(_397);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_397);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_398){return (this.windowHeight>=0?_398+this.windowHeight:-1);},processNodeEvent:function(e,_399){var t=e.target;while(t&&(t!=_399)&&t.parentNode&&(t.parentNode.parentNode!=_399)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_399)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_35d(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_39a,_39b){},removeRow:function(_39c){},getDefaultPageNode:function(_39d){return this.getDefaultNodes()[_39d];},positionPageNode:function(_39e,_39f){},getPageNodePosition:function(_3a0){return _3a0.offsetTop;},invalidatePageNode:function(_3a1,_3a2){var p=_3a2[_3a1];if(p){delete _3a2[_3a1];this.removePage(_3a1,p);_35f(p);p.innerHTML="";}return p;},getPageRow:function(_3a3){return _3a3*this.rowsPerPage;},getLastPageRow:function(_3a4){return Math.min(this.rowCount,this.getPageRow(_3a4+1))-1;},getFirstVisibleRow:function(_3a5,_3a6,_3a7){if(!this.pageExists(_3a5)){return 0;}var row=this.getPageRow(_3a5);var _3a8=this.getDefaultNodes();var rows=_367(_3a8[_3a5]);for(var i=0,l=rows.length;i<l&&_3a6<_3a7;i++,row++){_3a6+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_3a9,_3aa,_3ab){if(!this.pageExists(_3a9)){return 0;}var _3ac=this.getDefaultNodes();var row=this.getLastPageRow(_3a9);var rows=_367(_3ac[_3a9]);for(var i=rows.length-1;i>=0&&_3aa>_3ab;i--,row--){_3aa-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_3ad){var _3ae=this.getDefaultNodes();var rows=_367(_3ae[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_3ad){this.offset=h-(t-_3ad);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_3af){var _3b0=Math.floor(_3af/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_3b0;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_3b0;this.needPage(_3b0,this.pageTop);var _3b1=this.getDefaultNodes();var rows=_367(_3b1[_3b0]);var r=_3af-this.rowsPerPage*_3b0;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _3b2={};lang.setObject("dojo.data.util.filter",_3b2);_3b2.patternToRegExp=function(_3b3,_3b4){var rxp="^";var c=null;for(var i=0;i<_3b3.length;i++){c=_3b3.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_3b3.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_3b4){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _3b2;});},"esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_3b5,lang,_3b6,_3b7,has,_3b8,_3b9,_3ba,_3bb,_3bc,_3bd,_3be){var GM=_3b5(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_3bf,map,_3c0){this.graphic=_3bf;this.map=map;this.toolbar=_3c0;this._enableGraphicMover();this._moved=false;},refresh:function(_3c1){var _3c2=this.graphic.getDojoShape();if(_3c2&&(_3c1||!_3c2._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _3c3=this.graphic,_3c4=_3c3.getDojoShape();if(_3c4){_3c4._hostGraphic=_3c3;this._moveable=new _3b9(_3c4,{mover:GM.Mover});this._moveStartHandle=_3b6.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_3b6.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_3b6.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_3b6.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_3c4.getEventSource();if(node){_3b8.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _3c5=this._moveable;if(_3c5){_3b6.disconnect(this._moveStartHandle);_3b6.disconnect(this._firstMoveHandle);_3b6.disconnect(this._movingHandle);_3b6.disconnect(this._moveStopHandle);var _3c6=_3c5.shape;if(_3c6){_3c6._hostGraphic=null;var node=_3c6.getEventSource();if(node){_3b8.set(node,"cursor",null);}}_3c5.destroy();}this._moveable=null;},_moveStartHandler:function(){var _3c7=this.graphic,map=this.map;this._startTx=_3c7.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_3c7);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_3c8){this.toolbar.onGraphicMove(this.graphic,_3c8.shape.getTransform());},_moveStopHandler:function(_3c9){var _3ca=this.graphic,_3cb=this.toolbar,map=this.map,mx=_3bb,_3cc=_3cb._geo?_3bd.geographicToWebMercator(_3ca.geometry):_3ca.geometry,type=_3cc.type,_3cd=_3ca.getDojoShape(),tx=_3cd.getTransform();if(_3b7.toJson(tx)!==_3b7.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _3ce=[tx,mx.invert(this._startTx)],_3cf;if(map.snappingManager){_3cf=map.snappingManager._snappingPoint;}_3cc=_3cf||map.toMap(mx.multiplyPoint(_3ce,map.toScreen(_3cc,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_3cc=this._updatePolyGeometry(_3cc,_3cc.paths,tx);break;case "polygon":_3cc=this._updatePolyGeometry(_3cc,_3cc.rings,tx);break;}_3cd.setTransform(null);_3ca.setGeometry(_3cb._geo?_3bd.webMercatorToGeographic(_3cc,true):_3cc);}else{this._moved=false;}_3cb._endOperation("MOVE");_3cb.onGraphicMoveStop(_3ca,tx);if(!this._moved){var e=_3c9.__e,_3d0=this.map.position,pt=new _3be(e.pageX-_3d0.x,e.pageY-_3d0.y);_3cb.onGraphicClick(_3ca,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_3d1,_3d2,_3d3){var map=this.map,_3d4=_3d1.getPoint(0,0),_3d5=map.toMap(map.toScreen(_3d4).offset(_3d3.dx,_3d3.dy)),_3d6=_3d5.x-_3d4.x,_3d7=_3d5.y-_3d4.y,i,j,seg,_3d8;for(i=0;i<_3d2.length;i++){seg=_3d2[i];for(j=0;j<seg.length;j++){_3d8=_3d1.getPoint(i,j);_3d1.setPoint(i,j,_3d8.offset(_3d6,_3d7));}}return _3d1;}});GM.Mover=_3b5(_3ba,{declaredClass:"esri.toolbars._Mover",constructor:function(_3d9,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_3bc);lang.setObject("toolbars._Mover",GM.Mover,_3bc);}return GM;});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_3da,_3db,_3dc,_3dd,keys,_3de,_3df,_3e0,lang){return _3de("dijit._KeyNavContainer",[_3dc,_3db],{tabIndex:"0",connectKeyNavHandlers:function(_3e1,_3e2){var _3e3=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_3dd.forEach(_3e1,function(code){_3e3[code]=prev;});_3dd.forEach(_3e2,function(code){_3e3[code]=next;});_3e3[keys.HOME]=lang.hitch(this,"focusFirstChild");_3e3[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_3da.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_3dd.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_3e4,_3e5){this.inherited(arguments);this._startupChild(_3e4);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_3e6,last){if(!_3e6){return;}if(this.focusedChild&&_3e6!==this.focusedChild){this._onChildBlur(this.focusedChild);}_3e6.set("tabIndex",this.tabIndex);_3e6.focus(last?"end":"start");this._set("focusedChild",_3e6);},_startupChild:function(_3e7){_3e7.set("tabIndex","-1");this.connect(_3e7,"_onFocus",function(){_3e7.set("tabIndex",this.tabIndex);});this.connect(_3e7,"_onBlur",function(){_3e7.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_3e0.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_3e0.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_3df.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_3e8,dir){if(_3e8){_3e8=this._getSiblingOfChild(_3e8,dir);}var _3e9=this.getChildren();for(var i=0;i<_3e9.length;i++){if(!_3e8){_3e8=_3e9[(dir>0)?0:(_3e9.length-1)];}if(_3e8.isFocusable()){return _3e8;}_3e8=this._getSiblingOfChild(_3e8,dir);}return null;}});});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_3ea,_3eb,_3ec,has){return _3eb("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_3ed){var i=_3ed;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_3ed);this.edit.styleRow(_3ed);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _3ee;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_3ee=this.focus.getHeaderIndex();if(_3ee>=0){this.setSortIndex(_3ee);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_3ec.stop(e);}if(!e.shiftKey){var _3ef=this.edit.isEditing();this.edit.apply();if(!_3ef){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _3f0=this.focus.focusView||this.views.views[0];_3f0.content.decorateEvent(e);this.onRowClick(e);_3ec.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_3ee=this.focus.getHeaderIndex();if(_3ee>=0){this.setSortIndex(_3ee);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_3ec.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _3f1=e.keyCode;_3ec.stop(e);_3ee=this.focus.getHeaderIndex();if(_3ee>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_3ee,(_3f1==keys.LEFT_ARROW?-1:1)*5);}else{var _3f2=(_3f1==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_3f2*=-1;}this.focus.move(0,_3f2);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_3ec.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_3ec.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_3ec.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_3ec.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_3ea.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_3ea.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _3f3;if(this._click.length>1&&has("ie")){_3f3=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_3f3=this._click[0];}else{_3f3=e;}}this.focus.setFocusCell(_3f3.cell,_3f3.rowIndex);this.onRowClick(_3f3);this.edit.setEditCell(_3f3.cell,_3f3.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_3f4,_3f5){this.edit.cellFocus(_3f4,_3f5);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_3ec.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_3ea.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_3ea.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_3ec.stop(e);}},onStartEdit:function(_3f6,_3f7){},onApplyCellEdit:function(_3f8,_3f9,_3fa){},onCancelEdit:function(_3fb){},onApplyEdit:function(_3fc){},onCanSelect:function(_3fd){return true;},onCanDeselect:function(_3fe){return true;},onSelected:function(_3ff){this.updateRowStyles(_3ff);},onDeselected:function(_400){this.updateRowStyles(_400);},onSelectionChanged:function(){}});});},"dojo/dnd/autoscroll":function(){define(["../_base/lang","../sniff","../_base/window","../dom-geometry","../dom-style","../window"],function(lang,has,win,_401,_402,_403){var _404={};lang.setObject("dojo.dnd.autoscroll",_404);_404.getViewport=_403.getBox;_404.V_TRIGGER_AUTOSCROLL=32;_404.H_TRIGGER_AUTOSCROLL=32;_404.V_AUTOSCROLL_VALUE=16;_404.H_AUTOSCROLL_VALUE=16;var _405,doc=win.doc,_406=Infinity,_407=Infinity;_404.autoScrollStart=function(d){doc=d;_405=_403.getBox(doc);var html=win.body(doc).parentNode;_406=Math.max(html.scrollHeight-_405.h,0);_407=Math.max(html.scrollWidth-_405.w,0);};_404.autoScroll=function(e){var v=_405||_403.getBox(doc),html=win.body(doc).parentNode,dx=0,dy=0;if(e.clientX<_404.H_TRIGGER_AUTOSCROLL){dx=-_404.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-_404.H_TRIGGER_AUTOSCROLL){dx=Math.min(_404.H_AUTOSCROLL_VALUE,_407-html.scrollLeft);}}if(e.clientY<_404.V_TRIGGER_AUTOSCROLL){dy=-_404.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-_404.V_TRIGGER_AUTOSCROLL){dy=Math.min(_404.V_AUTOSCROLL_VALUE,_406-html.scrollTop);}}window.scrollBy(dx,dy);};_404._validNodes={"div":1,"p":1,"td":1};_404._validOverflow={"auto":1,"scroll":1};_404.autoScrollNodes=function(e){var b,t,w,h,rx,ry,dx=0,dy=0,_408,_409;for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in _404._validNodes)){var s=_402.getComputedStyle(n),_40a=(s.overflow.toLowerCase() in _404._validOverflow),_40b=(s.overflowX.toLowerCase() in _404._validOverflow),_40c=(s.overflowY.toLowerCase() in _404._validOverflow);if(_40a||_40b||_40c){b=_401.getContentBox(n,s);t=_401.position(n,true);}if(_40a||_40b){w=Math.min(_404.H_TRIGGER_AUTOSCROLL,b.w/2);rx=e.pageX-t.x;if(has("webkit")||has("opera")){rx+=win.body().scrollLeft;}dx=0;if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}_408=n.scrollLeft;n.scrollLeft=n.scrollLeft+dx;}}if(_40a||_40c){h=Math.min(_404.V_TRIGGER_AUTOSCROLL,b.h/2);ry=e.pageY-t.y;if(has("webkit")||has("opera")){ry+=win.body().scrollTop;}dy=0;if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}_409=n.scrollTop;n.scrollTop=n.scrollTop+dy;}}if(dx||dy){return;}}try{n=n.parentNode;}catch(x){n=null;}}_404.autoScroll(e);};return _404;});},"dijit/Destroyable":function(){define("dijit/Destroyable",["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(_40d,_40e,_40f){return _40f("dijit.Destroyable",null,{destroy:function(_410){this._destroyed=true;},own:function(){_40d.forEach(arguments,function(_411){var _412="destroyRecursive" in _411?"destroyRecursive":"destroy" in _411?"destroy":"remove";var odh=_40e.before(this,"destroy",function(_413){_411[_412](_413);});var hdh=_40e.after(_411,_412,function(){odh.remove();hdh.remove();},true);},this);return arguments;}});});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_414,_415,lang,_416,_417,_418,_419,has,ioq,_41a,i18n,_41b,_41c,_41d,_41e,_41f,_420,_421,_422,_423,_424,_425,_426,_427,_428,_429,_42a,_42b,_42c,_42d,_42e,_42f,_430,_431,_432,_433,_434,_435,_436){var _437=_414(_42d,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",constructor:function(url,_438){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_438&&_438.outFields;this._loadCallback=_438&&_438.loadCallback;var _439=_438&&_438._usePatch;this._usePatch=(_439===null||_439===undefined)?true:_439;this._trackIdField=_438&&_438.trackIdField;this.objectIdField=_438&&_438.objectIdField;this._maxOffset=_438&&_438.maxAllowableOffset;this._optEditable=_438&&_438.editable;this._optAutoGen=_438&&_438.autoGeneralize;this.editSummaryCallback=_438&&_438.editSummaryCallback;this.userId=_438&&_438.userId;this.userIsAdmin=_438&&_438.userIsAdmin;this.useMapTime=(_438&&_438.hasOwnProperty("useMapTime"))?(!!_438.useMapTime):true;this.source=_438&&_438.source;this.gdbVersion=_438&&_438.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_41c.isDefined(_438&&_438.mode)?_438.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _433(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_438&&_438.tileWidth)||512;this._tileHeight=(_438&&_438.tileHeight)||512;this._mode=new _434(this);var _43a=_438&&_438.latticeTiling;this.latticeTiling=_43a;break;case ctor.MODE_SELECTION:this._mode=new _435(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _427(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _43b=this._url.path;this._fserver=false;if(_43b.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _43c=_438&&_438.resourceInfo;if(_43c){this._initLayer(_43c);}else{if(this.source){var _43d={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_417.toJson(_43d)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_41d({url:_43b,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}this.registerConnectEvents("esri.layers.FeatureLayer",{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]});},_initLayer:function(_43e,io){if(_43e||io){this._json=_43e;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_43e&&_43e._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _433(this);this._isSnapshot=true;this._featureSet=_43e.featureSet;this._nextId=_43e.nextObjectId;_43e=_43e.layerDefinition;}if(_43e.hasOwnProperty("capabilities")){var _43f=(this.capabilities=_43e.capabilities);if(_43f&&_43f.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_41c.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_417.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_43e.geometryType==="esriGeometryPolyline")||(_43e.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_41c.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _440=_43e.effectiveMinScale||_43e.minScale,_441=_43e.effectiveMaxScale||_43e.maxScale;if(!this._hasMin&&_440){this.setMinScale(_440);}if(!this._hasMax&&_441){this.setMaxScale(_441);}this.layerId=_43e.id;this.name=_43e.name;this.description=_43e.description;this.copyright=_43e.copyrightText;this.type=_43e.type;this.geometryType=_43e.geometryType;this.displayField=_43e.displayField;this.defaultDefinitionExpression=_43e.definitionExpression;this.fullExtent=new _42a(_43e.extent);this.initialExtent=new _42a(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _41f(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_43e.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_43e.indexedFields;this.maxRecordCount=_43e.maxRecordCount;this.canModifyLayer=_43e.canModifyLayer;this.supportsStatistics=_43e.supportsStatistics;this.supportsAdvancedQueries=_43e.supportsAdvancedQueries;this.hasLabels=_43e.hasLabels;this.canScaleSymbols=_43e.canScaleSymbols;this.supportsRollbackOnFailure=_43e.supportsRollbackOnFailure;this.syncCanReturnChanges=_43e.syncCanReturnChanges;this.isDataVersioned=_43e.isDataVersioned;this.editFieldsInfo=_43e.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_43e.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_43e.relationships;this.allowGeometryUpdates=_41c.isDefined(_43e.allowGeometryUpdates)?_43e.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _442=(this.fields=[]),_443=_43e.fields,i;for(i=0;i<_443.length;i++){_442.push(new _42e(_443[i]));}if(!this.objectIdField){this.objectIdField=_43e.objectIdField;if(!this.objectIdField){_443=_43e.fields;for(i=0;i<_443.length;i++){var _444=_443[i];if(_444.type==="esriFieldTypeOID"){this.objectIdField=_444.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_41c.isDefined(this._nextId)){var _445=this.objectIdField,_446=-1;if(this._collection&&_445){var fset=this._featureSet,_447=fset&&fset.features,il=_447?_447.length:0,oid,attr;for(i=0;i<il;i++){attr=_447[i].attributes;oid=attr&&attr[_445];if(oid>_446){_446=oid;}}}this._nextId=(_446+1);}this.globalIdField=_43e.globalIdField;var _448=(this.typeIdField=_43e.typeIdField),_449;if(_448){_449=!this._getField(_448)&&this._getField(_448,true);if(_449){this.typeIdField=_449.name;}}this.visibilityField=_43e.visibilityField;var _44a=_43e.defaultSymbol;if(_44a){this.defaultSymbol=_423.fromJson(_44a);}var _44b=this.types=[],_44c=_43e.types,_44d,_44e,_44f,_450=this.editFieldsInfo,_451=_450&&_450.creatorField,_452=_450&&_450.editorField,fix=(_451||_452),_453=[];if(_44c){for(i=0;i<_44c.length;i++){_44d=new _430(_44c[i]);_44e=_44d.templates;if(fix&&_44e&&_44e.length){_453=_453.concat(_44e);}_44b.push(_44d);}}var _454=_43e.templates,_455,_456=this.templates=[];if(_454){for(i=0;i<_454.length;i++){_455=new _431(_454[i]);if(fix){_453.push(_455);}_456.push(_455);}}for(i=0;i<_453.length;i++){_44f=lang.getObject("prototype.attributes",false,_453[i]);if(_44f){if(_451){delete _44f[_451];}if(_452){delete _44f[_452];}}}var _457=_43e.timeInfo;if(_457){this.timeInfo=new _42f(_457);this._startTimeField=_457.startTimeField;this._endTimeField=_457.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_457.trackIdField=this._trackIdField;}else{this._trackIdField=_457.trackIdField;}}this.hasAttachments=(!this._collection&&_43e.hasAttachments)?true:false;this.htmlPopupType=_43e.htmlPopupType;var _458=_43e.drawingInfo,_459;if(!this.renderer){if(_458&&_458.renderer){_459=_458.renderer;this.setRenderer(_426.fromJson(_459));if(_459.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _45a=_459.type,_45b=[];_459=this.renderer;switch(_45a){case "simple":_45b.push(_459.symbol);break;case "uniqueValue":case "classBreaks":_45b.push(_459.defaultSymbol);_45b=_45b.concat(_416.map(_459.infos,function(info){return info.symbol;}));break;}_45b=_416.filter(_45b,_41c.isDefined);var _45c=this._url.path+"/images/",_45d=this._getToken();_416.forEach(_45b,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_45c+url;}if(_45d&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_45d);}}});}}else{if(_44a){_44c=this.types;if(_44c.length>0){_459=new _425(this.defaultSymbol,this.typeIdField);_416.forEach(_44c,function(type){_459.addValue(type.id,type.symbol);});}else{_459=new _424(this.defaultSymbol);}this.setRenderer(_459);}else{if(!this._isTable){var _45e;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_45e=new _420();break;case "esriGeometryPolyline":_45e=new _421();break;case "esriGeometryPolygon":_45e=new _422();break;}this.setRenderer(_45e?new _424(_45e):null);}}}}var _45f=(_458&&_458.transparency)||0;if(!_41c.isDefined(this.opacity)&&_45f>0){this.opacity=1-(_45f/100);}this.version=_43e.currentVersion;if(!this.version){var ver;if("capabilities" in _43e||"drawingInfo" in _43e||"hasAttachments" in _43e||"htmlPopupType" in _43e||"relationships" in _43e||"timeInfo" in _43e||"typeIdField" in _43e||"types" in _43e){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _460=function(){this.onLoad(this);var _461=this._loadCallback;if(_461){delete this._loadCallback;_461(this);}};if(this._collection){this._fireUpdateStart();var _462=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _429(_462));this._fcAdded=true;_460.call(this);}else{this._forceIdentity(_460);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _463=this.renderer;if(_463){this._ager=(_463.declaredClass.indexOf("TemporalRenderer")!==-1&&_463.observationAger&&_463.observationRenderer);var _464=_416.filter([_463,_463.observationRenderer,_463.latestObservationRenderer,_463.trackRenderer],_41c.isDefined);var _465=[];_416.forEach(_464,function(rnd){if(!lang.isFunction(rnd.attributeField)){_465.push(rnd.attributeField);}_465.push(rnd.attributeField2);_465.push(rnd.attributeField3);},this);this._rendererFields=_416.filter(_465,_41c.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_415.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},getOutFields:function(){return _416.filter(this._getOutFields(),function(_466){return (_466==="*"||!!this._getField(_466));},this);},setEditable:function(_467){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_467;return this;}var _468=this._editable;this._editable=_467;this._updateCaps();if(_468!==_467){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_469){var _46a={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _46a;}var _46b=_469&&_469.feature,_46c=_469&&_469.userId,caps=_416.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_46d=_416.indexOf(caps,"editing")>-1,_46e=_46d&&(_416.indexOf(caps,"create")>-1),_46f=_46d&&(_416.indexOf(caps,"update")>-1),_470=_46d&&(_416.indexOf(caps,"delete")>-1),_471=this.ownershipBasedAccessControlForFeatures,_472=this.editFieldsInfo,_473=_472&&_472.creatorField,_474=_472&&_472.realm,_475=_46b&&_46b.attributes,_476=(_475&&_473)?_475[_473]:undefined,_477,_478=!!this.userIsAdmin,_479=!_471||_478||!!(_471.allowOthersToUpdate||_471.allowUpdateToOthers),_47a=!_471||_478||!!(_471.allowOthersToDelete||_471.allowDeleteToOthers);if(_478||(_46d&&!(_46e||_46f||_470))){_46e=_46f=_470=true;}_477={"canCreate":_46e,"canUpdate":_46f,"canDelete":_470};if(_476===null){_477.canUpdate=_46f&&_479;_477.canDelete=_470&&_47a;}else{if(_476===""){return _477;}else{if(_476){_46c=_46c||this.getUserId();if(_46c&&_474){_46c=_46c+"@"+_474;}if(_46c.toLowerCase()===_476.toLowerCase()){return _477;}else{_477.canUpdate=_46f&&_479;_477.canDelete=_470&&_47a;}}}}return _477;},getUserId:function(){var _47b;if(this.loaded){_47b=(this.credential&&this.credential.userId)||this.userId||"";}return _47b;},setUserIsAdmin:function(_47c){this.userIsAdmin=_47c;},setEditSummaryCallback:function(_47d){this.editSummaryCallback=_47d;},getEditSummary:function(_47e,_47f,_480){_480=_41c.isDefined(_480)?_480:(new Date()).getTime();var _481="",info=this.getEditInfo(_47e,_47f,_480),_482=(_47f&&_47f.callback)||this.editSummaryCallback;if(_482){info=_482(_47e,info)||"";}if(lang.isString(info)){_481=info;}else{if(info){var _483=info.action,_484=info.userId,_485=info.timeValue,_486=0;if(_483){_486++;}if(_484){_486++;}if(_41c.isDefined(_485)){_486++;}if(_486>1){_481=(_483==="edit"?"edit":"create")+(_484?"User":"")+(_41c.isDefined(_485)?info.displayPattern:"");}}_481=_481&&_41c.substitute(info,this.i18n.layers.FeatureLayer[_481]);}return _481;},getEditInfo:function(_487,_488,_489){if(!this.loaded){return;}_489=_41c.isDefined(_489)?_489:(new Date()).getTime();var _48a=(_488&&_488.action)||"last",_48b=this.editFieldsInfo,_48c=_48b&&_48b.creatorField,_48d=_48b&&_48b.creationDateField,_48e=_48b&&_48b.editorField,_48f=_48b&&_48b.editDateField,_490=_48b&&_48b.realm,_491=_487&&_487.attributes,_492=(_491&&_48c)?_491[_48c]:undefined,_493=(_491&&_48d)?_491[_48d]:null,_494=(_491&&_48e)?_491[_48e]:undefined,_495=(_491&&_48f)?_491[_48f]:null,_496=this._getEditData(_492,_493,_489),_497=this._getEditData(_494,_495,_489),_498;switch(_48a){case "creation":_498=_496;break;case "edit":_498=_497;break;case "last":_498=_497||_496;break;}if(_498){_498.action=(_498===_497)?"edit":"creation";}return _498;},_getEditData:function(_499,_49a,_49b){var data,_49c,_49d,_49e=60000,_49f=3600000,_4a0=2*_49f,_4a1=24*_49f,_4a2=7*_4a1;if(_41c.isDefined(_49a)){_49c=_49b-_49a;if(_49c<0){_49d="Full";}else{if(_49c<_49e){_49d="Seconds";}else{if(_49c<(2*_49e)){_49d="Minute";}else{if(_49c<_49f){_49d="Minutes";}else{if(_49c<_4a0){_49d="Hour";}else{if(_49c<_4a1){_49d="Hours";}else{if(_49c<_4a2){_49d="WeekDay";}else{_49d="Full";}}}}}}}}if((_499!==undefined)||_49d){data=data||{};data.userId=_499;if(_49d){var _4a3=_419.format,_4a4=new Date(_49a);data.minutes=Math.floor(_49c/_49e);data.hours=Math.floor(_49c/_49f);data.weekDay=_4a3(_4a4,{datePattern:"EEEE",selector:"date"});data.formattedDate=_4a3(_4a4,{selector:"date"});data.formattedTime=_4a3(_4a4,{selector:"time"});data.displayPattern=_49d;data.timeValue=_49a;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_4a5){if(!this.isEditable()){this._maxOffset=_4a5;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_4a6){if(!this.loaded){this._optAutoGen=_4a6;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_4a6;if(_4a6){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_4a7){if(!this._collection&&(_4a7!==this.gdbVersion)&&(_4a7||this.gdbVersion)){this.gdbVersion=_4a7;this._task.gdbVersion=_4a7;this._url.query=lang.mixin(this._url.query,{gdbVersion:_4a7});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_4a8){if(this._isSnapshot){this._timeDefn=_4a8;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_4a9,_4aa){this._timeOffset=_4a9;this._timeOffsetUnits=_4aa;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_4ab,_4ac,_4ad,_4ae){_4ac=_4ac||this.constructor.SELECTION_NEW;var _4af=this._getShallowClone(_4ab),map=this._map,_4b0,dfd=_41e._fixDfd(new _418(_41e._dfdCanceller));_4af.outFields=this.getOutFields();_4af.returnGeometry=true;if(map){_4af.outSpatialReference=new _41f(map.spatialReference.toJson());}if(!this._applyQueryFilters(_4af)){_4b0={features:[]};this._selectHandler(_4b0,_4ac,_4ad,_4ae,dfd);return dfd;}var _4b1=this._canDoClientSideQuery(_4af);if(_4b1){_4b0={features:this._doQuery(_4af,_4b1)};this._selectHandler(_4b0,_4ac,_4ad,_4ae,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_4ae,dfd,true);return dfd;}var self=this;if(this._ts){_4af._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_4af);temp.addCallbacks(function(_4b2){self._selectHandler(_4b2,_4ac,_4ad,_4ae,dfd);},function(err){self._resolve([err],null,_4ae,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _4b3=this._selectedFeatures,_4b4=[],item;for(item in _4b3){if(_4b3.hasOwnProperty(item)){_4b4.push(_4b3[item]);}}return _4b4;},clearSelection:function(_4b5){var _4b6=this._selectedFeatures,mode=this._mode,item;for(item in _4b6){if(_4b6.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_4b5){this.onSelectionClear();}return this;},setSelectionSymbol:function(_4b7){this._selectionSymbol=_4b7;if(_4b7){var _4b8=this._selectedFeatures,item;for(item in _4b8){if(_4b8.hasOwnProperty(item)){_4b8[item].setSymbol(_4b7);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_4b9,_4ba,_4bb,_4bc,_4bd){var _4be=_4bd.assembly,dfd=_4bd.dfd;this._applyNormalized(adds,_4be&&_4be[0]);this._applyNormalized(_4b9,_4be&&_4be[1]);this.onBeforeApplyEdits(adds,_4b9,_4ba);var i,_4bf={},_4c0=this.objectIdField,_4c1={f:"json"},_4c2=false;if(this._collection){var _4c3={};_4c3.addResults=adds?_416.map(adds,function(){_4c2=true;return {objectId:this._nextId++,success:true};},this):null;_4c3.updateResults=_4b9?_416.map(_4b9,function(_4c4){_4c2=true;var oid=_4c4.attributes[_4c0];_4bf[oid]=_4c4;return {objectId:oid,success:true};},this):null;_4c3.deleteResults=_4ba?_416.map(_4ba,function(_4c5){_4c2=true;return {objectId:_4c5.attributes[_4c0],success:true};},this):null;if(_4c2){this._editHandler(_4c3,adds,_4bf,_4bb,_4bc,dfd);}return;}if(adds&&adds.length>0){_4c1.adds=this._convertFeaturesToJson(adds,0,1);_4c2=true;}if(_4b9&&_4b9.length>0){for(i=0;i<_4b9.length;i++){var _4c6=_4b9[i];_4bf[_4c6.attributes[_4c0]]=_4c6;}_4c1.updates=this._convertFeaturesToJson(_4b9,0,0,1);_4c2=true;}if(_4ba&&_4ba.length>0){var ids=[];for(i=0;i<_4ba.length;i++){ids.push(_4ba[i].attributes[_4c0]);}_4c1.deletes=ids.join(",");_4c2=true;}if(_4c2){var self=this;return _41d({url:this._url.path+"/applyEdits",content:lang.mixin(_4c1,this._url.query),callbackParamName:"callback",load:function(_4c7){self._editHandler(_4c7,adds,_4bf,_4bb,_4bc,dfd);},error:function(err){self._resolve([err],null,_4bc,dfd,true);}},{usePost:true});}},queryFeatures:function(_4c8,_4c9,_4ca){return this._query("execute","onQueryFeaturesComplete",_4c8,_4c9,_4ca);},queryRelatedFeatures:function(_4cb,_4cc,_4cd){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_4cb,_4cc,_4cd);},queryIds:function(_4ce,_4cf,_4d0){return this._query("executeForIds","onQueryIdsComplete",_4ce,_4cf,_4d0);},queryCount:function(_4d1,_4d2,_4d3){return this._query("executeForCount","onQueryCountComplete",_4d1,_4d2,_4d3);},queryAttachmentInfos:function(_4d4,_4d5,_4d6){var url=this._url.path+"/"+_4d4+"/attachments",dfd=new _418(_41e._dfdCanceller),self=this;dfd._pendingDfd=_41d({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_4d7){var _4d8=_4d7.attachmentInfos,_4d9;_416.forEach(_4d8,function(info){_4d9=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_4d9?("?"+_4d9):"");info.objectId=_4d4;});self._resolve([_4d8],"onQueryAttachmentInfosComplete",_4d5,dfd);},error:function(err){self._resolve([err],null,_4d6,dfd,true);}});return dfd;},addAttachment:function(_4da,_4db,_4dc,_4dd){return this._sendAttachment("add",_4da,_4db,_4dc,_4dd);},updateAttachment:function(_4de,_4df,_4e0,_4e1,_4e2){_4e0.appendChild(_41a.create("input",{type:"hidden",name:"attachmentId",value:_4df}));return this._sendAttachment("update",_4de,_4e0,_4e1,_4e2);},deleteAttachments:function(_4e3,_4e4,_4e5,_4e6){var url=this._url.path+"/"+_4e3+"/deleteAttachments",dfd=new _418(_41e._dfdCanceller),self=this,_4e7={f:"json",attachmentIds:_4e4.join(",")};dfd._pendingDfd=_41d({url:url,content:lang.mixin(_4e7,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_4e8){var _4e9=_4e8.deleteAttachmentResults;_4e9=_416.map(_4e9,function(_4ea){var res=new _432(_4ea);res.attachmentId=res.objectId;res.objectId=_4e3;return res;});self._resolve([_4e9],"onDeleteAttachmentsComplete",_4e5,dfd);}),error:function(err){self._resolve([err],null,_4e6,dfd,true);}},{usePost:true});return dfd;},addType:function(_4eb){var _4ec=this.types;if(_4ec){var _4ed=_416.some(_4ec,function(type){if(type.id==_4eb.id){return true;}return false;});if(_4ed){return false;}else{_4ec.push(_4eb);}}else{this.types=[_4eb];}this._typesDirty=true;return true;},deleteType:function(_4ee){if(!this._collection){return;}var _4ef=this.types;if(_4ef){var _4f0=-1;_416.some(_4ef,function(type,_4f1){if(type.id==_4ee){_4f0=_4f1;return true;}return false;});if(_4f0>-1){this._typesDirty=true;return _4ef.splice(_4f0,1)[0];}}},toJson:function(){var _4f2=this._json,json=lang.isString(_4f2)?_417.fromJson(_4f2):lang.clone(_4f2);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _4f3=json.layerDefinition,_4f4=this._collection;if(_4f4&&this._typesDirty){_4f3.types=_416.map(this.types||[],function(type){return type.toJson();});var _4f5=this.renderer,_4f6=_4f3.drawingInfo;if(_4f6&&_4f5&&_4f5.declaredClass.indexOf("TemporalRenderer")===-1){_4f6.renderer=_4f5.toJson();}}var _4f7=null;if(!(_4f4&&!this._fcAdded)){_4f7={geometryType:_4f3.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_4f7);if(_4f4){json.nextObjectId=this._nextId;_4f3.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_4f8){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_41b.id&&_41b.id._hasPortalSession()&&_41b.id._doPortalSignIn(path)){_41b.id.getCredential(path).then(function(){self._findCredential();_4f8.call(self);},function(){_4f8.call(self);});}else{_4f8.call(this);}},_updateCaps:function(){var _4f9=this._editable,_4fa=lang.trim(this.capabilities||""),_4fb=_416.map((_4fa?_4fa.split(","):[]),lang.trim),caps=_416.map((_4fa?_4fa.toLowerCase().split(","):[]),lang.trim),_4fc=_416.indexOf(caps,"editing"),cap,i,_4fd,_4fe={"Create":_416.indexOf(caps,"create"),"Update":_416.indexOf(caps,"update"),"Delete":_416.indexOf(caps,"delete")};if(_4f9&&_4fc===-1){_4fb.push("Editing");}else{if(!_4f9&&_4fc>-1){_4fd=[_4fc];for(cap in _4fe){if(_4fe[cap]>-1){_4fd.push(_4fe[cap]);}}_4fd.sort();for(i=_4fd.length-1;i>=0;i--){_4fb.splice(_4fd[i],1);}}}this.capabilities=_4fb.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_4ff=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_4ff&&(_4ff.latestObservationRenderer||_4ff.trackRenderer))){this._trackManager=new _436(this);this._trackManager.initialize(map);}}this._zoomConnect=_415.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_500){var map=this._map;if(_500&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_415.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_415.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_501){this._mapTimeExtent=_501;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_502){var _503=this._timeOffset,_504=this._timeOffsetUnits;return (_502&&_503&&_504)?_502.offset(-1*_503,_504):_502;},_getTimeOverlap:function(_505,_506){if(_505&&_506){return _505.intersection(_506);}else{return _505||_506;}},_getTimeFilter:function(_507){var _508=this.getTimeDefinition(),_509=null,_50a;if(_508||_509){_50a=this._getTimeOverlap(_508,_509);if(!_50a){return [false];}}if(_507){_507=_50a?this._getTimeOverlap(_507,_50a):_507;if(!_507){return [false];}}else{_507=_50a;}return [true,_507];},_getAttributeFilter:function(_50b){var _50c=this.getDefinitionExpression();if(_50b){_50b=_50c?"("+_50c+") AND ("+_50b+")":_50b;}else{_50b=_50c;}return _50b;},_applyQueryFilters:function(_50d){_50d.where=this._getAttributeFilter(_50d.where);_50d.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _50e=this._getTimeFilter(_50d.timeExtent);if(!_50e[0]){return false;}else{_50d.timeExtent=_50e[1];}}return true;},_add:function(_50f){var _510=this._selectionSymbol,attr=_50f.attributes,_511=this.visibilityField;if(_510&&this._isSelOnly){_50f.setSymbol(_510);}if(_511&&attr&&attr.hasOwnProperty(_511)){_50f[attr[_511]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_512){var _513=[],map=this._map;if(this._isTable||!map){return;}if(_512.text||(_512.where&&_512.where!==this.getDefinitionExpression())){return;}var _514=this._isSnapshot,_515=this._isSelOnly;var _516=_512.geometry;if(_516){if(!_515&&_512.spatialRelationship===_428.SPATIAL_REL_INTERSECTS&&(_516.type==="extent"&&(_514||map.extent.contains(_516)))){_513.push(1);}else{return;}}var ids=_512.objectIds;if(ids){if(_514){_513.push(2);}else{var len=ids.length,mode=this._mode,_517=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_517++;}}if(_517===len){_513.push(2);}else{return;}}}if(this.timeInfo){var _518=_512.timeExtent,_519=this._mapTimeExtent;if(_514){if(_518){_513.push(3);}}else{if(_515){if(_518){return;}}else{if(_519){if(_416.indexOf(_513,2)!==-1){if(_518){_513.push(3);}}else{return;}}else{if(_513.length>0){if(_518){_513.push(3);}}else{if(_518){return;}}}}}}return _513.length>0?_513:null;},_doQuery:function(_51a,_51b,_51c){var _51d=[],mode=this._mode,_51e=this.objectIdField,i,len,_51f;if(_416.indexOf(_51b,2)!==-1){_51d=[];var ids=_51a.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_51d.push(obj);}}if(_51d.length===0){return [];}}if(_416.indexOf(_51b,1)!==-1){_51f=_51d.length>0?_51d:this.graphics;len=_51f.length;var _520=_51a.geometry._normalize(null,true);_51d=[];for(i=0;i<len;i++){var _521=_51f[i],_522=_521.geometry;if(_522){if(this.normalization&&_520.length){if(_520[0].intersects(_522)||_520[1].intersects(_522)){_51d.push(_521);}}else{if(_520.intersects(_522)){_51d.push(_521);}}}}if(_51d.length===0){return [];}}if(_416.indexOf(_51b,3)!==-1){if(this.timeInfo){_51f=_51d.length>0?_51d:this.graphics;var time=_51a.timeExtent,_523=this._filterByTime(_51f,time.startTime,time.endTime);_51d=_523.match;}}if(_51c){return _416.map(_51d,function(obj){return obj.attributes[_51e];},this);}else{return _51d;}},_filterByTime:function(_524,_525,_526){var _527=this._startTimeField,_528=this._endTimeField,_529;if(!this._twoTimeFields){_529=_527||_528;}var _52a=_41c.isDefined,yea=[],nay=[],i,len=_524.length,_52b,_52c;_525=_525?_525.getTime():-Infinity;_526=_526?_526.getTime():Infinity;if(_529){for(i=0;i<len;i++){_52b=_524[i];_52c=_52b.attributes;var time=_52c[_529];if(time>=_525&&time<=_526){yea.push(_52b);}else{nay.push(_52b);}}}else{for(i=0;i<len;i++){_52b=_524[i];_52c=_52b.attributes;var _52d=_52c[_527],end=_52c[_528];_52d=_52a(_52d)?_52d:-Infinity;end=_52a(end)?end:Infinity;if((_52d>=_525&&_52d<=_526)||(end>=_525&&end<=_526)||(_525>=_52d&&_526<=end)){yea.push(_52b);}else{nay.push(_52b);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_52e,_52f,dfd,_530){if(_52e){this[_52e].apply(this,args);}if(_52f){_52f.apply(null,args);}if(dfd){_41e._resDfd(dfd,args,_530);}},_getShallowClone:function(_531){var _532=new _428(),prop;for(prop in _531){if(_531.hasOwnProperty(prop)){_532[prop]=_531[prop];}}return _532;},_query:function(type,_533,_534,_535,_536){var that=this,map=this._map,dfd=new _418(_41e._dfdCanceller),_537=_534;var _538=function(_539,_53a){if(!_53a&&type==="execute"&&!that._isTable){var _53b=_539.features,mode=that._mode,_53c=that.objectIdField,il=_53b.length,i;for(i=il-1;i>=0;i--){var oid=_53b[i].attributes[_53c];var _53d=mode._getFeature(oid);if(_53d){_53b.splice(i,1,_53d);}}}that._resolve([_539],_533,_535,dfd);};if(type!=="executeRelationshipQuery"){_537=this._getShallowClone(_534);_537.outFields=this.getOutFields();_537.returnGeometry=_534.hasOwnProperty("returnGeometry")?_534.returnGeometry:true;var _53e;if(map){_537.outSpatialReference=new _41f(map.spatialReference.toJson());}if(!this._applyQueryFilters(_537)){switch(type){case "execute":_53e=new _429({features:[]});break;case "executeForIds":_53e=[];break;case "executeForCount":_53e=0;break;}_538(_53e,true);return dfd;}var _53f=this._canDoClientSideQuery(_537);if(_53f){var _540=this._doQuery(_537,_53f,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_53e=new _429();_53e.features=_540;break;case "executeForIds":_53e=_540;break;case "executeForCount":_53e=_540.length;break;}_538(_53e,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_536,dfd,true);return dfd;}if(this._ts){_537._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_537);temp.addCallbacks(_538,function(err){that._resolve([err],null,_536,dfd,true);});return dfd;},_convertFeaturesToJson:function(_541,_542,_543,_544){var json=[],_545=this._selectionSymbol,_546=this.visibilityField,i,_547,_548=this.objectIdField;if(this.loaded&&(_543||_544)){_547=_416.filter(this.fields,function(_549){return (_549.editable===false)&&(!_544||(_549.name!==_548));});}for(i=0;i<_541.length;i++){var _54a=_541[i],_54b={},_54c=_54a.geometry,attr=_54a.attributes,_54d=_54a.symbol;if(_54c&&(!_544||!this.loaded||this.allowGeometryUpdates)){_54b.geometry=_54c.toJson();}if(_546){_54b.attributes=attr=lang.mixin({},attr);attr[_546]=_54a.visible?1:0;}else{if(attr){_54b.attributes=lang.mixin({},attr);}}if(_54b.attributes&&_547&&_547.length){_416.forEach(_547,function(_54e){delete _54b.attributes[_54e.name];});}if(_54d&&(_54d!==_545)){_54b.symbol=_54d.toJson();}json.push(_54b);}return _542?json:_417.toJson(json);},_selectHandler:function(_54f,_550,_551,_552,dfd){var _553,ctor=this.constructor;switch(_550){case ctor.SELECTION_NEW:this.clearSelection(true);_553=true;break;case ctor.SELECTION_ADD:_553=true;break;case ctor.SELECTION_SUBTRACT:_553=false;break;}var i,_554=_54f.features,mode=this._mode,_555=[],_556=this.objectIdField,_557,oid;if(_553){for(i=0;i<_554.length;i++){_557=_554[i];oid=_557.attributes[_556];var _558=mode._addFeatureIIf(oid,_557);_555.push(_558);this._selectFeatureIIf(oid,_558,mode);}}else{for(i=0;i<_554.length;i++){_557=_554[i];oid=_557.attributes[_556];this._unSelectFeatureIIf(oid,mode);var _559=mode._removeFeatureIIf(oid);_555.push(_559||_557);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_555,_550,_54f.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_551,dfd);if(_54f.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_55a,mode){var _55b=this._selectedFeatures,_55c=_55b[oid];if(!_55c){mode._incRefCount(oid);_55b[oid]=_55a;if(!this._isTable){this._setSelectSymbol(_55a);}}return _55c||_55a;},_unSelectFeatureIIf:function(oid,mode){var _55d=this._selectedFeatures[oid];if(_55d){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_55d);}}return _55d;},_isSelected:function(_55e){},_setSelectSymbol:function(_55f){var _560=this._selectionSymbol;if(_560&&!this._isSelOnly){_55f.setSymbol(_560);}},_setUnSelectSymbol:function(_561){var _562=this._selectionSymbol;if(_562&&!this._isSelOnly){if(_562===_561.symbol){_561.setSymbol(null,true);}}},_getOutFields:function(){var _563=_416.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_564,_565,arr){return !!_564&&(_416.indexOf(arr,_564)===_565);});var _566=lang.clone(this._outFields);if(_566){if(_416.indexOf(_566,"*")!==-1){return _566;}_416.forEach(_563,function(_567){if(_416.indexOf(_566,_567)===-1){_566.push(_567);}});return _566;}else{return _563;}},_checkFields:function(_568){var _569=_568||this._getOutFields();_416.forEach(_569,function(_56a){if(_56a==="*"){return;}if(!this._getField(_56a)){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url,field:_56a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_568&&!this._isTable&&!this._fserver&&!this._collection){var _56b=_416.some(this.fields,function(_56c){return (_56c&&_56c.type==="esriFieldTypeGeometry")?true:false;});if(!_56b){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _56d=this.renderer;if(_56d&&this.fields.length>0){var _56e=_416.filter([_56d,_56d.observationRenderer,_56d.latestObservationRenderer,_56d.trackRenderer],_41c.isDefined);var _56f=[];_416.forEach(_56e,function(rnd){var _570,_571;_571=rnd.attributeField;if(_571&&!lang.isFunction(_571)){_570=!this._getField(_571)&&this._getField(_571,true);if(_570){rnd.attributeField=_570.name;}}_571=rnd.attributeField2;if(_571){_570=!this._getField(_571)&&this._getField(_571,true);if(_570){rnd.attributeField2=_570.name;}}_571=rnd.attributeField3;if(_571){_570=!this._getField(_571)&&this._getField(_571,true);if(_570){rnd.attributeField3=_570.name;}}if(!lang.isFunction(rnd.attributeField)){_56f.push(rnd.attributeField);}_56f.push(rnd.attributeField2);_56f.push(rnd.attributeField3);},this);this._rendererFields=_416.filter(_56f,_41c.isDefined);}},_getField:function(_572,_573){var _574=this.fields;if(!_574||_574.length===0){return null;}var _575;if(_573){_572=_572.toLowerCase();}_416.some(_574,function(_576){var _577=false;if(_573){_577=(_576&&_576.name.toLowerCase()===_572)?true:false;}else{_577=(_576&&_576.name===_572)?true:false;}if(_577){_575=_576;}return _577;});return _575;},_getDateOpts:function(){if(!this._dtOpts){var _578=_416.map(_416.filter(this.fields,function(_579){return !!(_579&&_579.type==="esriFieldTypeDate");}),function(_57a){return _57a.name;});this._dtOpts={properties:_578};}return this._dtOpts;},_applyNormalized:function(_57b,_57c){if(_57b&&_57c){_416.forEach(_57b,function(_57d,_57e){if(_57d&&_57c[_57e]){_57d.setGeometry(_57c[_57e]);}});}},_editHandler:function(_57f,adds,_580,_581,_582,dfd){var _583=_57f.addResults,_584=_57f.updateResults,_585=_57f.deleteResults,i,_586,oid,_587,attr,_588=this.objectIdField,mode=this._mode,_589=this._isTable;var _58a=this.editFieldsInfo,_58b=this.getOutFields()||[],_58c=_58a&&_58a.creatorField,_58d=_58a&&_58a.creationDateField,_58e=_58a&&_58a.editorField,_58f=_58a&&_58a.editDateField,_590=_58a&&_58a.realm;if(_416.indexOf(_58b,"*")===-1){if(_58c&&_416.indexOf(_58b,_58c)===-1){_58c=null;}if(_58d&&_416.indexOf(_58b,_58d)===-1){_58d=null;}if(_58e&&_416.indexOf(_58b,_58e)===-1){_58e=null;}if(_58f&&_416.indexOf(_58b,_58f)===-1){_58f=null;}}var _591=(_58d||_58f)?(new Date()).getTime():null,_592=(_58c||_58e)?this.getUserId():undefined;if(_592&&_590){_592=_592+"@"+_590;}if(_583){for(i=0;i<_583.length;i++){_583[i]=new _432(_583[i]);if(_589){continue;}_586=_583[i];if(_586.success){oid=_586.objectId;_587=adds[i];var gl=_587._graphicsLayer;if(gl&&gl!==this){gl.remove(_587);}attr=_587.attributes||{};attr[_588]=oid;if(_58c){attr[_58c]=_592;}if(_58e){attr[_58e]=_592;}if(_58d){attr[_58d]=_591;}if(_58f){attr[_58f]=_591;}_587.setAttributes(attr);if(mode._init){mode.drawFeature(_587);}}}}if(_584){for(i=0;i<_584.length;i++){_584[i]=new _432(_584[i]);if(_589){continue;}_586=_584[i];if(_586.success){oid=_586.objectId;_587=_580[oid];var _593=mode._getFeature(oid);if(_593){if(_593.geometry!==_587.geometry){_593.setGeometry(_42b.fromJson(_587.geometry.toJson()));}this._repaint(_593,oid);}_587=_593||_587;attr=_587.attributes||{};if(_58e){attr[_58e]=_592;}if(_58f){attr[_58f]=_591;}_587.setAttributes(attr);}}}if(_585){var _594=[];for(i=0;i<_585.length;i++){_585[i]=new _432(_585[i]);if(_589){continue;}_586=_585[i];if(_586.success){oid=_586.objectId;_587=mode._getFeature(oid);if(_587){if(this._unSelectFeatureIIf(oid,mode)){_594.push(_587);}_587._count=0;mode._removeFeatureIIf(oid);}}}if(_594.length>0){this.onSelectionComplete(_594,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_583,_584,_585],"onEditsComplete",_581,dfd);},_sendAttachment:function(type,_595,_596,_597,_598){var _599=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_595+"/"+_599,self=this;var dfd=_41d({url:url,form:_596,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_59a){var _59b=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_59c=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_59d=new _432(_59a[_59b]);_59d.attachmentId=_59d.objectId;_59d.objectId=_595;self._resolve([_59d],_59c,_597);return _59d;}).addErrback(function(_59e){self._resolve([_59e],null,_598,null,true);});return dfd;},_repaint:function(_59f,oid,_5a0){oid=_41c.isDefined(oid)?oid:_59f.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_59f.setSymbol(_59f.symbol,_5a0);}},_getKind:function(_5a1){var _5a2=this._trackManager;if(_5a2){return _5a2.isLatestObservation(_5a1)?1:0;}return 0;}});lang.mixin(_437,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_42c._createWrappers(_437);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_437,_41b);}return _437;});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_5a3,arr,_5a4,_5a5,_5a6,_5a7,win,_5a8,_5a9){return _5a3("dojox.gfx.Moveable",null,{constructor:function(_5aa,_5ab){this.shape=_5aa;this.delay=(_5ab&&_5ab.delay>0)?_5ab.delay:0;this.mover=(_5ab&&_5ab.mover)?_5ab.mover:_5a8;this.leftButtonOnly=_5ab&&_5ab.leftButtonOnly;this.events=[this.shape.connect(_5a6.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_5ac){_5ac.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_5a6.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_5a6.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_5a9.isLeft(e)){new this.mover(this.shape,e,this);}}_5a4.stop(e);},onMouseMove:function(e){var _5ad=e.clientX,_5ae=e.clientY;if(Math.abs(_5ad-this._lastX)>this.delay||Math.abs(_5ae-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_5a4.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_5af){_5a5.publish("/gfx/move/start",_5af);_5a7.add(win.body(),"dojoMove");},onMoveStop:function(_5b0){_5a5.publish("/gfx/move/stop",_5b0);_5a7.remove(win.body(),"dojoMove");},onFirstMove:function(_5b1){},onMove:function(_5b2,_5b3){this.onMoving(_5b2,_5b3);this.shape.applyLeftTransform(_5b3);this.onMoved(_5b2,_5b3);},onMoving:function(_5b4,_5b5){},onMoved:function(_5b6,_5b7){}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_5b8,lang,has,_5b9,_5ba,_5bb,_5bc){var dhm=lang.getObject("dojox.html.metrics",true);var _5bd=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _5be={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_5bb.doc.documentElement.style.fontSize="100%";}var div=_5bb.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_5bb.body().appendChild(div);for(var p in _5be){ds.fontSize=p;_5be[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_5bb.body().removeChild(div);div=null;return _5be;};var _5bf=null;dhm.getCachedFontMeasurements=function(_5c0){if(_5c0||!_5bf){_5bf=dhm.getFontMeasurements();}return _5bf;};var _5c1=null,_5c2={};dhm.getTextBox=function(text,_5c3,_5c4){var m,s;if(!_5c1){m=_5c1=_5bb.doc.createElement("div");var c=_5bb.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_5bb.body().appendChild(c);}else{m=_5c1;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_5c3){for(var i in _5c3){if(i in _5c2){continue;}s[i]=_5c3[i];}}if(arguments.length>2&&_5c4){m.className=_5c4;}m.innerHTML=text;var box=_5bc.position(m);box.w=m.parentNode.scrollWidth;return box;};var _5c5={w:16,h:16};dhm.getScrollbar=function(){return {w:_5c5.w,h:_5c5.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_5c6){var f=dhm._fontResizeNode=_5bb.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_5bd._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_5bd._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_5bb.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_5ba.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_5b9(function(){try{var n=_5bb.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_5bb.body().appendChild(n);_5c5.w=n.offsetWidth-n.clientWidth;_5c5.h=n.offsetHeight-n.clientHeight;_5bb.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _5b8.config&&!!_5b8.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_5c7,lang,has,_5c8,_5c9){var _5ca=_5c7([_5c9],{declaredClass:"esri.layers._SelectionMode",constructor:function(_5cb){this.featureLayer=_5cb;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_5ca,_5c8);}return _5ca;});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_5cc,_5cd,_5ce,has,util){return _5cd("dojox.grid._EditManager",null,{constructor:function(_5cf){this.grid=_5cf;if(has("ie")){this.connections=[_5ce.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_5ce.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_5cc.forEach(this.connections,_5ce.disconnect);},cellFocus:function(_5d0,_5d1){if(this.grid.singleClickEdit||this.isEditRow(_5d1)){this.setEditCell(_5d0,_5d1);}else{this.apply();}if(this.isEditing()||(_5d0&&_5d0.editable&&_5d0.alwaysEditing)){this._focusEditor(_5d0,_5d1);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_5d2){if(_5d2.index==this.info.rowIndex){_5d2.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_5d3,_5d4){return (this.info.rowIndex===_5d3)&&(this.info.cell.index==_5d4);},isEditRow:function(_5d5){return this.info.rowIndex===_5d5;},setEditCell:function(_5d6,_5d7){if(!this.isEditCell(_5d7,_5d6.index)&&this.grid.canEdit&&this.grid.canEdit(_5d6,_5d7)){this.start(_5d6,_5d7,this.isEditRow(_5d7)||_5d6.editable);}},_focusEditor:function(_5d8,_5d9){util.fire(_5d8,"focus",[_5d9]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_5da,_5db,_5dc){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_5db)){this.applyRowEdit();this.grid.updateRow(_5db);}if(_5dc){this.info={cell:_5da,rowIndex:_5db};this.grid.doStartEdit(_5da,_5db);this.grid.updateRow(_5db);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_5da,_5db);this._doCatchBoomerang();},_editorDo:function(_5dd){var c=this.info.cell;if(c&&c.editable){c[_5dd](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_5de,_5df,_5e0){if(this.grid.canEdit(_5df,_5e0)){this.grid.doApplyCellEdit(_5de,_5e0,_5df.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_5e1,_5e2){var c=this.info.cell;if(this.isEditRow(_5e1)&&(!_5e2||c.view==_5e2)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_5e3,_5e4){var c=this.info.cell;if(this.isEditRow(_5e4)&&c.view==_5e3&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_5e5,lang,_5e6,has,_5e7,_5e8,_5e9,_5ea){var _5eb=_5e5(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_5ec){this.layer=_5ec;this.trackMap={};},initialize:function(map){this.map=map;var _5ed=this.layer,_5ee=_5ed.renderer.trackRenderer;if(_5ee&&(_5ed.geometryType==="esriGeometryPoint")){var _5ef=(this.container=new _5ea._GraphicsLayer({id:_5ed.id+"_tracks",_child:true}));_5ef.loaded=true;_5ef.onLoad(_5ef);_5ef._setMap(map,_5ed._div);_5ef.setRenderer(_5ee);}},addFeatures:function(_5f0){var tkid,_5f1=this.trackMap,_5f2=this.layer,_5f3=_5f2._trackIdField;_5e6.forEach(_5f0,function(_5f4){var _5f5=_5f4.attributes;tkid=_5f5[_5f3];var ary=(_5f1[tkid]=(_5f1[tkid]||[]));ary.push(_5f4);});var _5f6=_5f2._startTimeField,_5f7=_5f2.objectIdField;var _5f8=function(a,b){var _5f9=a.attributes[_5f6],_5fa=b.attributes[_5f6];if(_5f9===_5fa){return (a.attributes[_5f7]<b.attributes[_5f7])?-1:1;}else{return (_5f9<_5fa)?-1:1;}};for(tkid in _5f1){_5f1[tkid].sort(_5f8);}},drawTracks:function(){var _5fb=this.container;if(!_5fb){return;}var _5fc=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_5fd,_5fe=this.layer._trackIdField,_5ff;for(tkid in _5fc){ary=_5fc[tkid];path=[];for(i=ary.length-1;i>=0;i--){_5fd=ary[i].geometry;if(_5fd){path.push([_5fd.x,_5fd.y]);}}_5ff={};_5ff[_5fe]=tkid;if(path.length>0){_5fb.add(new _5e8(new _5e9({paths:[path],spatialReference:sr}),null,_5ff));}}},moveLatestToFront:function(){_5e6.forEach(this.getLatestObservations(),function(_600){var _601=_600._shape;_601&&_601._moveToFront();this._repaint(_600,null,true);},this.layer);},getLatestObservations:function(){var _602=[];if(!this.layer.renderer.latestObservationRenderer){return _602;}var _603=this.trackMap,tkid;for(tkid in _603){var ary=_603[tkid];_602.push(ary[ary.length-1]);}return _602;},clearTracks:function(){var _604=this.getLatestObservations();this.trackMap={};var _605=this.container;if(_605){_605.clear();}_5e6.forEach(_604,function(_606){this._repaint(_606,null,true);},this.layer);},isLatestObservation:function(_607){var _608=this.layer._trackIdField;var _609=this.trackMap[_607.attributes[_608]];if(_609){return (_609[_609.length-1]===_607);}return false;},destroy:function(){var _60a=this.container;if(_60a){_60a.clear();_60a._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_5eb,_5e7);}return _5eb;});},"dijit/a11y":function(){define("dijit/a11y",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/sniff","./main"],function(_60b,_60c,_60d,dom,_60e,_60f,has,_610){var _611=(_610._isElementShown=function(elem){var s=_60f.get(elem);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_60e.get(elem,"type")!="hidden");});_610.hasDefaultTabStop=function(elem){switch(elem.nodeName.toLowerCase()){case "a":return _60e.has(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var body;try{var _612=elem.contentDocument;if("designMode" in _612&&_612.designMode=="on"){return true;}body=_612.body;}catch(e1){try{body=elem.contentWindow.document.body;}catch(e2){return false;}}return body&&(body.contentEditable=="true"||(body.firstChild&&body.firstChild.contentEditable=="true"));default:return elem.contentEditable=="true";}};var _613=(_610.isTabNavigable=function(elem){if(_60e.get(elem,"disabled")){return false;}else{if(_60e.has(elem,"tabIndex")){return _60e.get(elem,"tabIndex")>=0;}else{return _610.hasDefaultTabStop(elem);}}});_610._getTabNavigable=function(root){var _614,last,_615,_616,_617,_618,_619={};function _61a(node){return node&&node.tagName.toLowerCase()=="input"&&node.type&&node.type.toLowerCase()=="radio"&&node.name&&node.name.toLowerCase();};var _61b=function(_61c){for(var _61d=_61c.firstChild;_61d;_61d=_61d.nextSibling){if(_61d.nodeType!=1||(has("ie")<=9&&_61d.scopeName!=="HTML")||!_611(_61d)){continue;}if(_613(_61d)){var _61e=+_60e.get(_61d,"tabIndex");if(!_60e.has(_61d,"tabIndex")||_61e==0){if(!_614){_614=_61d;}last=_61d;}else{if(_61e>0){if(!_615||_61e<_616){_616=_61e;_615=_61d;}if(!_617||_61e>=_618){_618=_61e;_617=_61d;}}}var rn=_61a(_61d);if(_60e.get(_61d,"checked")&&rn){_619[rn]=_61d;}}if(_61d.nodeName.toUpperCase()!="SELECT"){_61b(_61d);}}};if(_611(root)){_61b(root);}function rs(node){return _619[_61a(node)]||node;};return {first:rs(_614),last:rs(last),lowest:rs(_615),highest:rs(_617)};};_610.getFirstInTabbingOrder=function(root,doc){var _61f=_610._getTabNavigable(dom.byId(root,doc));return _61f.lowest?_61f.lowest:_61f.first;};_610.getLastInTabbingOrder=function(root,doc){var _620=_610._getTabNavigable(dom.byId(root,doc));return _620.last?_620.last:_620.highest;};return {hasDefaultTabStop:_610.hasDefaultTabStop,isTabNavigable:_610.isTabNavigable,_getTabNavigable:_610._getTabNavigable,getFirstInTabbingOrder:_610.getFirstInTabbingOrder,getLastInTabbingOrder:_610.getLastInTabbingOrder};});},"esri/tasks/QueryTask":function(){define("esri/tasks/QueryTask",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/_base/json","dojo/has","esri/kernel","esri/request","esri/deferredUtils","esri/geometry/normalizeUtils","esri/tasks/Task","esri/tasks/FeatureSet"],function(_621,lang,_622,_623,_624,has,_625,_626,_627,_628,Task,_629){var _62a=_621(Task,{declaredClass:"esri.tasks.QueryTask",constructor:function(url,_62b){this._handler=lang.hitch(this,this._handler);this._relationshipQueryHandler=lang.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=lang.hitch(this,this._executeForIdsHandler);this._countHandler=lang.hitch(this,this._countHandler);this.source=_62b&&_62b.source;this.gdbVersion=_62b&&_62b.gdbVersion;this.registerConnectEvents("esri.tasks.QueryTask",{"complete":["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]});},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},execute:function(_62c,_62d,_62e,_62f,_630){var _631=_630.assembly,_632=this._encode(lang.mixin({},this._url.query,{f:"json"},_62c.toJson(_631&&_631[0]))),_633=this._handler,_634=this._errorHandler;if(this.source){var _635={source:this.source.toJson()};_632.layer=_624.toJson(_635);}if(this.gdbVersion){_632.gdbVersion=this.gdbVersion;}return _626({url:this._url.path+"/query",content:_632,callbackParamName:"callback",load:function(r,i){_633(r,i,_62d,_62e,_630.dfd);},error:function(r){_634(r,_62e,_630.dfd);},callbackSuffix:_62f});},executeRelationshipQuery:function(_636,_637,_638){var _639=this._encode(lang.mixin({},this._url.query,{f:"json"},_636.toJson())),_63a=this._relationshipQueryHandler,_63b=this._errorHandler;if(this.gdbVersion){_639.gdbVersion=this.gdbVersion;}var dfd=new _623(_627._dfdCanceller);dfd._pendingDfd=_626({url:this._url.path+"/queryRelatedRecords",content:_639,callbackParamName:"callback",load:function(r,i){_63a(r,i,_637,_638,dfd);},error:function(r){_63b(r,_638,dfd);}});return dfd;},executeForIds:function(_63c,_63d,_63e,_63f){var _640=_63f.assembly,_641=this._encode(lang.mixin({},this._url.query,{f:"json",returnIdsOnly:true},_63c.toJson(_640&&_640[0]))),_642=this._executeForIdsHandler,_643=this._errorHandler;if(this.source){var _644={source:this.source.toJson()};_641.layer=_624.toJson(_644);}if(this.gdbVersion){_641.gdbVersion=this.gdbVersion;}return _626({url:this._url.path+"/query",content:_641,callbackParamName:"callback",load:function(r,i){_642(r,i,_63d,_63e,_63f.dfd);},error:function(r){_643(r,_63e,_63f.dfd);}});},executeForCount:function(_645,_646,_647,_648){var _649=_648.assembly,_64a=this._encode(lang.mixin({},this._url.query,{f:"json",returnIdsOnly:true,returnCountOnly:true},_645.toJson(_649&&_649[0]))),_64b=this._countHandler,_64c=this._errorHandler;if(this.source){var _64d={source:this.source.toJson()};_64a.layer=_624.toJson(_64d);}if(this.gdbVersion){_64a.gdbVersion=this.gdbVersion;}return _626({url:this._url.path+"/query",content:_64a,callbackParamName:"callback",load:function(r,i){_64b(r,i,_646,_647,_648.dfd);},error:function(r){_64c(r,_647,_648.dfd);}});},_handler:function(_64e,io,_64f,_650,dfd){try{var _651=new _629(_64e);this._successHandler([_651],"onComplete",_64f,dfd);}catch(err){this._errorHandler(err,_650,dfd);}},_relationshipQueryHandler:function(_652,io,_653,_654,dfd){try{var gt=_652.geometryType,sr=_652.spatialReference,_655={};_622.forEach(_652.relatedRecordGroups,function(gr){var _656={};_656.geometryType=gt;_656.spatialReference=sr;_656.features=gr.relatedRecords;var fset=new _629(_656);_655[gr.objectId]=fset;});this._successHandler([_655],"onExecuteRelationshipQueryComplete",_653,dfd);}catch(err){this._errorHandler(err,_654,dfd);}},_executeForIdsHandler:function(_657,io,_658,_659,dfd){try{this._successHandler([_657.objectIds],"onExecuteForIdsComplete",_658,dfd);}catch(err){this._errorHandler(err,_659,dfd);}},_countHandler:function(_65a,io,_65b,_65c,dfd){try{var _65d,_65e=_65a.features,ids=_65a.objectIds;if(ids){_65d=ids.length;}else{if(_65e){throw new Error("Unable to perform query. Please check your parameters.");}else{_65d=_65a.count;}}this._successHandler([_65d],"onExecuteForCountComplete",_65b,dfd);}catch(err){this._errorHandler(err,_65c,dfd);}}});_628._createWrappers(_62a);if(has("extend-esri")){lang.setObject("tasks.QueryTask",_62a,_625);}return _62a;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_65f,_660,_661,_662){return _65f("dijit.CheckedMenuItem",_661,{templateString:_662,checked:false,_setCheckedAttr:function(_663){_660.toggle(this.domNode,"dijitCheckedMenuItemChecked",_663);this.domNode.setAttribute("aria-checked",_663?"true":"false");this._set("checked",_663);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"esri/toolbars/_toolbar":function(){define("esri/toolbars/_toolbar",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_664,lang,has,_665){var TB=_664(null,{declaredClass:"esri.toolbars._Toolbar",constructor:function(map){this.map=map;},_cursors:{"move":"pointer","move-v":"pointer","move-gv":"pointer","box0":"nw-resize","box1":"n-resize","box2":"ne-resize","box3":"e-resize","box4":"se-resize","box5":"s-resize","box6":"sw-resize","box7":"w-resize","box8":"pointer"},_deactivateMapTools:function(nav,_666,_667,_668){var map=this.map;if(nav){this._mapNavState={isDoubleClickZoom:map.isDoubleClickZoom,isClickRecenter:map.isClickRecenter,isPan:map.isPan,isRubberBandZoom:map.isRubberBandZoom,isKeyboardNavigation:map.isKeyboardNavigation,isScrollWheelZoom:map.isScrollWheelZoom};map.disableDoubleClickZoom();map.disableClickRecenter();map.disablePan();map.disableRubberBandZoom();map.disableKeyboardNavigation();}if(_666){map.hideZoomSlider();}if(_667){map.hidePanArrows();}if(_668){map.graphics.disableMouseEvents();}},_activateMapTools:function(nav,_669,_66a,_66b){var map=this.map,_66c=this._mapNavState;if(nav&&_66c){if(_66c.isDoubleClickZoom){map.enableDoubleClickZoom();}if(_66c.isClickRecenter){map.enableClickRecenter();}if(_66c.isPan){map.enablePan();}if(_66c.isRubberBandZoom){map.enableRubberBandZoom();}if(_66c.isKeyboardNavigation){map.enableKeyboardNavigation();}if(_66c.isScrollWheelZoom){map.enableScrollWheelZoom();}}if(_669){map.showZoomSlider();}if(_66a){map.showPanArrows();}if(_66b){map.graphics.enableMouseEvents();}}});if(has("extend-esri")){lang.setObject("toolbars._Toolbar",TB,_665);}return TB;});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_66d,lang,_66e,has,_66f,_670,_671,_672){var _673=_66d(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_674,_675,_676,_677){this.origin=_674;this.cellWidth=_675.width;this.cellHeight=_675.height;this.mapWidth=_676.width;this.mapHeight=_676.height;this.srInfo=_677;},setResolution:function(_678){this._resolution=(_678.xmax-_678.xmin)/this.mapWidth;if(this.srInfo){var _679=Math.round((2*this.srInfo.valid[1])/this._resolution),_67a=Math.round(_679/this.cellWidth);this._frameStats=[_67a,0,_67a-1];}},getCellCoordinates:function(_67b){var res=this._resolution,_67c=this.origin;return {row:Math.floor((_67c.y-_67b.y)/(this.cellHeight*res)),col:Math.floor((_67b.x-_67c.x)/(this.cellWidth*res))};},normalize:function(col){var _67d=this._frameStats;if(_67d){var _67e=_67d[0],m180=_67d[1],p180=_67d[2];if(col<m180){col=col%_67e;col=col<m180?col+_67e:col;}else{if(col>p180){col=col%_67e;}}}return col;},intersects:function(_67f,_680){var _681=this.srInfo;if(_681){return _66e.some(_680._getParts(_681),function(_682){return _67f.intersects(_682.extent);});}else{return _67f.intersects(_680);}},getCellExtent:function(row,col){var res=this._resolution,_683=this.origin,_684=this.cellWidth,_685=this.cellHeight;return new _671((col*_684*res)+_683.x,_683.y-((row+1)*_685*res),((col+1)*_684*res)+_683.x,_683.y-(row*_685*res),new _670(_683.spatialReference.toJson()));},getLatticeID:function(_686){var _687=this.getCellCoordinates({x:_686.xmin,y:_686.ymax}),_688=this.getCellCoordinates({x:_686.xmax,y:_686.ymin}),_689=_687.row,_68a=_688.row,_68b=this.normalize(_687.col),_68c=this.normalize(_688.col);return _689+"_"+_68a+"_"+_68b+"_"+_68c;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_68d,_68e){var _68f=this.getCellCoordinates({x:_68d.xmin,y:_68d.ymax}),_690=this.getCellCoordinates({x:_68d.xmax,y:_68d.ymin}),_691=_68f.row,_692=_690.row,_693=_68f.col,_694=_690.col,_695=[],i,j,nj,_696=[],_697=[],len,xmin,xmax,ymin,ymax,_698=[],_699,_69a;for(i=_691;i<=_692;i++){for(j=_693;j<=_694;j++){nj=this.normalize(j);_68d=this.getCellExtent(i,nj);_695.push({row:i,col:nj,extent:_68d,resolution:this._resolution});if(_68e){_696.push(_68d.xmin,_68d.xmax);_697.push(_68d.ymin,_68d.ymax);}}}_693=this.normalize(_693);_694=this.normalize(_694);_696.sort(this.sorter);_697.sort(this.sorter);len=_696.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_696[i]===_696[i+1]){_696.splice(i,1);}}}len=_697.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_697[i]===_697[i+1]){_697.splice(i,1);}}}if(_696.length&&_697.length){xmin=_696[0];xmax=_696[_696.length-1];ymin=_697[0];ymax=_697[_697.length-1];len=_696.length;for(i=0;i<len;i++){_698.push([[_696[i],ymax],[_696[i],ymin]]);}len=_697.length;for(i=0;i<len;i++){_698.push([[xmin,_697[i]],[xmax,_697[i]]]);}_699=new _672({paths:_698,spatialReference:this.origin.spatialReference.toJson()});_69a=_691+"_"+_692+"_"+_693+"_"+_694;_695.push({latticeID:_69a,lattice:_699,resolution:this._resolution});}return {minRow:_691,maxRow:_692,minCol:_693,maxCol:_694,cells:_695};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_673,_66f);}return _673;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_69b,_69c,_69d,_69e,dom,_69f,_6a0,_6a1,keys,lang,on,has,win,_6a2,pm,_6a3,_6a4){if(has("dijit-legacy-requires")){_6a4(0,function(){var _6a5=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_69b(_6a5);});}return _69d("dijit.Menu",_6a3,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_69c.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_6a6){return _6a2.get(this._iframeContentDocument(_6a6))||this._iframeContentDocument(_6a6)["__parent__"]||(_6a6.name&&win.doc.frames[_6a6.name])||null;},_iframeContentDocument:function(_6a7){return _6a7.contentDocument||(_6a7.contentWindow&&_6a7.contentWindow.document)||(_6a7.name&&win.doc.frames[_6a7.name]&&win.doc.frames[_6a7.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _6a8=node,_6a9=this._iframeContentWindow(_6a8);cn=win.body(_6a9.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _6aa={node:node,iframe:_6a8};_69f.set(node,"_dijitMenu"+this.id,this._bindings.push(_6aa));var _6ab=lang.hitch(this,function(cn){var _6ac=this.selector,_6ad=_6ac?function(_6ae){return on.selector(_6ac,_6ae);}:function(_6af){return _6af;},self=this;return [on(cn,_6ad(this.leftClickToOpen?"click":"contextmenu"),function(evt){_69e.stop(evt);self._scheduleOpen(this,_6a8,{x:evt.pageX,y:evt.pageY});}),on(cn,_6ad("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_69e.stop(evt);self._scheduleOpen(this,_6a8);}})];});_6aa.connects=cn?_6ab(cn):[];if(_6a8){_6aa.onloadHandler=lang.hitch(this,function(){var _6b0=this._iframeContentWindow(_6a8);cn=win.body(_6b0.document);_6aa.connects=_6ab(cn);});if(_6a8.addEventListener){_6a8.addEventListener("load",_6aa.onloadHandler,false);}else{_6a8.attachEvent("onload",_6aa.onloadHandler);}}},unBindDomNode:function(_6b1){var node;try{node=dom.byId(_6b1,this.ownerDocument);}catch(e){return;}var _6b2="_dijitMenu"+this.id;if(node&&_69f.has(node,_6b2)){var bid=_69f.get(node,_6b2)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _6b3=b.iframe;if(_6b3){if(_6b3.removeEventListener){_6b3.removeEventListener("load",b.onloadHandler,false);}else{_6b3.detachEvent("onload",b.onloadHandler);}}_69f.remove(node,_6b2);delete this._bindings[bid];}},_scheduleOpen:function(_6b4,_6b5,_6b6){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_6b4,iframe:_6b5,coords:_6b6});},1);}},_openMyself:function(args){var _6b7=args.target,_6b8=args.iframe,_6b9=args.coords;this.currentTarget=_6b7;if(_6b9){if(_6b8){var ifc=_6a0.position(_6b8,true),_6ba=this._iframeContentWindow(_6b8),_6bb=_6a0.docScroll(_6ba.document);var cs=_6a1.getComputedStyle(_6b8),tp=_6a1.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_6b8,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_6b8,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_6b8,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_6b8,cs.borderTopWidth):0);_6b9.x+=ifc.x+left-_6bb.x;_6b9.y+=ifc.y+top-_6bb.y;}}else{_6b9=_6a0.position(_6b7,true);_6b9.x+=10;_6b9.y+=10;}var self=this;var _6bc=this._focusManager.get("prevNode");var _6bd=this._focusManager.get("curNode");var _6be=!_6bd||(dom.isDescendant(_6bd,this.domNode))?_6bc:_6bd;function _6bf(){if(self.refocus&&_6be){_6be.focus();}pm.close(self);};pm.open({popup:this,x:_6b9.x,y:_6b9.y,onExecute:_6bf,onCancel:_6bf,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_69c.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_6c0,_6c1,_6c2,_6c3,lang,win,dom,_6c4,_6c5,_6c6,has,on,_6c7,_6c8,_6c9,dnd){var _6ca=_6c1("dojo.dnd.Container",_6c6,{skipForm:false,allowNested:false,constructor:function(node,_6cb){this.node=dom.byId(node);if(!_6cb){_6cb={};}this.creator=_6cb.creator||null;this.skipForm=_6cb.skipForm;this.parent=_6cb.dropParent&&dom.byId(_6cb.dropParent);this.map={};this.current=null;this.containerState="";_6c4.add(this.node,"dojoDndContainer");if(!(_6cb&&_6cb._skipStartup)){this.startup();}this.events=[on(this.node,_6c9.over,lang.hitch(this,"onMouseOver")),on(this.node,_6c9.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_6c3.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _6c7((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_6cc,_6cd){if(!this.parent.firstChild){_6cd=null;}else{if(_6cc){if(!_6cd){_6cd=this.parent.firstChild;}}else{if(_6cd){_6cd=_6cd.nextSibling;}}}var i,t;if(_6cd){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_6cd.parentNode.insertBefore(t.node,_6cd);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_6c0.forEach(this.events,function(_6ce){_6ce.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_6cf,node,Ctor){_6cf._skipStartup=true;return new Ctor(node,_6cf);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_6c2.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_6d0){var _6d1="dojoDnd"+type;var _6d2=type.toLowerCase()+"State";_6c4.replace(this.node,_6d1+_6d0,_6d1+this[_6d2]);this[_6d2]=_6d0;},_addItemClass:function(node,type){_6c4.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_6c4.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _6d3=node.parentNode;_6d3;node=_6d3,_6d3=node.parentNode){if((_6d3==this.parent||this.allowNested)&&_6c4.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_6c4.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _6c5.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_6c5.create("tr");_6c5.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _6c5.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _6d4=item&&lang.isObject(item),data,type,n;if(_6d4&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_6d4&&item.data)?item.data:item;type=(_6d4&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _6ca;});},"dojo/dnd/common":function(){define(["../_base/connect","../_base/kernel","../_base/lang","../dom"],function(_6d5,_6d6,lang,dom){var _6d7=lang.getObject("dojo.dnd",true);_6d7.getCopyKeyState=_6d5.isCopyKey;_6d7._uniqueId=0;_6d7.getUniqueId=function(){var id;do{id=_6d6._scopeName+"Unique"+(++_6d7._uniqueId);}while(dom.byId(id));return id;};_6d7._empty={};_6d7.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};return _6d7;});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_6d8,has,_6d9){return _6d8("dojox.grid._ViewManager",null,{constructor:function(_6da){this.grid=_6da;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_6db){_6db.idx=this.views.length;this.views.push(_6db);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _6dc=[];for(var i=0,v;v=this.views[i];i++){_6dc.push(v.contentNode);}return _6dc;},forEach:function(_6dd){for(var i=0,v;v=this.views[i];i++){_6dd(v,i);}},onEach:function(_6de,_6df){_6df=_6df||[];for(var i=0,v;v=this.views[i];i++){if(_6de in v){v[_6de].apply(v,_6df);}}},normalizeHeaderNodeHeight:function(){var _6e0=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_6e0.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_6e0);},normalizeRowNodeHeights:function(_6e1){var h=0;var _6e2=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_6e1.length<=1){return;}for(var i=0,n;(n=_6e1[i]);i++){if(!_6d9.contains(n,"dojoxGridNonNormalizedCell")){_6e2[i]=n.firstChild.offsetHeight;h=Math.max(h,_6e2[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_6e1[i]);i++){if(_6e2[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_6e3){var _6e4=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_6e3));i++){n.firstChild.style.height="";_6e4.push(n);}this.normalizeRowNodeHeights(_6e4);},getViewWidth:function(_6e5){return this.views[_6e5].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_6e6){_6e6.headerContentNode.style.height="";});var h=0;this.forEach(function(_6e7){h=Math.max(_6e7.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_6e8){h=Math.max(_6e8.domNode.offsetHeight,h);});return h;},findClient:function(_6e9){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _6ea=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_6ea(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_6ea(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_6ea(v,l);}return l;},renderRow:function(_6eb,_6ec,_6ed){var _6ee=[];for(var i=0,v,n,_6ef;(v=this.views[i])&&(n=_6ec[i]);i++){_6ef=v.renderRow(_6eb);n.appendChild(_6ef);_6ee.push(_6ef);}if(!_6ed){this.normalizeRowNodeHeights(_6ee);}},rowRemoved:function(_6f0){this.onEach("rowRemoved",[_6f0]);},updateRow:function(_6f1,_6f2){for(var i=0,v;v=this.views[i];i++){v.updateRow(_6f1);}if(!_6f2){this.renormalizeRow(_6f1);}},updateRowStyles:function(_6f3){this.onEach("updateRowStyles",[_6f3]);},setScrollTop:function(_6f4){var top=_6f4;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_6f4);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"dijit/place":function(){define("dijit/place",["dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/window","dojo/window","./main"],function(_6f5,_6f6,_6f7,_6f8,win,_6f9,_6fa){function _6fb(node,_6fc,_6fd,_6fe){var view=_6f9.getBox(node.ownerDocument);if(!node.parentNode||String(node.parentNode.tagName).toLowerCase()!="body"){win.body(node.ownerDocument).appendChild(node);}var best=null;_6f5.some(_6fc,function(_6ff){var _700=_6ff.corner;var pos=_6ff.pos;var _701=0;var _702={w:{"L":view.l+view.w-pos.x,"R":pos.x-view.l,"M":view.w}[_700.charAt(1)],h:{"T":view.t+view.h-pos.y,"B":pos.y-view.t,"M":view.h}[_700.charAt(0)]};var s=node.style;s.left=s.right="auto";if(_6fd){var res=_6fd(node,_6ff.aroundCorner,_700,_702,_6fe);_701=typeof res=="undefined"?0:res;}var _703=node.style;var _704=_703.display;var _705=_703.visibility;if(_703.display=="none"){_703.visibility="hidden";_703.display="";}var bb=_6f6.position(node);_703.display=_704;_703.visibility=_705;var _706={"L":pos.x,"R":pos.x-bb.w,"M":Math.max(view.l,Math.min(view.l+view.w,pos.x+(bb.w>>1))-bb.w)}[_700.charAt(1)],_707={"T":pos.y,"B":pos.y-bb.h,"M":Math.max(view.t,Math.min(view.t+view.h,pos.y+(bb.h>>1))-bb.h)}[_700.charAt(0)],_708=Math.max(view.l,_706),_709=Math.max(view.t,_707),endX=Math.min(view.l+view.w,_706+bb.w),endY=Math.min(view.t+view.h,_707+bb.h),_70a=endX-_708,_70b=endY-_709;_701+=(bb.w-_70a)+(bb.h-_70b);if(best==null||_701<best.overflow){best={corner:_700,aroundCorner:_6ff.aroundCorner,x:_708,y:_709,w:_70a,h:_70b,overflow:_701,spaceAvailable:_702};}return !_701;});if(best.overflow&&_6fd){_6fd(node,best.aroundCorner,best.corner,best.spaceAvailable,_6fe);}var l=_6f6.isBodyLtr(node.ownerDocument),s=node.style;s.top=best.y+"px";s[l?"left":"right"]=(l?best.x:view.w-best.x-best.w)+"px";s[l?"right":"left"]="auto";return best;};var _70c={at:function(node,pos,_70d,_70e){var _70f=_6f5.map(_70d,function(_710){var c={corner:_710,pos:{x:pos.x,y:pos.y}};if(_70e){c.pos.x+=_710.charAt(1)=="L"?_70e.x:-_70e.x;c.pos.y+=_710.charAt(0)=="T"?_70e.y:-_70e.y;}return c;});return _6fb(node,_70f);},around:function(node,_711,_712,_713,_714){var _715=(typeof _711=="string"||"offsetWidth" in _711)?_6f6.position(_711,true):_711;if(_711.parentNode){var _716=_6f7.getComputedStyle(_711).position=="absolute";var _717=_711.parentNode;while(_717&&_717.nodeType==1&&_717.nodeName!="BODY"){var _718=_6f6.position(_717,true),pcs=_6f7.getComputedStyle(_717);if(/relative|absolute/.test(pcs.position)){_716=false;}if(!_716&&/hidden|auto|scroll/.test(pcs.overflow)){var _719=Math.min(_715.y+_715.h,_718.y+_718.h);var _71a=Math.min(_715.x+_715.w,_718.x+_718.w);_715.x=Math.max(_715.x,_718.x);_715.y=Math.max(_715.y,_718.y);_715.h=_719-_715.y;_715.w=_71a-_715.x;}if(pcs.position=="absolute"){_716=true;}_717=_717.parentNode;}}var x=_715.x,y=_715.y,_71b="w" in _715?_715.w:(_715.w=_715.width),_71c="h" in _715?_715.h:(_6f8.deprecated("place.around: dijit/place.__Rectangle: { x:"+x+", y:"+y+", height:"+_715.height+", width:"+_71b+" } has been deprecated.  Please use { x:"+x+", y:"+y+", h:"+_715.height+", w:"+_71b+" }","","2.0"),_715.h=_715.height);var _71d=[];function push(_71e,_71f){_71d.push({aroundCorner:_71e,corner:_71f,pos:{x:{"L":x,"R":x+_71b,"M":x+(_71b>>1)}[_71e.charAt(1)],y:{"T":y,"B":y+_71c,"M":y+(_71c>>1)}[_71e.charAt(0)]}});};_6f5.forEach(_712,function(pos){var ltr=_713;switch(pos){case "above-centered":push("TM","BM");break;case "below-centered":push("BM","TM");break;case "after-centered":ltr=!ltr;case "before-centered":push(ltr?"ML":"MR",ltr?"MR":"ML");break;case "after":ltr=!ltr;case "before":push(ltr?"TL":"TR",ltr?"TR":"TL");push(ltr?"BL":"BR",ltr?"BR":"BL");break;case "below-alt":ltr=!ltr;case "below":push(ltr?"BL":"BR",ltr?"TL":"TR");push(ltr?"BR":"BL",ltr?"TR":"TL");break;case "above-alt":ltr=!ltr;case "above":push(ltr?"TL":"TR",ltr?"BL":"BR");push(ltr?"TR":"TL",ltr?"BR":"BL");break;default:push(pos.aroundCorner,pos.corner);}});var _720=_6fb(node,_71d,_714,{w:_71b,h:_71c});_720.aroundNodePos=_715;return _720;}};return _6fa.place=_70c;});},"esri/tasks/Task":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","esri/kernel","esri/deferredUtils","esri/urlUtils","esri/Evented"],function(_721,lang,_722,has,_723,_724,_725,_726){var Task=_721(_726,{declaredClass:"esri.tasks._Task",constructor:function(url){if(url&&lang.isString(url)){this._url=_725.urlToObject(this.url=url);}this.normalization=true;this._errorHandler=lang.hitch(this,this._errorHandler);this.registerConnectEvents("esri.tasks._Task",{"error":["error"]});},_useSSL:function(){var _727=this._url,re=/^http:/i,rep="https:";if(this.url){this.url=this.url.replace(re,rep);}if(_727&&_727.path){_727.path=_727.path.replace(re,rep);}},_encode:function(_728,_729,_72a){var _72b,type,_72c={},i,p,pl;for(i in _728){if(i==="declaredClass"){continue;}_72b=_728[i];type=typeof _72b;if(_72b!==null&&_72b!==undefined&&type!=="function"){if(lang.isArray(_72b)){_72c[i]=[];pl=_72b.length;for(p=0;p<pl;p++){_72c[i][p]=this._encode(_72b[p]);}}else{if(type==="object"){if(_72b.toJson){var json=_72b.toJson(_72a&&_72a[i]);if(_72b.declaredClass==="esri.tasks.FeatureSet"){if(json.spatialReference){json.sr=json.spatialReference;delete json.spatialReference;}}_72c[i]=_729?json:_722.toJson(json);}}else{_72c[i]=_72b;}}}}return _72c;},_successHandler:function(args,_72d,_72e,dfd){if(_72d){this[_72d].apply(this,args);}if(_72e){_72e.apply(null,args);}if(dfd){_724._resDfd(dfd,args);}},_errorHandler:function(err,_72f,dfd){this.onError(err);if(_72f){_72f(err);}if(dfd){dfd.errback(err);}},setNormalization:function(_730){this.normalization=_730;},onError:function(){}});if(has("extend-esri")){_723.Task=Task;}return Task;});},"esri/tasks/FeatureSet":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/graphic","esri/SpatialReference","esri/graphicsUtils","esri/geometry/jsonUtils","esri/symbols/jsonUtils"],function(_731,lang,_732,has,_733,_734,_735,_736,_737,_738,_739){var _73a=_731(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(json){if(json){lang.mixin(this,json);var _73b=this.features,sr=json.spatialReference,_73c=_738.getGeometryType(json.geometryType);sr=(this.spatialReference=new _736(sr));this.geometryType=json.geometryType;if(json.fields){this.fields=json.fields;}_732.forEach(_73b,function(_73d,i){var _73e=_73d.geometry&&_73d.geometry.spatialReference;_73b[i]=new _735((_73c&&_73d.geometry)?new _73c(_73d.geometry):null,_73d.symbol&&_739.fromJson(_73d.symbol),_73d.attributes);if(_73b[i].geometry&&!_73e){_73b[i].geometry.setSpatialReference(sr);}});}else{this.features=[];}},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(_73f){var json={};if(this.displayFieldName){json.displayFieldName=this.displayFieldName;}if(this.fields){json.fields=this.fields;}if(this.spatialReference){json.spatialReference=this.spatialReference.toJson();}else{if(this.features[0]&&this.features[0].geometry){json.spatialReference=this.features[0].geometry.spatialReference.toJson();}}if(this.features[0]){if(this.features[0].geometry){json.geometryType=_738.getJsonType(this.features[0].geometry);}json.features=_737._encodeGraphics(this.features,_73f);}json.exceededTransferLimit=this.exceededTransferLimit;return _734.fixJson(json);}});if(has("extend-esri")){lang.setObject("tasks.FeatureSet",_73a,_733);}return _73a;});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_740,_741,keys,_742,_743,_744){return _740("dijit.DropDownMenu",[_744,_743],{templateString:_742,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_741.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_741.stop(evt);}break;}}});});},"dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_745){return _745.grid.cells;});},"dijit/_Widget":function(){define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss"],function(_746,_747,_748,_749,has,_74a,lang,_74b,_74c,_74d,_74e,_74f,_750){function _751(){};function _752(_753){return function(obj,_754,_755,_756){if(obj&&typeof _754=="string"&&obj[_754]==_751){return obj.on(_754.substring(2).toLowerCase(),lang.hitch(_755,_756));}return _753.apply(_748,arguments);};};_746.around(_748,"connect",_752);if(_74a.connect){_746.around(_74a,"connect",_752);}var _757=_749("dijit._Widget",[_74e,_74f,_750],{onClick:_751,onDblClick:_751,onKeyDown:_751,onKeyPress:_751,onKeyUp:_751,onMouseDown:_751,onMouseMove:_751,onMouseOut:_751,onMouseOver:_751,onMouseLeave:_751,onMouseEnter:_751,onMouseUp:_751,constructor:function(_758){this._toConnect={};for(var name in _758){if(this[name]===_751){this._toConnect[name.replace(/^on/,"").toLowerCase()]=_758[name];delete _758[name];}}},postCreate:function(){this.inherited(arguments);for(var name in this._toConnect){this.on(name,this._toConnect[name]);}delete this._toConnect;},on:function(type,func){if(this[this._onMap(type)]===_751){return _748.connect(this.domNode,type.toLowerCase(),this,func);}return this.inherited(arguments);},_setFocusedAttr:function(val){this._focused=val;this._set("focused",val);},setAttribute:function(attr,_759){_74a.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_759);},attr:function(name,_75a){if(_747.isDebug){var _75b=arguments.callee._ach||(arguments.callee._ach={}),_75c=(arguments.callee.caller||"unknown caller").toString();if(!_75b[_75c]){_74a.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_75c,"","2.0");_75b[_75c]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},getDescendants:function(){_74a.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?_74b("[widgetId]",this.containerNode).map(_74d.byNode):[];},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});if(has("dijit-legacy-requires")){_74c(0,function(){var _75d=["dijit/_base"];require(_75d);});}return _757;});},"dojo/cache":function(){define(["./_base/kernel","./text"],function(dojo){return dojo.cache;});},"dijit/_OnDijitClickMixin":function(){define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","dojo/_base/unload","dojo/_base/window","./a11yclick"],function(on,_75e,keys,_75f,has,_760,win,_761){var ret=_75f("dijit._OnDijitClickMixin",null,{connect:function(obj,_762,_763){return this.inherited(arguments,[obj,_762=="ondijitclick"?_761:_762,_763]);}});ret.a11yclick=_761;return ret;});},"dijit/_FocusMixin":function(){define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(_764,_765,_766,lang){lang.extend(_765,{focused:false,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus();},_onBlur:function(){this.onBlur();}});return _766("dijit._FocusMixin",null,{_focusManager:_764});});},"dijit/_Templated":function(){define("dijit/_Templated",["./_WidgetBase","./_TemplatedMixin","./_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(_767,_768,_769,_76a,_76b,lang,_76c){lang.extend(_767,{waiRole:"",waiState:""});return _76b("dijit._Templated",[_768,_769],{widgetsInTemplate:false,constructor:function(){_76c.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0");},_attachTemplateNodes:function(_76d,_76e){this.inherited(arguments);var _76f=lang.isArray(_76d)?_76d:(_76d.all||_76d.getElementsByTagName("*"));var x=lang.isArray(_76d)?0:-1;for(;x<_76f.length;x++){var _770=(x==-1)?_76d:_76f[x];var role=_76e(_770,"waiRole");if(role){_770.setAttribute("role",role);}var _771=_76e(_770,"waiState");if(_771){_76a.forEach(_771.split(/\s*,\s*/),function(_772){if(_772.indexOf("-")!=-1){var pair=_772.split("-");_770.setAttribute("aria-"+pair[0],pair[1]);}});}}}});});},"dijit/focus":function(){define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/ready","dojo/sniff","dojo/Stateful","dojo/_base/unload","dojo/_base/window","dojo/window","./a11y","./registry","./main"],function(_773,_774,dom,_775,_776,_777,lang,on,_778,has,_779,_77a,win,_77b,a11y,_77c,_77d){var _77e=_774([_779,_777],{curNode:null,activeStack:[],constructor:function(){var _77f=lang.hitch(this,function(node){if(dom.isDescendant(this.curNode,node)){this.set("curNode",null);}if(dom.isDescendant(this.prevNode,node)){this.set("prevNode",null);}});_773.before(_776,"empty",_77f);_773.before(_776,"destroy",_77f);},registerIframe:function(_780){return this.registerWin(_780.contentWindow,_780);},registerWin:function(_781,_782){var _783=this;var _784=function(evt){_783._justMouseDowned=true;setTimeout(function(){_783._justMouseDowned=false;},0);if(has("ie")&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}_783._onTouchNode(_782||evt.target||evt.srcElement,"mouse");};var doc=has("ie")?_781.document.documentElement:_781.document;if(doc){if(has("ie")){_781.document.body.attachEvent("onmousedown",_784);var _785=function(evt){var tag=evt.srcElement.tagName.toLowerCase();if(tag=="#document"||tag=="body"){return;}if(a11y.isTabNavigable(evt.srcElement)){_783._onFocusNode(_782||evt.srcElement);}else{_783._onTouchNode(_782||evt.srcElement);}};doc.attachEvent("onfocusin",_785);var _786=function(evt){_783._onBlurNode(_782||evt.srcElement);};doc.attachEvent("onfocusout",_786);return {remove:function(){_781.document.detachEvent("onmousedown",_784);doc.detachEvent("onfocusin",_785);doc.detachEvent("onfocusout",_786);doc=null;}};}else{doc.body.addEventListener("mousedown",_784,true);doc.body.addEventListener("touchstart",_784,true);var _787=function(evt){_783._onFocusNode(_782||evt.target);};doc.addEventListener("focus",_787,true);var _788=function(evt){_783._onBlurNode(_782||evt.target);};doc.addEventListener("blur",_788,true);return {remove:function(){doc.body.removeEventListener("mousedown",_784,true);doc.body.removeEventListener("touchstart",_784,true);doc.removeEventListener("focus",_787,true);doc.removeEventListener("blur",_788,true);doc=null;}};}}},_onBlurNode:function(node){if(this._clearFocusTimer){clearTimeout(this._clearFocusTimer);}this._clearFocusTimer=setTimeout(lang.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null);}),0);if(this._justMouseDowned){return;}if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);}this._clearActiveWidgetsTimer=setTimeout(lang.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([]);}),0);},_onTouchNode:function(node,by){if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);delete this._clearActiveWidgetsTimer;}var _789=[];try{while(node){var _78a=_775.get(node,"dijitPopupParent");if(_78a){node=_77c.byId(_78a).domNode;}else{if(node.tagName&&node.tagName.toLowerCase()=="body"){if(node===win.body()){break;}node=_77b.get(node.ownerDocument).frameElement;}else{var id=node.getAttribute&&node.getAttribute("widgetId"),_78b=id&&_77c.byId(id);if(_78b&&!(by=="mouse"&&_78b.get("disabled"))){_789.unshift(id);}node=node.parentNode;}}}}catch(e){}this._setStack(_789,by);},_onFocusNode:function(node){if(!node){return;}if(node.nodeType==9){return;}if(this._clearFocusTimer){clearTimeout(this._clearFocusTimer);delete this._clearFocusTimer;}this._onTouchNode(node);if(node==this.curNode){return;}this.set("prevNode",this.curNode);this.set("curNode",node);},_setStack:function(_78c,by){var _78d=this.activeStack;this.set("activeStack",_78c);for(var _78e=0;_78e<Math.min(_78d.length,_78c.length);_78e++){if(_78d[_78e]!=_78c[_78e]){break;}}var _78f;for(var i=_78d.length-1;i>=_78e;i--){_78f=_77c.byId(_78d[i]);if(_78f){_78f._hasBeenBlurred=true;_78f.set("focused",false);if(_78f._focusManager==this){_78f._onBlur(by);}this.emit("widget-blur",_78f,by);}}for(i=_78e;i<_78c.length;i++){_78f=_77c.byId(_78c[i]);if(_78f){_78f.set("focused",true);if(_78f._focusManager==this){_78f._onFocus(by);}this.emit("widget-focus",_78f,by);}}},focus:function(node){if(node){try{node.focus();}catch(e){}}}});var _790=new _77e();_778(function(){var _791=_790.registerWin(_77b.get(win.doc));if(has("ie")){_77a.addOnWindowUnload(function(){if(_791){_791.remove();_791=null;}});}});_77d.focus=function(node){_790.focus(node);};for(var attr in _790){if(!/^_/.test(attr)){_77d.focus[attr]=typeof _790[attr]=="function"?lang.hitch(_790,attr):_790[attr];}}_790.watch(function(attr,_792,_793){_77d.focus[attr]=_793;});return _790;});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_794,lang,dom){var dgu=lang.getObject("grid.util",true,_794);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_795,_796){if(_796>=0){var s=_795.style;var v=_796+"px";if(_795&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_797,_798,_799,_79a){var evts=(_79a?_79a:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_798.connect(_797,"on"+evts[i],_799);}};dgu.removeNode=function(_79b){_79b=dom.byId(_79b);_79b&&_79b.parentNode&&_79b.parentNode.removeChild(_79b);return _79b;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_79c,_79d,_79e){if(_79c.length<=_79d){_79c[_79d]=_79e;}else{_79c.splice(_79d,0,_79e);}};dgu.arrayRemove=function(_79f,_7a0){_79f.splice(_7a0,1);};dgu.arraySwap=function(_7a1,inI,inJ){var _7a2=_7a1[inI];_7a1[inI]=_7a1[inJ];_7a1[inJ]=_7a2;};return dgu;});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_7a3,_7a4,lang,json,has,_7a5,_7a6,_7a7,html){var _7a8=_7a5("dojox.grid.DataGrid",_7a6,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _7a7(this);},get:function(_7a9,_7aa){if(_7aa&&this.field=="_item"&&!this.fields){return _7aa;}else{if(_7aa&&this.fields){var ret=[];var s=this.grid.store;_7a4.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_7aa,f));});return ret;}else{if(!_7aa&&typeof _7a9==="string"){return this.inherited(arguments);}}}return (!_7aa?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_7aa:this.grid.store.getValue(_7aa,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _7ab=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_7ab=true;}if(!this.updating){this.beginUpdate();_7ab=true;}if(_7ab){var _7ac=this;this._endUpdateDelay=setTimeout(function(){delete _7ac._endUpdateDelay;_7ac.endUpdate();},this.updateDelay);}}},_onSet:function(item,_7ad,_7ae,_7af){this._checkUpdateStatus();var idx=this.getItemIndex(item);if(idx>-1){this.updateRow(idx);}},_createItem:function(item,_7b0){var idty=this._hasIdentity?this.store.getIdentity(item):json.toJson(this.query)+":idx:"+_7b0+":sort:"+json.toJson(this.getSortProps());var o=this._by_idty[idty]={idty:idty,item:item};return o;},_addItem:function(item,_7b1,_7b2){this._by_idx[_7b1]=this._createItem(item,_7b1);if(!_7b2){this.updateRow(_7b1);}},_onNew:function(item,_7b3){this._checkUpdateStatus();var _7b4=this.get("rowCount");this._addingItem=true;this.updateRowCount(_7b4+1);this._addingItem=false;this._addItem(item,_7b4);this.showMessage();},_onDelete:function(item){this._checkUpdateStatus();var idx=this._getItemIndex(item,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_7b5,_7b6,_7b7){if(this._requestsPending(0)){return;}this._setQuery(_7b6,_7b7);this._setStore(_7b5);this._refresh(true);},setQuery:function(_7b8,_7b9){if(this._requestsPending(0)){return;}this._setQuery(_7b8,_7b9);this._refresh(true);},setItems:function(_7ba){this.items=_7ba;this._setStore(this.store);this._refresh(true);},_setQuery:function(_7bb,_7bc){this.query=_7bb;this.queryOptions=_7bc||this.queryOptions;},_setStore:function(_7bd){if(this.store&&this._store_connects){_7a4.forEach(this._store_connects,this.disconnect,this);}this.store=_7bd;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(size,req){if(!this.scroller){return;}if(this.rowCount!=size){if(req.isRender){this.scroller.init(size,this.keepRows,this.rowsPerPage);this.rowCount=size;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(size);}}if(!size){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_7be,req){if(!this.scroller){return;}if(_7be&&_7be.length>0){_7a4.forEach(_7be,function(item,idx){this._addItem(item,req.start+idx,true);},this);this.updateRows(req.start,_7be.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(has("ie")){html.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_7bf,_7c0){_7bf=_7bf||0;if(this.store&&!this._pending_requests[_7bf]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_7bf]=true;try{if(this.items){var _7c1=this.items;var _7c2=this.store;this.rowsPerPage=_7c1.length;var req={start:_7bf,count:this.rowsPerPage,isRender:_7c0};this._onFetchBegin(_7c1.length,req);var _7c3=0;_7a4.forEach(_7c1,function(i){if(!_7c2.isItemLoaded(i)){_7c3++;}});if(_7c3===0){this._onFetchComplete(_7c1,req);}else{var _7c4=function(item){_7c3--;if(_7c3===0){this._onFetchComplete(_7c1,req);}};_7a4.forEach(_7c1,function(i){if(!_7c2.isItemLoaded(i)){_7c2.loadItem({item:i,onItem:_7c4,scope:this});}},this);}}else{this.store.fetch({start:_7bf,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_7c0,onBegin:lang.hitch(this,"_onFetchBegin"),onComplete:lang.hitch(this,"_onFetchComplete"),onError:lang.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_7bf,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var data=this._by_idx[idx];if(!data||(data&&!data.item)){this._preparePage(idx);return null;}return data.item;},getItemIndex:function(item){return this._getItemIndex(item,false);},_getItemIndex:function(item,_7c5){if(!_7c5&&!this.store.isItem(item)){return -1;}var idty=this._hasIdentity?this.store.getIdentity(item):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((idty&&d.idty==idty)||(d.item===item))){return i;}}return -1;},filter:function(_7c6,_7c7){this.query=_7c6;if(_7c7){this._clearData();}this._fetch();},_getItemAttr:function(idx,attr){var item=this.getItem(idx);return (!item?this.fetchText:this.store.getValue(item,attr));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_7c8){return this._pending_requests[_7c8];},_rowToPage:function(_7c9){return (this.rowsPerPage?Math.floor(_7c9/this.rowsPerPage):_7c9);},_pageToRow:function(_7ca){return (this.rowsPerPage?this.rowsPerPage*_7ca:_7ca);},_preparePage:function(_7cb){if((_7cb<this._bop||_7cb>=this._eop)&&!this._addingItem){var _7cc=this._rowToPage(_7cb);this._needPage(_7cc);this._bop=_7cc*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_7cd){if(!this._pages[_7cd]){this._pages[_7cd]=true;this._requestPage(_7cd);}},_requestPage:function(_7ce){var row=this._pageToRow(_7ce);var _7cf=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_7cf>0){this._requests++;if(!this._requestsPending(row)){setTimeout(lang.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_7d0){return _7d0.field;},_refresh:function(_7d1){this._clearData();this._fetch(0,_7d1);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var desc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof desc=="undefined"){desc=si;}else{desc=si?!desc:desc;}return [{attribute:c.field,descending:desc}];}},styleRowState:function(_7d2){if(this.store&&this.store.getState){var _7d3=this.store.getState(_7d2.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_7d3[s]){c=" dojoxGridRow-"+s;break;}}_7d2.customClasses+=c;}},onStyleRow:function(_7d4){this.styleRowState(_7d4);this.inherited(arguments);},canEdit:function(_7d5,_7d6){return this._canEdit;},_copyAttr:function(idx,attr){var row={};var _7d7={};var src=this.getItem(idx);return this.store.getValue(src,attr);},doStartEdit:function(_7d8,_7d9){if(!this._cache[_7d9]){this._cache[_7d9]=this._copyAttr(_7d9,_7d8.field);}this.onStartEdit(_7d8,_7d9);},doApplyCellEdit:function(_7da,_7db,_7dc){this.store.fetchItemByIdentity({identity:this._by_idx[_7db].idty,onItem:lang.hitch(this,function(item){var _7dd=this.store.getValue(item,_7dc);if(typeof _7dd=="number"){_7da=isNaN(_7da)?_7da:parseFloat(_7da);}else{if(typeof _7dd=="boolean"){_7da=_7da=="true"?true:_7da=="false"?false:_7da;}else{if(_7dd instanceof Date){var _7de=new Date(_7da);_7da=isNaN(_7de.getTime())?_7da:_7de;}}}this.store.setValue(item,_7dc,_7da);this.onApplyCellEdit(_7da,_7db,_7dc);})});},doCancelEdit:function(_7df){var _7e0=this._cache[_7df];if(_7e0){this.updateRow(_7df);delete this._cache[_7df];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_7e1,_7e2){var _7e3=this._cache[_7e1];this.onApplyEdit(_7e1);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=lang.hitch(this,function(_7e4){if(_7e4.length){_7a4.forEach(_7e4,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_7a8.cell_markupFactory=function(_7e5,node,_7e6){var _7e7=lang.trim(html.attr(node,"field")||"");if(_7e7){_7e6.field=_7e7;}_7e6.field=_7e6.field||_7e6.name;var _7e8=lang.trim(html.attr(node,"fields")||"");if(_7e8){_7e6.fields=_7e8.split(",");}if(_7e5){_7e5(node,_7e6);}};_7a8.markupFactory=function(_7e9,node,ctor,_7ea){return _7a6.markupFactory(_7e9,node,ctor,lang.partial(_7a8.cell_markupFactory,_7ea));};return _7a8;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(lang,_7eb){var _7ec={};lang.setObject("dojo.date.stamp",_7ec);_7ec.fromISOString=function(_7ed,_7ee){if(!_7ec._isoRegExp){_7ec._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _7ef=_7ec._isoRegExp.exec(_7ed),_7f0=null;if(_7ef){_7ef.shift();if(_7ef[1]){_7ef[1]--;}if(_7ef[6]){_7ef[6]*=1000;}if(_7ee){_7ee=new Date(_7ee);_7eb.forEach(_7eb.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _7ee["get"+prop]();}),function(_7f1,_7f2){_7ef[_7f2]=_7ef[_7f2]||_7f1;});}_7f0=new Date(_7ef[0]||1970,_7ef[1]||0,_7ef[2]||1,_7ef[3]||0,_7ef[4]||0,_7ef[5]||0,_7ef[6]||0);if(_7ef[0]<100){_7f0.setFullYear(_7ef[0]||1970);}var _7f3=0,_7f4=_7ef[7]&&_7ef[7].charAt(0);if(_7f4!="Z"){_7f3=((_7ef[8]||0)*60)+(Number(_7ef[9])||0);if(_7f4!="-"){_7f3*=-1;}}if(_7f4){_7f3-=_7f0.getTimezoneOffset();}if(_7f3){_7f0.setTime(_7f0.getTime()+_7f3*60000);}}return _7f0;};_7ec.toISOString=function(_7f5,_7f6){var _7f7=function(n){return (n<10)?"0"+n:n;};_7f6=_7f6||{};var _7f8=[],_7f9=_7f6.zulu?"getUTC":"get",date="";if(_7f6.selector!="time"){var year=_7f5[_7f9+"FullYear"]();date=["0000".substr((year+"").length)+year,_7f7(_7f5[_7f9+"Month"]()+1),_7f7(_7f5[_7f9+"Date"]())].join("-");}_7f8.push(date);if(_7f6.selector!="date"){var time=[_7f7(_7f5[_7f9+"Hours"]()),_7f7(_7f5[_7f9+"Minutes"]()),_7f7(_7f5[_7f9+"Seconds"]())].join(":");var _7fa=_7f5[_7f9+"Milliseconds"]();if(_7f6.milliseconds){time+="."+(_7fa<100?"0":"")+_7f7(_7fa);}if(_7f6.zulu){time+="Z";}else{if(_7f6.selector!="time"){var _7fb=_7f5.getTimezoneOffset();var _7fc=Math.abs(_7fb);time+=(_7fb>0?"-":"+")+_7f7(Math.floor(_7fc/60))+":"+_7f7(_7fc%60);}}_7f8.push(time);}return _7f8.join("T");};return _7ec;});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_7fd,lang,_7fe,_7ff,_800,has,_801,util,html){return _7fe("dojox.grid._FocusManager",null,{constructor:function(_802){this.grid=_802;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_7ff.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_7ff.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_7ff.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_7ff.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_7ff.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_7ff.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_7ff.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_7ff.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_7ff.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_7fd.forEach(this._connects,_7ff.disconnect);_7fd.forEach(this._headerConnects,_7ff.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_803,_804){return (this.cell==_803)&&(this.rowIndex==_804);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _7fd.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_805){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){html.toggleClass(n,this.focusClass,_805);if(_805){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){html.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_7fd.forEach(this._headerConnects,_7ff.disconnect);this._headerConnects=[];var _806=this._findHeaderCells();for(var i=0;i<_806.length;i++){this._headerConnects.push(_7ff.connect(_806[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_7ff.connect(_806[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _807=_801("th",this.grid.viewsHeaderNode);var _808=[];for(var i=0;i<_807.length;i++){var _809=_807[i];var _80a=html.hasAttr(_809,"tabIndex");var _80b=html.attr(_809,"tabIndex");if(_80a&&_80b<0){_808.push(_809);}}return _808;},_setActiveColHeader:function(_80c,_80d,_80e){this.grid.domNode.setAttribute("aria-activedescendant",_80c.id);if(_80e!=null&&_80e>=0&&_80e!=_80d){html.toggleClass(this._findHeaderCells()[_80e],this.focusClass,false);}html.toggleClass(_80c,this.focusClass,true);this._colHeadNode=_80c;this._colHeadFocusIdx=_80d;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_80f){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_80f?_80f:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_810){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_810);if(!cell){return;}info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _811=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_811){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(has("ie")<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _812=this.focusView;if(!_812){for(var i=0,_813;(_813=this.grid.views.views[i]);i++){if(_813.headerNode){_812=_813;break;}}}return (_812&&html.getComputedStyle(_812.headerNode).display=="none");},colSizeAdjust:function(e,_814,_815){var _816=this._findHeaderCells();var view=this.focusView;if(!view||!view.header.tableMap.map){for(var i=0,_817;(_817=this.grid.views.views[i]);i++){if(_817.header.tableMap.map){view=_817;break;}}}var _818=_816[_814];if(!view||(_814==_816.length-1&&_814===0)){return;}view.content.baseDecorateEvent(e);e.cellNode=_818;e.cellIndex=view.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(view.header.canResize(e)){var _819={l:_815};var drag=view.header.colResizeSetup(e,false);view.header.doResizeColumn(drag,null,_819);view.update();}},styleRow:function(_81a){return;},setFocusIndex:function(_81b,_81c){this.setFocusCell(this.grid.getCell(_81c),_81b);},setFocusCell:function(_81d,_81e){if(_81d&&!this.isFocusCell(_81d,_81e)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_81d;this.rowIndex=_81e;this._focusifyCellNode(true);}if(has("opera")){setTimeout(lang.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _81f=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_81f.editable||this.grid.canEdit&&!this.grid.canEdit(_81f,row))){this.cell=_81f;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _820=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_820.editable){this.cell=_820;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_821,_822){var _823=_822<0?-1:1;if(this.isNavHeader()){var _824=this._findHeaderCells();var _825=currentIdx=_7fd.indexOf(_824,this._colHeadNode);currentIdx+=_822;while(currentIdx>=0&&currentIdx<_824.length&&_824[currentIdx].style.display=="none"){currentIdx+=_823;}if((currentIdx>=0)&&(currentIdx<_824.length)){this._setActiveColHeader(_824[currentIdx],currentIdx,_825);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_821));if(_821){if(_821>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_821<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_822));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_823;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_821){if((row+_821)>=0&&(row+_821)<=rc){this.move(_821>0?++_821:--_821,_822);}return;}else{if((!n||html.style(n,"display")==="none")&&_822){if((col+_822)>=0&&(col+_822)<=cc){this.move(_821,_822>0?++_822:--_822);}return;}}this.setFocusIndex(row,col);if(_821){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_800.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_800.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){html.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _826=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_800.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_800.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_827){this.tabbingOut=true;_827.focus();},focusGridView:function(){util.fire(this.focusView,"focus");},focusGrid:function(_828){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _829=true;var _82a=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_82a){var _82b=0;var cell=this.grid.getCell(_82b);if(cell.hidden){_82b=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_82b);}else{if(this.cell&&!_82a){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_829=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _829;},focusHeader:function(){var _82c=this._findHeaderCells();var _82d=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_82c[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_82c.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_82c[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_82d);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){html.removeClass(this._colHeadNode,this.focusClass);html.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _82e=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_82e);this._contextMenuBindNode=_82e;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_800.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_800.stop(e);},doBlur:function(e){_800.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_800.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_800.stop(e);},doLastNodeBlur:function(e){_800.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,html.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_800.stop(e);},doColHeaderBlur:function(e){html.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_82f,lang,has,_830,_831,_832,_833){var _834=_82f([_833],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_835){this.featureLayer=_835;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_836){var _837=this.featureLayer,_838=_837.objectIdField,oid=_836.attributes[_838];this._addFeatureIIf(oid,_836);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _839=this.featureLayer;if(_839._collection){_839._fireUpdateStart();_839._refresh(true);_839._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_83a){var id="_"+_83a.name+_83a.layerId+_83a._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _83b=this.featureLayer;if(_83b._collection){return;}_83b._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_83c=this.featureLayer,_83d=_83c.getDefinitionExpression();var _83e=new _832();_83e.outFields=_83c.getOutFields();_83e.where=_83d||"1=1";_83e.returnGeometry=true;_83e.outSpatialReference=new _831(map.spatialReference.toJson());_83e.timeExtent=_83c.getTimeDefinition();_83e.maxAllowableOffset=_83c._maxOffset;if(_83c._ts){_83e._ts=(new Date()).getTime();}var _83f;if(_83c._usePatch){_83f=this._getRequestId(_83c);this._cancelPendingRequest(null,_83f);}_83c._task.execute(_83e,this._drawFeatures,this._queryErrorHandler,_83f);},_drawFeatures:function(_840){this._purgeRequests();var _841=_840.features,_842=this.featureLayer,_843=_842.objectIdField,i,len=_841.length,_844,oid;for(i=0;i<len;i++){_844=_841[i];oid=_844.attributes[_843];this._addFeatureIIf(oid,_844);this._incRefCount(oid);}this._applyTimeFilter(true);_842._fireUpdateEnd(null,_840.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_840.exceededTransferLimit){_842.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _845=this.featureLayer;_845._errorHandler(err);_845._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_834,_830);}return _834;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_846,dom,_847,_848,_849,has,_84a,_84b,_84c,_84d,_84e){return _846("dijit.MenuItem",[_84a,_84b,_84c,_84d],{templateString:_84e,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_84f){if(_84f&&!("label" in this.params)){this.set("label",_84f.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _850=this.id+"_text";_847.set(this.containerNode,"id",_850);if(this.accelKeyNode){_847.set(this.accelKeyNode,"id",this.id+"_accel");_850+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_850);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_851){_848.toggle(this.domNode,"dijitMenuItemSelected",_851);},setLabel:function(_852){_849.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_852);},setDisabled:function(_853){_849.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_853);},_setDisabledAttr:function(_854){this.focusNode.setAttribute("aria-disabled",_854?"true":"false");this._set("disabled",_854);},_setAccelKeyAttr:function(_855){this.accelKeyNode.style.display=_855?"":"none";this.accelKeyNode.innerHTML=_855;_847.set(this.containerNode,"colSpan",_855?"1":"2");this._set("accelKey",_855);},_setTextDirAttr:function(_856){if(!this._created||this.textDir!=_856){this._set("textDir",_856);this.applyTextDir(this.focusNode,this.label);}}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","esri/tasks/SpatialRelationship":function(){define("esri/tasks/SpatialRelationship",["dojo/_base/lang","dojo/has","esri/kernel"],function(lang,has,_857){var _858={SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"};if(has("extend-esri")){lang.setObject("tasks._SpatialRelationship",_858,_857);}return _858;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_859,_85a,dom,_85b,_85c,lang,_85d,on,_85e,_85f,pm,_860,_861,_862,_863){return _85a("dijit._MenuBase",[_861,_863,_862],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _864=_860.byNode(node);return node.parentNode==this.containerNode&&_864&&_864.focus;},postCreate:function(){var self=this,_865=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_865,_85d.enter),function(){self.onItemHover(_860.byNode(this));}),on(this.containerNode,on.selector(_865,_85d.leave),function(){self.onItemUnhover(_860.byNode(this));}),on(this.containerNode,on.selector(_865,_85f),function(evt){self.onItemClick(_860.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _866=this._getTopMenu();if(_866&&_866._isMenuBar){_866.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _867=this.currentPopup.parentMenu;if(_867.focusedChild){_867.focusedChild._setSelected(false);}_867.focusedChild=this.currentPopup.from_item;_867.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _868=item.popup;if(_868){this._stopPendingCloseTimer(_868);_868._pendingClose_timer=this.defer(function(){_868._pendingClose_timer=null;if(_868.parentMenu){_868.parentMenu.currentPopup=null;}pm.close(_868);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_869){if(_869._pendingClose_timer){_869._pendingClose_timer=_869._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_86a){this._stopPopupTimer();var _86b=this.focusedChild;if(!_86b){return;}var _86c=_86b.popup;if(!_86c.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_86c.parentMenu=this;_86c.from_item=_86b;var self=this;pm.open({parent:this,popup:_86c,around:_86b.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_86b);self._cleanUp();_86b._setSelected(true);self.focusedChild=_86b;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_86c;_86c.connect(_86c.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_86a&&_86c.focus){_86c._focus_timer=this.defer(lang.hitch(_86c,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_85c.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_85c.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_859.indexOf(this._focusManager.activeStack,this.id)>=0){_85b.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dijit/_TemplatedMixin":function(){define("dijit/_TemplatedMixin",["dojo/_base/lang","dojo/touch","./_WidgetBase","dojo/string","dojo/cache","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/sniff","dojo/_base/unload"],function(lang,_86d,_86e,_86f,_870,_871,_872,_873,has,_874){var _875=_872("dijit._TemplatedMixin",null,{templateString:null,templatePath:null,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(tmpl){var _876=this.declaredClass,_877=this;return _86f.substitute(tmpl,this,function(_878,key){if(key.charAt(0)=="!"){_878=lang.getObject(key.substr(1),false,_877);}if(typeof _878=="undefined"){throw new Error(_876+" template:"+key);}if(_878==null){return "";}return key.charAt(0)=="!"?_878:_878.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){if(!this.templateString){this.templateString=_870(this.templatePath,{sanitize:true});}var _879=_875.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument);var node;if(lang.isString(_879)){node=_873.toDom(this._stringRepl(_879),this.ownerDocument);if(node.nodeType!=1){throw new Error("Invalid template: "+_879);}}else{node=_879.cloneNode(true);}this.domNode=node;this.inherited(arguments);this._attachTemplateNodes(node,function(n,p){return n.getAttribute(p);});this._beforeFillContent();this._fillContent(this.srcNodeRef);},_beforeFillContent:function(){},_fillContent:function(_87a){var dest=this.containerNode;if(_87a&&dest){while(_87a.hasChildNodes()){dest.appendChild(_87a.firstChild);}}},_attachTemplateNodes:function(_87b,_87c){var _87d=lang.isArray(_87b)?_87b:(_87b.all||_87b.getElementsByTagName("*"));var x=lang.isArray(_87b)?0:-1;for(;x<0||_87d[x];x++){var _87e=(x==-1)?_87b:_87d[x];if(this.widgetsInTemplate&&(_87c(_87e,"dojoType")||_87c(_87e,"data-dojo-type"))){continue;}var _87f=_87c(_87e,"dojoAttachPoint")||_87c(_87e,"data-dojo-attach-point");if(_87f){var _880,_881=_87f.split(/\s*,\s*/);while((_880=_881.shift())){if(lang.isArray(this[_880])){this[_880].push(_87e);}else{this[_880]=_87e;}this._attachPoints.push(_880);}}var _882=_87c(_87e,"dojoAttachEvent")||_87c(_87e,"data-dojo-attach-event");if(_882){var _883,_884=_882.split(/\s*,\s*/);var trim=lang.trim;while((_883=_884.shift())){if(_883){var _885=null;if(_883.indexOf(":")!=-1){var _886=_883.split(":");_883=trim(_886[0]);_885=trim(_886[1]);}else{_883=trim(_883);}if(!_885){_885=_883;}this._attachEvents.push(this.connect(_87e,_86d[_883]||_883,_885));}}}}},destroyRendering:function(){_871.forEach(this._attachPoints,function(_887){delete this[_887];},this);this._attachPoints=[];_871.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});_875._templateCache={};_875.getCachedTemplate=function(_888,_889,doc){var _88a=_875._templateCache;var key=_888;var _88b=_88a[key];if(_88b){try{if(!_88b.ownerDocument||_88b.ownerDocument==(doc||document)){return _88b;}}catch(e){}_873.destroy(_88b);}_888=_86f.trim(_888);if(_889||_888.match(/\$\{([^\}]+)\}/g)){return (_88a[key]=_888);}else{var node=_873.toDom(_888,doc);if(node.nodeType!=1){throw new Error("Invalid template: "+_888);}return (_88a[key]=node);}};if(has("ie")){_874.addOnWindowUnload(function(){var _88c=_875._templateCache;for(var key in _88c){var _88d=_88c[key];if(typeof _88d=="object"){_873.destroy(_88d);}delete _88c[key];}});}lang.extend(_86e,{dojoAttachEvent:"",dojoAttachPoint:""});return _875;});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_88e,_88f,lang,_890,html,_891,_892,_893,has,_894,_895,_896,_897,_898,_899,_89a,_89b,_89c,_89d,gfx,_89e,_89f,_8a0,_8a1,_8a2,_8a3,_8a4,_8a5){var TP=_88f([_89a,_89b],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_8a5,basePath:_88e.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_8a6,_8a7){_8a6=_8a6||{};if(!_8a6.items&&!_8a6.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_893.version.minor>=4);this._itemWidgets={};if(_8a6.featureLayers&&_8a6.featureLayers.length){this._flChanged=1;}this._nls=_8a4.widgets.templatePicker;this.emptyMessage=_8a6.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_898.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_898.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_890.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _8a8=this._selectedCell,info=this._selectedInfo;if(_8a8){this._rowClicked({cellNode:_8a8,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_8a9){var _8aa=(this.rows==="auto"&&this.columns==="auto"&&_8a9)?true:false,grid=this.grid,box;if(_8aa){var _8ab=this.domNode,id=_8ab.id,_8ac,item=_893.query("#"+id+".templatePicker div.item")[0];box=_898.getContentBox(_8ab);item=item&&item.parentNode;if(item){_8ac=html.coords(item).w;}else{_8ac=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_8ac);this._columns=this._columns||1;}var _8ad=this._rows;this._preprocess();var _8ae=this._rows;this._setGridLayout();this._setGridData();if(_8ae!==_8ad){grid.set("autoHeight",this._rows,false);}if(_8aa){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_8af=this.getSelected();if(_8af){grid.store.fetch({onComplete:function(its){var _8b0=self._locate(_8af,self._selectedInfo,its);var _8b1=_8b0&&grid.views.views[0].getCellNode(_8b0[0],_8b0[1]);if(_8b1){self._rowClicked({cellNode:_8b1,rowIndex:_8b0[0],cellIndex:_8b0[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _8b2=this.featureLayers,_8b3=this.items;if((!_8b2||!_8b2.length)&&(!_8b3||!_8b3.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _8b4=this.useLegend;if(!this._started||_8b4!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_8b5){var _8b6=this.featureLayers;if(!this._started||_8b6!==_8b5){this._flChanged=1;}this.featureLayers=_8b5;},_adjustRowsCols:function(_8b7){if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_8b7.length;_891.forEach(_8b7,function(_8b8){len+=Math.ceil(_8b8.length/this.columns);},this);}else{_891.forEach(_8b7,function(_8b9){len+=_8b9.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_8b7.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{_891.forEach(_8b7,function(_8ba){len+=_8ba.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_8b7.length/this.rows);}this._columns=len;}}},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _8bb;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}if(_891.every(this.featureLayers,function(_8bc){return _8bc.loaded;})){_8bb=this._flItems=this._getItemsFromLayers(this.featureLayers);this._adjustRowsCols(_8bb);}else{var _8bd=this.featureLayers.length;var _8be=[];_891.forEach(this.featureLayers,function(_8bf){if(_8bf.loaded){_8bd--;_8be.push(_8bf);}else{var _8c0=_890.connect(_8bf,"onLoad",this,function(_8c1){_890.disconnect(_8c0);_8c0=null;_8bd--;_8be.push(_8c1);if(!_8bd){_8bb=this._flItems=this._getItemsFromLayers(_8be);this._adjustRowsCols(_8bb);this.update();}});}},this);}}else{_8bb=this._itItems=this._getItemsFromItems(this.items);this._adjustRowsCols(_8bb);}},_processSelectionLayers:function(){var map,_8c2,info,_8c3,key,_8c4,_8c5,_8c6={};_891.forEach(this.featureLayers,function(_8c7,idx){if(_8c7.mode===_89e.MODE_SELECTION&&_8c7._map&&_8c7.url&&_8c7._params.drawMode&&!_8c7.source){_8c2=lang.trim(_8c7._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_8c6[_8c2]=_8c6[_8c2]||{});_8c3=(info.featureLayers=info.featureLayers||{});_8c4=(info.indices=info.indices||[]);_8c3[idx]=_8c7;_8c4.push(idx);map=_8c7._map;}});if(map){_891.forEach(map.layerIds,function(_8c8){_8c8=map.getLayer(_8c8);if(_8c8&&_8c8.url&&(_8c8.getImageUrl||_8c8.getTileUrl)&&_8c8.loaded&&_8c8.version>=10.1){_8c2=lang.trim(_8c8._url.path).replace(/(\/MapServer).*/ig,"$1");key=_8c2.replace(/^https?:\/\//ig,"").toLowerCase();if(_8c6[key]&&(!_8c6[key].mapServiceUrl)){info=_8c6[key];info.mapServiceUrl=_8c2;info.mapServiceLayer=_8c8;this._legendIndices=this._legendIndices.concat(info.indices);_8c5=this._fetchLegend({pickerInstance:this,info:info},key);if(_8c5.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_8c5);}else{this._processLegendResponse(_8c5,info);}}}},this);}},_fetchLegend:function(_8c9,key){var _8ca=TP.prototype,_8cb=_8ca.legendCache[key];if(!_8cb){_8cb=(_8ca.legendCache[key]=_8a3({url:_8c9.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_8cb._contexts=[_8c9];_8cb.addBoth(function(_8cc){if(_8cb.canceled){return;}_8ca.legendCache[key]=_8cc;var _8cd=_8cb._contexts;_8cb._contexts=null;_891.forEach(_8cd,function(ctxt){var _8ce=ctxt.pickerInstance,info=ctxt.info,_8cf;if(_8ce._destroyed){return;}_891.forEach(info.indices,function(idx){_8cf=_891.indexOf(_8ce._loadingIndices,idx);if(_8cf>-1){_8ce._loadingIndices.splice(_8cf,1);}});_8cf=_891.indexOf(_8ce._loadingLegends,_8cb);if(_8cf>-1){_8ce._loadingLegends.splice(_8cf,1);}_8ce._processLegendResponse(_8cc,info);});});}else{if(_8cb.then){_8cb._contexts.push(_8c9);}}return _8cb;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){_891.forEach(this._loadingLegends,function(_8d0){var _8d1=-1;_891.some(_8d0._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_8d1=idx;}return (_8d1>-1);},this);if(_8d1>-1){_8d0._contexts.splice(_8d1,1);}},this);}},_processLegendResponse:function(_8d2,info){if(_8d2&&!(_8d2 instanceof Error)){_891.forEach(info.indices,function(idx){var _8d3=info.featureLayers[idx].layerId,i,_8d4=info.mapServiceUrl+"/"+_8d3+"/images/",_8d5=info.mapServiceLayer._getToken(),_8d6,obj,_8d7,url;if(this._legendSymbols[idx]){return;}_8d6=null;_891.some(_8d2.layers,function(_8d8){if(_8d8.layerId==_8d3){_8d6=_8d8;}return !!_8d6;});if(_8d6){obj=(this._legendSymbols[idx]={});_891.forEach(_8d6.legend,function(_8d9){_8d7=_8d9.values;if(_8d7&&_8d7.length){for(i=0;i<_8d7.length;i++){obj[_8d7[i]]=_8d9;}}else{obj.defaultSymbol=_8d9;}url=_8d9.url;if(url&&!_8d9._fixed){_8d9._fixed=1;if((url.search(/https?\:/)===-1)){_8d9.url=_8d4+url;}if(_8d5&&_8d9.url.search(/https?\:/)!==-1){_8d9.url+=(((_8d9.url.indexOf("?")>-1)?"&":"?")+"token="+_8d5);}}});}},this);}else{var _8da;_891.forEach(info.indices,function(idx){_8da=_891.indexOf(this._legendIndices,idx);if(_8da>-1){this._legendIndices.splice(_8da,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _8db=grid.adaptWidth,_8dc,i,view;grid.adaptWidth=function(){_8dc=this.views.views;for(i=0;view=_8dc[i];i++){_899.set(view.headerNode,"display","block");}_8db.apply(this,arguments);for(i=0;view=_8dc[i];i++){_899.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _8dd=_890.connect(grid,"_onFetchComplete",this,function(){_890.disconnect(_8dd);this.grid.set("autoHeight",this._rows);});}_890.connect(grid,"_onDelete",this,this._destroyItems);_890.connect(grid,"_clearData",this,this._destroyItems);_890.connect(grid,"destroy",this,this._destroyItems);var _8de=grid.focus;if(_8de&&_8de.findAndFocusGridCell){_8de.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _8df=function(_8e0){return function(_8e1,_8e2){return this._cellGet(_8e0,_8e1,_8e2);};};var _8e3=lang.hitch(this,this._cellFormatter),_8e4=[],cols=this._columns,i;for(i=0;i<cols;i++){_8e4.push({field:"cell"+i,get:lang.hitch(this,_8df(i)),formatter:_8e3});}var _8e5={cells:[_8e4]};if(this.grouping){var _8e6={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_8e5.cells.push([_8e6]);}var grid=this.grid,_8e7=_89d.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_8e7)?this._rows:_8e7);grid.set("structure",_8e5);},_setGridData:function(){var _8e8=[];if(this.grouping){this._groupRowIndices=[];var _8e9,_8ea,cols=this._columns;_891.forEach(this._flItems,function(_8eb,idx){_8e8.push({});var _8ec=(idx===0)?0:(_8e9+_8ea+1);this._groupRowIndices.push(_8ec);_8e9=_8ec;_8ea=Math.ceil(_8eb.length/cols);_8e8=_8e8.concat(this._getStoreItems(_8eb));},this);}else{if(this.featureLayers){_891.forEach(this._flItems,function(_8ed){_8e8=_8e8.concat(_8ed);});_8e8=this._getStoreItems(_8e8);}else{_8e8=this._getStoreItems(this._itItems);}}var _8ee=new _89c({data:{items:_8e8}});this.grid.setStore(_8ee);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_897.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_890.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_890.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_890.disconnect(this._mouseOverConnect);_890.disconnect(this._mouseOutConnect);_897.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_8ef){var _8f0=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_8f0,row,col);if(!cell){return;}var _8f1=this.grid.store;if(_8f1.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_896.remove(this._selectedCell,"selectedItem");}if(_8f0!==this._selectedCell){_896.add(_8f0,"selectedItem");this._selectedCell=_8f0;this._selectedItem={featureLayer:_8f1.getValue(cell,"layer"),type:_8f1.getValue(cell,"type"),template:_8f1.getValue(cell,"template"),symbolInfo:_8f1.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_8f1.getValue(cell,"index1"),index2:_8f1.getValue(cell,"index2"),index:_8f1.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_8ef){this.onSelectionChange();}},_locate:function(_8f2,info,_8f3){var _8f4=this.grid.store,cols=new Array(this._columns);var _8f5,_8f6=info.index1,_8f7=info.index2,_8f8=info.index,item=_8f2.item;_891.some(_8f3,function(_8f9,_8fa){return _891.some(cols,function(_8fb,_8fc){var cell=_8f4.getValue(_8f9,"cell"+_8fc);if(cell&&(item?(_8f8===_8f4.getValue(cell,"index")):(_8f6===_8f4.getValue(cell,"index1")&&_8f7===_8f4.getValue(cell,"index2")))){_8f5=[_8fa,_8fc];return true;}else{return false;}});});return _8f5;},_getCellInfo:function(_8fd,row,col){if(!_8fd){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _8fe=this.items;if(_8fe){return _8fe[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _8ff=this.tooltip;var _900=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_900,row,col);if(_8ff&&cell){var _901=this.grid.store;var _902=_901.getValue(cell,"template");var type=_901.getValue(cell,"type");var _903=_901.getValue(cell,"symbolInfo");var _904=_901.getValue(cell,"layer");var item=this._getItem(cell);var _905=(item&&(item.label+(item.description?(": "+item.description):"")))||(_902&&(_902.name+(_902.description?(": "+_902.description):"")))||(type&&type.name)||(_903&&(_903.label+(_903.description?(": "+_903.description):"")))||((_904&&_904.name+": ")+"Default");_8ff.style.display="none";_8ff.innerHTML=_905;var _906=html.coords(_900.firstChild);_899.set(_8ff,{left:(_906.x)+"px",top:(_906.y+_906.h+5)+"px"});_8ff.style.display="";}},_cellMouseOut:function(){var _907=this.tooltip;if(_907){_907.style.display="none";}},_destroyItems:function(){var _908=this._itemWidgets,w;for(w in _908){if(!_908[w]){continue;}_908[w].destroy();delete _908[w];}},_repaintItems:function(){var _909=this._itemWidgets,w;for(w in _909){var _90a=_909[w];if(_90a){_90a._repaint(_90a._surface);}}},_getStoreItems:function(_90b){var uid=this._uniqueId;_90b=_891.map(_90b,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_90b.length,_90c=0,obj={},k=0,prop,_90d=[],flag=true,cols=this._columns;while(_90c<len){flag=true;prop="cell"+k;obj[prop]=_90b[_90c];_90c++;k++;if(k%cols===0){flag=false;_90d.push(obj);obj={};k=0;}}if(flag&&len){_90d.push(obj);}return _90d;},_getItemsFromLayers:function(_90e){var _90f=[];_891.forEach(_90e,function(_910,_911){_90f.push(this._getItemsFromLayer(_910,_911));},this);return _90f;},_getItemsFromLayer:function(_912,_913){var _914=[];if(this.useLegend&&_891.indexOf(this._loadingIndices,_913)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_912,type:null,template:null,index1:_913,index2:0,loadingCell:1}];}var _915=[];_915=_915.concat(_912.templates);_891.forEach(_912.types,function(_916){var _917=_916.templates;_891.forEach(_917,function(_918){_918._type_=_916;});_915=_915.concat(_917);});_915=_891.filter(_915,_8a2.isDefined);var _919=_912.renderer;if(_919){var _91a=_919.declaredClass.replace("esri.renderer.","");if(_915.length>0){_891.forEach(_915,function(_91b){var _91c=_91b.prototype;if(_91c){var _91d=_919.getSymbol(_91c);if(_91d){var _91e=null,pms,_91f;if(this.useLegend&&_891.indexOf(this._legendIndices,_913)>-1){_91f=this._legendSymbols&&this._legendSymbols[_913];if(_91f){switch(_91a){case "SimpleRenderer":_91e=_91f.defaultSymbol;break;case "UniqueValueRenderer":_891.some(_919.infos,function(info){if(info.symbol===_91d){_91e=_91f[info.value];}return !!_91e;});break;case "ClassBreaksRenderer":_891.some(_919.infos,function(info){if(info.symbol===_91d){_91e=_91f[info.maxValue];}return !!_91e;});break;}}if(_91e){pms=_892.fromJson(_892.toJson(_89f.defaultProps));pms.url=_91e.url;pms.imageData=_91e.imageData;pms.contentType=_91e.contentType;pms.width=_91e.width;pms.height=_91e.height;if(!_8a2.isDefined(pms.width)||!_8a2.isDefined(pms.height)){pms.width=15;pms.height=15;}_91e=new _89f(pms);}}_914.push({label:this._trimLabel(_91b.name),symbol:_91e||_91d,legendOverride:!!_91e,layer:_912,type:_91b._type_,template:_91b,index1:_913,index2:_914.length});}}delete _91b._type_;},this);}else{var _920=[];if(_91a==="TemporalRenderer"){_919=_919.observationRenderer;if(_919){_91a=_919.declaredClass.replace("esri.renderer.","");}}switch(_91a){case "SimpleRenderer":_920=[{symbol:_919.symbol,label:_919.label,description:_919.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_920=_919.infos;break;}_914=_891.map(_920,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_912,index1:_913,index2:idx};},this);}}return _914;},_getItemsFromItems:function(_921){return _891.map(_921,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_922){var max=this.maxLabelLength;if(max&&_922){if(_922.length>max){_922=_922.substr(0,max)+"...";}}return _922||"";},_cellGet:function(_923,_924,_925){if(!_925){return "";}return this.grid.store.getValue(_925,"cell"+_923);},_cellFormatter:function(_926){if(_926){var _927=this._itemWidgets,_928=this.grid.store;var sid=_928.getValue(_926,"surfaceId");var w=_927[sid];if(!w){w=(_927[sid]=new _8a0({id:sid,label:_928.getValue(_926,"label"),symbol:_928.getValue(_926,"symbol"),legendOverride:_928.getValue(_926,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_928.getValue(_926,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_929,_92a){if(!this._groupRowIndices){return "";}var _92b=_891.indexOf(this._groupRowIndices,_929);if(!_92a||_92b===-1){return "";}return (this.featureLayers[_92b]&&this.featureLayers[_92b].name)||"";},_cellGroupFormatter:function(_92c){if(_92c){return "<div class='groupLabel'>"+_92c+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_8a1);}return TP;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_92d,lang,_92e,_92f,xhr,_930,_931,_932,_933){var _934=_92e("dojo.data.ItemFileReadStore",[_930],{constructor:function(_935){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_935.url;this._ccUrl=_935.url;this.url=_935.url;this._jsonData=_935.data;this.data=null;this._datatypeMap=_935.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_936){return _933.fromISOString(_936);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_935.urlPreventCache!==undefined){this.urlPreventCache=_935.urlPreventCache?true:false;}if(_935.hierarchical!==undefined){this.hierarchical=_935.hierarchical?true:false;}if(_935.clearOnClose){this.clearOnClose=true;}if("failOk" in _935){this.failOk=_935.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_937){if(typeof _937!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_938,_939){var _93a=this.getValues(item,_938);return (_93a.length>0)?_93a[0]:_939;},getValues:function(item,_93b){this._assertIsItem(item);this._assertIsAttribute(_93b);return (item[_93b]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _93c=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_93c.push(key);}}return _93c;},hasAttribute:function(item,_93d){this._assertIsItem(item);this._assertIsAttribute(_93d);return (_93d in item);},containsValue:function(item,_93e,_93f){var _940=undefined;if(typeof _93f==="string"){_940=_931.patternToRegExp(_93f,false);}return this._containsValue(item,_93e,_93f,_940);},_containsValue:function(item,_941,_942,_943){return _92f.some(this.getValues(item,_941),function(_944){if(_944!==null&&!lang.isObject(_944)&&_943){if(_944.toString().match(_943)){return true;}}else{if(_942===_944){return true;}}});},isItem:function(_945){if(_945&&_945[this._storeRefPropName]===this){if(this._arrayOfAllItems[_945[this._itemNumPropName]]===_945){return true;}}return false;},isItemLoaded:function(_946){return this.isItem(_946);},loadItem:function(_947){this._assertIsItem(_947.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_948,_949,_94a){var _94b=[],i,key;if(_948.query){var _94c,_94d=_948.queryOptions?_948.queryOptions.ignoreCase:false;var _94e={};for(key in _948.query){_94c=_948.query[key];if(typeof _94c==="string"){_94e[key]=_931.patternToRegExp(_94c,_94d);}else{if(_94c instanceof RegExp){_94e[key]=_94c;}}}for(i=0;i<_949.length;++i){var _94f=true;var _950=_949[i];if(_950===null){_94f=false;}else{for(key in _948.query){_94c=_948.query[key];if(!this._containsValue(_950,key,_94c,_94e[key])){_94f=false;}}}if(_94f){_94b.push(_950);}}_94a(_94b,_948);}else{for(i=0;i<_949.length;++i){var item=_949[i];if(item!==null){_94b.push(item);}}_94a(_94b,_948);}},_fetchItems:function(_951,_952,_953){var self=this;if(this._loadFinished){this.filter(_951,this._getItemsArray(_951.queryOptions),_952);}else{if(this._jsonFileUrl!==this._ccUrl){_92d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_951,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_952)});}else{this._loadInProgress=true;var _954={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _955=xhr.get(_954);_955.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_951,self._getItemsArray(_951.queryOptions),_952);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_953(e,_951);}});_955.addErrback(function(_956){self._loadInProgress=false;_953(_956,_951);});var _957=null;if(_951.abort){_957=_951.abort;}_951.abort=function(){var df=_955;if(df&&df.fired===-1){df.cancel();df=null;}if(_957){_957.call(_951);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_951,this._getItemsArray(_951.queryOptions),_952);}catch(e){_953(e,_951);}}else{_953(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_951);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _958=this._queuedFetches[i],_959=_958.args,_95a=_958.filter,_95b=_958.findCallback;if(_95a){_95a(_959,this._getItemsArray(_959.queryOptions),_95b);}else{this.fetchItemByIdentity(_959);}}this._queuedFetches=[];}},_getItemsArray:function(_95c){if(_95c&&_95c.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_95d){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_95e){var _95f=false,self=this;function _960(_961){return (_961!==null)&&(typeof _961==="object")&&(!lang.isArray(_961)||_95f)&&(!lang.isFunction(_961))&&(_961.constructor==Object||lang.isArray(_961))&&(typeof _961._reference==="undefined")&&(typeof _961._type==="undefined")&&(typeof _961._value==="undefined")&&self.hierarchical;};function _962(_963){self._arrayOfAllItems.push(_963);for(var _964 in _963){var _965=_963[_964];if(_965){if(lang.isArray(_965)){var _966=_965;for(var k=0;k<_966.length;++k){var _967=_966[k];if(_960(_967)){_962(_967);}}}else{if(_960(_965)){_962(_965);}}}}};this._labelAttr=_95e.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_95e.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_95f=true;}_962(item);item[this._rootItemPropName]=true;}var _968={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _969=item[key];if(_969!==null){if(!lang.isArray(_969)){item[key]=[_969];}}else{item[key]=[null];}}_968[key]=key;}}while(_968[this._storeRefPropName]){this._storeRefPropName+="_";}while(_968[this._itemNumPropName]){this._itemNumPropName+="_";}while(_968[this._reverseRefMap]){this._reverseRefMap+="_";}var _96a;var _96b=_95e.identifier;if(_96b){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_96b;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_96a=item[_96b];var _96c=_96a[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_96c)){this._itemsByIdentity[_96c]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_96b+"].  Value collided: ["+_96c+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_96b+"].  Value collided: ["+_96c+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_96a=item[key];for(var j=0;j<_96a.length;++j){_969=_96a[j];if(_969!==null&&typeof _969=="object"){if(("_type" in _969)&&("_value" in _969)){var type=_969._type;var _96d=this._datatypeMap[type];if(!_96d){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_96d)){_96a[j]=new _96d(_969._value);}else{if(lang.isFunction(_96d.deserialize)){_96a[j]=_96d.deserialize(_969._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_969._reference){var _96e=_969._reference;if(!lang.isObject(_96e)){_96a[j]=this._getItemByIdentity(_96e);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _96f=this._arrayOfAllItems[k],_970=true;for(var _971 in _96e){if(_96f[_971]!=_96e[_971]){_970=false;}}if(_970){_96a[j]=_96f;}}}if(this.referenceIntegrity){var _972=_96a[j];if(this.isItem(_972)){this._addReferenceToMap(_972,item,key);}}}else{if(this.isItem(_969)){if(this.referenceIntegrity){this._addReferenceToMap(_969,item,key);}}}}}}}},_addReferenceToMap:function(_973,_974,_975){},getIdentity:function(item){var _976=this._features["dojo.data.api.Identity"];if(_976===Number){return item[this._itemNumPropName];}else{var _977=item[_976];if(_977){return _977[0];}}return null;},fetchItemByIdentity:function(_978){var item,_979;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_92d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_978});}else{this._loadInProgress=true;var _97a={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _97b=xhr.get(_97a);_97b.addCallback(function(data){var _97c=_978.scope?_978.scope:_92d.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_978.identity);if(_978.onItem){_978.onItem.call(_97c,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_978.onError){_978.onError.call(_97c,error);}}});_97b.addErrback(function(_97d){self._loadInProgress=false;if(_978.onError){var _97e=_978.scope?_978.scope:_92d.global;_978.onError.call(_97e,_97d);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_978.identity);if(_978.onItem){_979=_978.scope?_978.scope:_92d.global;_978.onItem.call(_979,item);}}}}else{item=this._getItemByIdentity(_978.identity);if(_978.onItem){_979=_978.scope?_978.scope:_92d.global;_978.onItem.call(_979,item);}}},_getItemByIdentity:function(_97f){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_97f)){item=this._itemsByIdentity[_97f];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_97f)){item=this._arrayOfAllItems[_97f];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _980=this._features["dojo.data.api.Identity"];if(_980===Number){return null;}else{return [_980];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_92d.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _981={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _982=xhr.get(_981);_982.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_982.addErrback(function(_983){throw _983;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_934,_932);return _934;});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_984,_985,lang,_986){return _984("dojox.grid._SelectionPreserver",null,{constructor:function(_987){this.selection=_987;var grid=this.grid=_987.grid;this.reset();this._connects=[_985.connect(grid,"_setStore",this,"reset"),_985.connect(grid,"_addItem",this,"_reSelectById"),_985.connect(_987,"onSelected",lang.hitch(this,"_selectById",true)),_985.connect(_987,"onDeselected",lang.hitch(this,"_selectById",false)),_985.connect(_987,"deselectAll",this,"reset")];},destroy:function(){this.reset();_986.forEach(this._connects,_985.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_988){if(item&&this.grid._hasIdentity){this.selection.selected[_988]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_989,_98a){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_98a,g=this.grid;if(typeof _98a=="number"||typeof _98a=="string"){var _98b=g._by_idx[_98a];item=_98b&&_98b.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_989;}return item;}});});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_98c,_98d){var _98e={};lang.setObject("dojo.data.util.simpleFetch",_98e);_98e.errorHandler=function(_98f,_990){if(_990.onError){var _991=_990.scope||_98c.global;_990.onError.call(_991,_98f,_990);}};_98e.fetchHandler=function(_992,_993){var _994=_993.abort||null,_995=false,_996=_993.start?_993.start:0,_997=(_993.count&&(_993.count!==Infinity))?(_996+_993.count):_992.length;_993.abort=function(){_995=true;if(_994){_994.call(_993);}};var _998=_993.scope||_98c.global;if(!_993.store){_993.store=this;}if(_993.onBegin){_993.onBegin.call(_998,_992.length,_993);}if(_993.sort){_992.sort(_98d.createSortFunction(_993.sort,this));}if(_993.onItem){for(var i=_996;(i<_992.length)&&(i<_997);++i){var item=_992[i];if(!_995){_993.onItem.call(_998,item,_993);}}}if(_993.onComplete&&!_995){var _999=null;if(!_993.onItem){_999=_992.slice(_996,_997);}_993.onComplete.call(_998,_999,_993);}};_98e.fetch=function(_99a){_99a=_99a||{};if(!_99a.store){_99a.store=this;}this._fetchItems(_99a,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _99a;};return _98e;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_99b,_99c,lang,win,_99d,has,_99e,_99f,_9a0,util,html){var dg=_99b.grid;var _9a1=function(td){return td.cellIndex>=0?td.cellIndex:_99c.indexOf(td.parentNode.cells,td);};var _9a2=function(tr){return tr.rowIndex>=0?tr.rowIndex:_99c.indexOf(tr.parentNode.childNodes,tr);};var _9a3=function(_9a4,_9a5){return _9a4&&((_9a4.rows||0)[_9a5]||_9a4.childNodes[_9a5]);};var _9a6=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _9a7=function(_9a8,_9a9){for(var n=_9a8;n&&_9a9(n);n=n.parentNode){}return n;};var _9aa=function(_9ab){var name=_9ab.toUpperCase();return function(node){return node.tagName!=name;};};var _9ac=util.rowIndexTag;var _9ad=util.gridViewTag;var _9ae=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_9af,_9b0,_9b1,_9b2){var _9b3=[],html;if(_9b2){var _9b4=_9af.index!=_9af.grid.getSortIndex()?"":_9af.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_9af.id){_9af.id=this.grid.id+"Hdr"+_9af.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_9b4,"id=\"",_9af.id,"\""];}else{var _9b5=this.grid.editable&&!_9af.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_9b5];}if(_9af.colSpan){html.push(" colspan=\"",_9af.colSpan,"\"");}if(_9af.rowSpan){html.push(" rowspan=\"",_9af.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_9af.classes){html.push(_9af.classes," ");}if(_9b1){html.push(_9b1," ");}_9b3.push(html.join(""));_9b3.push("");html=["\" idx=\"",_9af.index,"\" style=\""];if(_9b0&&_9b0[_9b0.length-1]!=";"){_9b0+=";";}html.push(_9af.styles,_9b0||"",_9af.hidden?"display:none;":"");if(_9af.unitWidth){html.push("width:",_9af.unitWidth,";");}_9b3.push(html.join(""));_9b3.push("");html=["\""];if(_9af.attrs){html.push(" ",_9af.attrs);}html.push(">");_9b3.push(html.join(""));_9b3.push("");_9b3.push(_9b2?"</th>":"</td>");return _9b3;},isCellNode:function(_9b6){return Boolean(_9b6&&_9b6!=win.doc&&html.attr(_9b6,"idx"));},getCellNodeIndex:function(_9b7){return _9b7?Number(html.attr(_9b7,"idx")):-1;},getCellNode:function(_9b8,_9b9){for(var i=0,row;((row=_9a3(_9b8.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_9b9){return cell;}}}return null;},findCellTarget:function(_9ba,_9bb){var n=_9ba;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_9ad in n.offsetParent.parentNode&&n.offsetParent.parentNode[_9ad]!=this.view.id))&&(n!=_9bb)){n=n.parentNode;}return n!=_9bb?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_9bc,_9bd){var n=_9bc;while(n&&(n!=this.domNode)&&(!(_9bd in n)||(_9ad in n&&n[_9ad]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_9be){return this.findTarget(_9be,_9ac);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _9bf=dg._ContentBuilder=lang.extend(function(view){_9ae.call(this,view);},_9ae.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _9c0=this.grid.get,_9c1=this.view.structure.cells;for(var j=0,row;(row=_9c1[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_9c0;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_9c2,_9c3){var html=this.getTableArray(),v=this.view,_9c4=v.structure.cells,item=this.grid.getItem(_9c3);util.fire(this.view,"onBeforeRow",[_9c3,_9c4]);for(var j=0,row;(row=_9c4[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_9c3,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_9ac];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _9c5=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_9ae.call(this,view);},_9ae.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_9c6,_9c7){var html=this.getTableArray(),_9c8=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_9c8]);for(var j=0,row;(row=_9c8[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_9c9;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_9c9=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_9c9[5]=(_9c7!=undefined?_9c7:_9c6(cell));_9c9[3]=cell.customStyles.join(";");_9c9[1]=cell.customClasses.join(" ");html.push(_9c9.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_9a7(e.target,_9aa("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_9a7(n,_9aa("table"));x-=(table&&table.offsetLeft)||0;}}n=_9a7(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_99d.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_99d.stop(e);return true;}return false;},colResizeSetup:function(e,_9ca){var _9cb=html.contentBox(e.sourceView.headerNode);if(_9ca){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _9cc=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_9a0.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_9cc.h+_9cb.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _9cd=[],_9ce=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_9ce[i]);i++){_9cd.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _9cf=e.grid.views.views;var _9d0=[];for(var j=view.idx+adj,_9d1;(_9d1=_9cf[j]);j=j+adj){_9d0.push({node:_9d1.headerNode,left:window.parseInt(_9d1.headerNode.style.left)});}var _9d2=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_9cb.w,table:_9d2,tw:html.contentBox(_9d2).w,spanners:_9cd,followers:_9d0};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _99f(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_99e.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_9d3,_9d4,_9d5){var _9d6=_9d5.l;var data={deltaX:_9d6,w:_9d3.w+(this.grid.isLeftToRight()?_9d6:-_9d6),vw:_9d3.vw+_9d6,tw:_9d3.tw+_9d6};this.dragRecord={inDrag:_9d3,mover:_9d4,leftTop:_9d5};if(data.w>=this.minColWidth){if(!_9d4){this.doResizeNow(_9d3,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_9d7){if(this.dragRecord){var _9d8=this.dragRecord.leftTop;var _9d9=this.grid.isLeftToRight()?_9d8.l:-_9d8.l;_9d9+=Math.max(_9d7.w+_9d9,this.minColWidth)-(_9d7.w+_9d9);if(has("webkit")&&_9d7.spanners.length){_9d9+=html._getPadBorderExtents(_9d7.spanners[0].node).w;}var data={deltaX:_9d9,w:_9d7.w+_9d9,vw:_9d7.vw+_9d9,tw:_9d7.tw+_9d9};this.doResizeNow(_9d7,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_9d7.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_9d7.index);},doResizeNow:function(_9da,data){_9da.view.convertColPctToFixed();if(_9da.view.flexCells&&!_9da.view.testFlexCells()){var t=_9a6(_9da.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_9da.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_9da.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_9da.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_9da.node.style.width=data.w+"px";_9da.view.setColWidth(_9da.index,data.w);_9da.view.headerNode.style.width=data.vw+"px";_9da.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_9da.view.headerNode.scrollLeft=_9da.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_9db){var _9dc=_9db.length;if(!_9dc){return;}this.map=[];var row;for(var k=0;(row=_9db[k]);k++){this.map[k]=[];}for(var j=0;(row=_9db[j]);j++){for(var i=0,x=0,cell,_9dd,_9de;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_9de=cell.rowSpan||1;_9dd=cell.colSpan||1;for(var y=0;y<_9de;y++){for(var s=0;s<_9dd;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_9dd;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_9df,_9e0){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_9e0&&cell.r==_9df){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_9e1,_9e2,_9e3){var row=_9e1&&_9e1.rows[_9e2];return row&&row.cells[_9e3];},_findOverlappingNodes:function(_9e4,_9e5,_9e6){var _9e7=[];var m=this.getMapCoords(_9e5,_9e6);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_9e4,rw.r,rw.c):null);if(n){_9e7.push(n);}}return _9e7;},findOverlappingNodes:function(_9e8){return this._findOverlappingNodes(_9a6(_9e8),_9a2(_9e8.parentNode),_9a1(_9e8));}});return {_Builder:_9ae,_HeaderBuilder:_9c5,_ContentBuilder:_9bf};});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_9e9,_9ea,_9eb,_9ec,lang,_9ed,_9ee,_9ef,_9f0,_9f1,dnd,_9f2,_9f3){if(!_9ec.isAsync){_9f0(0,function(){var _9f4=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_9f4);});}var _9f5=_9eb("dojo.dnd.Source",_9f2,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_9f6){lang.mixin(this,lang.mixin({},_9f6));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_9ed.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_9ed.add(this.node,"dojoDndTarget");}if(this.horizontal){_9ed.add(this.node,"dojoDndHorizontal");}this.topics=[_9f1.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_9f1.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_9f1.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_9f1.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_9f7,_9f8){if(this==_9f7){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_9f8.length;++i){var type=_9f7.getItem(_9f8[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_9f9,self){if(_9f9){return true;}if(arguments.length<2){self=this==_9f3.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_9f5.superclass.destroy.call(this);_9e9.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_9f5.superclass.onMouseMove.call(this,e);var m=_9f3.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _9fa=this.getSelectedNodes();if(_9fa.length){m.startDrag(this,_9fa,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _9fb=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_9ee.position(this.current,true);}if(this.horizontal){_9fb=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_9ee.isBodyLtr(this.current.ownerDocument);}else{_9fb=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_9fb!=this.before){this._markTargetAnchor(_9fb);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_9f5.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_9f5.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_9fc){if(this!==_9fc){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_9f3.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_9fd,_9fe,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_9fd?(copy?"Copied":"Moved"):"");}var _9ff=this.accept&&this.checkAcceptance(_9fd,_9fe);this._changeState("Target",_9ff?"":"Disabled");if(this==_9fd){_9f3.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_a00,_a01,copy,_a02){if(this==_a02){this.onDrop(_a00,_a01,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_a03,_a04,copy){if(this!=_a03){this.onDropExternal(_a03,_a04,copy);}else{this.onDropInternal(_a04,copy);}},onDropExternal:function(_a05,_a06,copy){var _a07=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _a07.call(this,_a05.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_a05.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_a05.getItem(node.id);_a05.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_a05.selectNone();}this.insertNodes(true,_a06,this.before,this.current);if(!copy&&this.creator){_a05.deleteSelectedNodes();}this._normalizedCreator=_a07;},onDropInternal:function(_a08,copy){var _a09=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _a09.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_a08,this.before,this.current);this._normalizedCreator=_a09;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_9f5.superclass.onOverEvent.call(this);_9f3.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_9f5.superclass.onOutEvent.call(this);_9f3.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_a0a){if(this.current==this.targetAnchor&&this.before==_a0a){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_a0a;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_9ef.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_9ed.contains(node,"dojoDndHandle")){return true;}if(_9ed.contains(node,"dojoDndItem")||_9ed.contains(node,"dojoDndIgnore")){break;}}return false;}});return _9f5;});},"esri/layers/OnDemandMode":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_a0b,_a0c,lang,_a0d,has,_a0e,_a0f,_a10,_a11,_a12){var _a13=_a0b([_a11],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_a14){this.featureLayer=_a14;this._featureMap={};this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _a15=this.featureLayer,_a16=_a15._srInfo;this._gridLayer=new _a12(new _a0f(_a16?_a16.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_a15._tileWidth,height:_a15._tileHeight},{width:map.width,height:map.height},_a16);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_a17){var _a18=this._gridLayer,geom=_a17.geometry,_a19=[];if(!geom){return;}_a19=_a18.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _a1a=this._cellMap,i,cell,oid=_a17.attributes[this.featureLayer.objectIdField],_a1b,row,col;for(i=0;i<_a19.length;i++){cell=_a19[i];_a1b=cell.latticeID;row=cell.row;col=cell.col;if(_a1b){cell=(_a1a[_a1b]=(_a1a[_a1b]||cell));}else{_a1a[row]=_a1a[row]||{};cell=(_a1a[row][col]=(_a1a[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_a17);this._addFeatureIIf(oid,_a17);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_a0c.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_a0c.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_a0c.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_a0c.disconnect(this._zoomConnect);_a0c.disconnect(this._panConnect);_a0c.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _a1c=this.featureLayer,map=this.map;if(_a1c.suspended){return;}_a1c._fireUpdateStart();this._clearIIf();var _a1d=_a1c._trackManager;if(_a1d){_a1d.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_a1e,cell){var id="_"+_a1e.name+_a1e.layerId+_a1e._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_a1f){this._exceeds=false;var _a20=this.featureLayer,map=this.map,_a21=_a1f||map.extent,_a22=this._gridLayer.getCellsInExtent(_a21,_a20.latticeTiling),_a23=_a22.cells;if(!_a20.isEditable()){var _a24=this._cellMap;_a23=_a0d.filter(_a23,function(cell){if(cell.lattice){if(_a24[cell.latticeID]){return false;}}else{if(_a24[cell.row]&&_a24[cell.row][cell.col]){return false;}}return true;});}var _a25=_a20.getOutFields(),_a26=_a20.getDefinitionExpression(),time=_a20._getOffsettedTE(_a20._mapTimeExtent),_a27=_a20._usePatch,_a28=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_a29,_a2a;this._pending=this._pending||0;for(i=0;i<_a23.length;i++){cell=_a23[i];_a29=new _a10();_a29.geometry=cell.extent||cell.lattice;_a29.outFields=_a25;_a29.where=_a26;if(_a20.latticeTiling&&cell.extent){_a29.spatialRelationship=_a10.SPATIAL_REL_CONTAINS;}_a29.returnGeometry=true;_a29.timeExtent=time;_a29.maxAllowableOffset=_a20._maxOffset;if(_a20._ts){_a29._ts=(new Date()).getTime();}_a2a=null;if(_a27){_a2a=this._getRequestId(_a20,cell);if(this._isPending(_a2a)){continue;}}this._pending++;_a28.push(_a20._task.execute(_a29,function(){var _a2b=cell;return function(_a2c){func.apply(self,[_a2c,_a2b]);};}.call(this),this._queryErrorHandler,_a2a));}this._removeOldCells(_a21);this._endCheck();},_drawFeatures:function(_a2d,cell){this._exceeds=this._exceeds||_a2d.exceededTransferLimit;this._finalizeIO();var _a2e=this.featureLayer,map=this.map,_a2f=map.extent,_a30=cell.extent,row=cell.row,col=cell.col,_a31=_a2e.objectIdField,_a32=_a2d.features,_a33=this._gridLayer,_a34=this._cellMap,i,len,_a35=cell.latticeID,_a36=_a35?_a34[_a35]:(_a34[row]&&_a34[row][col]);if((cell.resolution!=_a33._resolution)||(_a35?(_a35!==_a33.getLatticeID(_a2f)):(!_a33.intersects(_a30,_a2f)))){if(_a36){this._removeCell(row,col,_a35);}}else{if(_a36){this._updateCell(_a36,_a32);}else{cell.features=_a32;if(_a35){_a34[_a35]=cell;}else{_a34[row]=_a34[row]||{};_a34[row][col]=cell;}len=_a32.length;for(i=0;i<len;i++){var _a37=_a32[i];var oid=_a37.attributes[_a31];this._addFeatureIIf(oid,_a37);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_a38){if(this._pending===0){this._processIOQueue();var _a39=this.featureLayer,_a3a=_a39._trackManager;if(_a3a){_a3a.clearTracks();_a3a.addFeatures(_a39.graphics);if(_a39._ager){_a0d.forEach(_a39.graphics,function(_a3b){if(_a3b._shape){_a39._repaint(_a3b);}});}_a3a.moveLatestToFront();_a3a.drawTracks();}this.featureLayer._fireUpdateEnd(_a38&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_a39.onQueryLimitExceeded();}}},_processIOQueue:function(_a3c){this._ioQueue=_a0d.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_a3c){_a0d.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_a3d){var _a3e=this._cellMap,_a3f=this._gridLayer,_a40,_a41;for(_a40 in _a3e){if(_a3e[_a40]){var row=_a3e[_a40],_a42=row.latticeID,_a43=0,_a44=0;if(_a42){_a43++;if(_a42!==_a3f.getLatticeID(_a3d)){this._removeCell(null,null,_a42);_a44++;}}else{for(_a41 in row){if(row[_a41]){_a43++;var _a45=row[_a41].extent;if(!_a3f.intersects(_a45,_a3d)){this._removeCell(_a40,_a41);_a44++;}}}}if(_a44===_a43){delete _a3e[_a40];}}}},_updateCell:function(cell,_a46){var _a47=this.featureLayer,_a48=_a47.objectIdField,_a49=_a47._selectedFeatures,i,len=_a46.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _a4a=_a46[i];var oid=_a4a.attributes[_a48];var _a4b=this._addFeatureIIf(oid,_a4a);if(_a4b===_a4a){this._incRefCount(oid);cell.features.push(_a4b);}else{if(!(oid in _a49)){_a4b.setGeometry(_a4a.geometry);_a4b.setAttributes(_a4a.attributes);}}}},_removeCell:function(row,col,_a4c){var _a4d=this._cellMap,_a4e=this.featureLayer,_a4f=_a4e.objectIdField;var cell=_a4c?_a4d[_a4c]:(_a4d[row]&&_a4d[row][col]);if(cell){if(_a4c){delete _a4d[_a4c];}else{delete _a4d[row][col];}var _a50=cell.features,i;for(i=0;i<_a50.length;i++){var _a51=_a50[i];var oid=_a51.attributes[_a4f];this._decRefCount(oid);if(oid in _a4e._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){lang.setObject("layers._OnDemandMode",_a13,_a0e);}return _a13;});},"dijit/popup":function(){define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","./place","./BackgroundIframe","./main"],function(_a52,_a53,_a54,_a55,dom,_a56,_a57,_a58,_a59,_a5a,keys,lang,on,has,_a5b,_a5c,_a5d){function _a5e(){if(this._popupWrapper){_a57.destroy(this._popupWrapper);delete this._popupWrapper;}};var _a5f=_a55(null,{_stack:[],_beginZIndex:1000,_idGen:1,_createWrapper:function(_a60){var _a61=_a60._popupWrapper,node=_a60.domNode;if(!_a61){_a61=_a57.create("div",{"class":"dijitPopup",style:{display:"none"},role:"presentation"},_a60.ownerDocumentBody);_a61.appendChild(node);var s=node.style;s.display="";s.visibility="";s.position="";s.top="0px";_a60._popupWrapper=_a61;_a53.after(_a60,"destroy",_a5e,true);}return _a61;},moveOffScreen:function(_a62){var _a63=this._createWrapper(_a62);_a59.set(_a63,{visibility:"hidden",top:"-9999px",display:""});},hide:function(_a64){var _a65=this._createWrapper(_a64);_a59.set(_a65,"display","none");},getTopPopup:function(){var _a66=this._stack;for(var pi=_a66.length-1;pi>0&&_a66[pi].parent===_a66[pi-1].widget;pi--){}return _a66[pi];},open:function(args){var _a67=this._stack,_a68=args.popup,_a69=args.orient||["below","below-alt","above","above-alt"],ltr=args.parent?args.parent.isLeftToRight():_a58.isBodyLtr(_a68.ownerDocument),_a6a=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+this._idGen++);while(_a67.length&&(!args.parent||!dom.isDescendant(args.parent.domNode,_a67[_a67.length-1].widget.domNode))){this.close(_a67[_a67.length-1].widget);}var _a6b=this._createWrapper(_a68);_a56.set(_a6b,{id:id,style:{zIndex:this._beginZIndex+_a67.length},"class":"dijitPopup "+(_a68.baseClass||_a68["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:args.parent?args.parent.id:""});if(has("ie")||has("mozilla")){if(!_a68.bgIframe){_a68.bgIframe=new _a5c(_a6b);}}var best=_a6a?_a5b.around(_a6b,_a6a,_a69,ltr,_a68.orient?lang.hitch(_a68,"orient"):null):_a5b.at(_a6b,args,_a69=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],args.padding);_a6b.style.display="";_a6b.style.visibility="visible";_a68.domNode.style.visibility="visible";var _a6c=[];_a6c.push(on(_a6b,_a54._keypress,lang.hitch(this,function(evt){if(evt.charOrCode==keys.ESCAPE&&args.onCancel){_a5a.stop(evt);args.onCancel();}else{if(evt.charOrCode===keys.TAB){_a5a.stop(evt);var _a6d=this.getTopPopup();if(_a6d&&_a6d.onCancel){_a6d.onCancel();}}}})));if(_a68.onCancel&&args.onCancel){_a6c.push(_a68.on("cancel",args.onCancel));}_a6c.push(_a68.on(_a68.onExecute?"execute":"change",lang.hitch(this,function(){var _a6e=this.getTopPopup();if(_a6e&&_a6e.onExecute){_a6e.onExecute();}})));_a67.push({widget:_a68,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_a6c});if(_a68.onOpen){_a68.onOpen(best);}return best;},close:function(_a6f){var _a70=this._stack;while((_a6f&&_a52.some(_a70,function(elem){return elem.widget==_a6f;}))||(!_a6f&&_a70.length)){var top=_a70.pop(),_a71=top.widget,_a72=top.onClose;if(_a71.onClose){_a71.onClose();}var h;while(h=top.handlers.pop()){h.remove();}if(_a71&&_a71.domNode){this.hide(_a71);}if(_a72){_a72();}}}});return (_a5d.popup=new _a5f());});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_a73,lang,_a74,_a75,_a76,has,dom,_a77,_a78,_a79,util){var _a7a=_a73("dojox.grid._DeferredTextWidget",_a79,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _a7b=function(_a7c){try{util.fire(_a7c,"focus");util.fire(_a7c,"select");}catch(e){}};var _a7d=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _a7e=_a73("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_a7f){this._props=_a7f||{};lang.mixin(this,_a7f);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_a80,_a81){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_a80!=this.defaultValue&&f)?f.apply(s,_a81):_a80;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _a7a({deferred:v},_a78.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_a82,_a83){var f,i=this.grid.edit.info,d=this.get?this.get(_a82,_a83):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_a82&&i.cell==this))){return this.formatEditing(d,_a82);}else{return this._defaultFormat(d,[d,_a82,this]);}},formatEditing:function(_a84,_a85){},getNode:function(_a86){return this.view.getCellNode(_a86,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_a87){return (this.getNode(_a87)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_a88,_a89){if(this.getNode(_a89)){this.grid.edit.applyCellEdit(_a88,this,_a89);}},cancelEdit:function(_a8a){this.grid.doCancelEdit(_a8a);},_onEditBlur:function(_a8b){if(this.grid.edit.isEditCell(_a8b,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_a8c,_a8d){if(this.commitOnBlur){_a75.connect(_a8c,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_a8d),250);});}},needFormatNode:function(_a8e,_a8f){this._formatPending=true;_a7d(this,"_formatNode",_a8e,_a8f);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_a90,_a91){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_a91),_a90,_a91);}},formatNode:function(_a92,_a93,_a94){if(has("ie")){_a7d(this,"focus",_a94,_a92);}else{this.focus(_a94,_a92);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_a95){return this.getEditNode(_a95)[this._valueProp];},setValue:function(_a96,_a97){var n=this.getEditNode(_a96);if(n){n[this._valueProp]=_a97;}},focus:function(_a98,_a99){_a7b(_a99||this.getEditNode(_a98));},save:function(_a9a){this.value=this.value||this.getValue(_a9a);},restore:function(_a9b){this.setValue(_a9b,this.value);},_finish:function(_a9c){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_a9d){this.applyEdit(this.getValue(_a9d),_a9d);this._finish(_a9d);},cancel:function(_a9e){this.cancelEdit(_a9e);this._finish(_a9e);}});_a7e.markupFactory=function(node,_a9f){var _aa0=lang.trim(_a77.get(node,"formatter")||"");if(_aa0){_a9f.formatter=lang.getObject(_aa0)||_aa0;}var get=lang.trim(_a77.get(node,"get")||"");if(get){_a9f.get=lang.getObject(get);}var _aa1=function(attr,cell,_aa2){var _aa3=lang.trim(_a77.get(node,attr)||"");if(_aa3){cell[_aa2||attr]=!(_aa3.toLowerCase()=="false");}};_aa1("sortDesc",_a9f);_aa1("editable",_a9f);_aa1("alwaysEditing",_a9f);_aa1("noresize",_a9f);_aa1("draggable",_a9f);var _aa4=lang.trim(_a77.get(node,"loadingText")||_a77.get(node,"defaultValue")||"");if(_aa4){_a9f.defaultValue=_aa4;}var _aa5=function(attr,cell,_aa6){var _aa7=lang.trim(_a77.get(node,attr)||"")||undefined;if(_aa7){cell[_aa6||attr]=_aa7;}};_aa5("styles",_a9f);_aa5("headerStyles",_a9f);_aa5("cellStyles",_a9f);_aa5("classes",_a9f);_aa5("headerClasses",_a9f);_aa5("cellClasses",_a9f);};var Cell=_a73("dojox.grid.cells.Cell",_a7e,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_aa8,_aa9){this.needFormatNode(_aa8,_aa9);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_aa8+"\">";},formatNode:function(_aaa,_aab,_aac){this.inherited(arguments);this.registerOnBlur(_aaa,_aac);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_a74.stop(e);}}},_finish:function(_aad){this.inherited(arguments);var n=this.getEditNode(_aad);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_aae){_a7e.markupFactory(node,_aae);var _aaf=lang.trim(_a77.get(node,"keyFilter")||"");if(_aaf){_aae.keyFilter=new RegExp(_aaf);}};var _ab0=_a73("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_ab1){return _ab1+1;}});_ab0.markupFactory=function(node,_ab2){Cell.markupFactory(node,_ab2);};var _ab3=_a73("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_ab4){this.values=this.values||this.options;},formatEditing:function(_ab5,_ab6){this.needFormatNode(_ab5,_ab6);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_ab5==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_ab7,_ab8){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_a76.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_ab9){var n=this.getEditNode(_ab9);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_ab3.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _aba=lang.trim(_a77.get(node,"options")||"");if(_aba){var o=_aba.split(",");if(o[0]!=_aba){cell.options=o;}}var _abb=lang.trim(_a77.get(node,"values")||"");if(_abb){var v=_abb.split(",");if(v[0]!=_abb){cell.values=v;}}};var _abc=_a73("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_abd,_abe){this.formatNode(this.getEditNode(_abe),_abd,_abe);},applyStaticValue:function(_abf){var e=this.grid.edit;e.applyCellEdit(this.getValue(_abf),this,_abf);e.start(this,_abf,true);}});_abc.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_a73("dojox.grid.cells.Bool",_abc,{_valueProp:"checked",formatEditing:function(_ac0,_ac1){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_ac0?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_abc.markupFactory(node,cell);};return _a7e;});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_ac2,lang,_ac3,_ac4,_ac5,has,_ac6,_ac7,_ac8,_ac9,Box,_aca,_acb,_acc,_acd){var EDT=_ac2(_ac9,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_ace){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _acf=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _acc(_acc.STYLE_CIRCLE,_acf?20:12,new _acd(_acd.STYLE_SOLID,new _ac5([0,0,0,0.5]),1),new _ac5([128,128,128])),ghostVertexSymbol:new _acc(_acc.STYLE_CIRCLE,_acf?18:10,new _acd(_acd.STYLE_SOLID,new _ac5([0,0,0,0.5]),1),new _ac5([255,255,255,0.75])),ghostLineSymbol:new _acd(_acd.STYLE_DOT,new _ac5([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_acf?24:16,boxLineSymbol:new _acd(_acd.STYLE_DASH,new _ac5([64,64,64]),1),boxHandleSymbol:new _acc(_acc.STYLE_SQUARE,_acf?16:9,new _acd(_acd.STYLE_SOLID,new _ac5([0,0,0,0.5]),1),new _ac5([255,255,255,0.75]))},_ace||{});},activate:function(tool,_ad0,_ad1){this.deactivate();this._graphic=_ad0;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_ad1||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,_ad2=EDT.SCALE,_ad3=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,_ad4=map.spatialReference,_ad5=_ad0.geometry.spatialReference;this._geo=!!(_ad4&&_ad5&&!_ad4.equals(_ad5)&&_ad4.isWebMercator()&&_ad5.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_ad0);}var _ad6=((tool&_ad2)===_ad2),_ad7=((tool&_ad3)===_ad3);if(_ad6||_ad7){box=this._enableBoxEditing(_ad0,_ad6,_ad7);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_ad0);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_ac3.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_ac3.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_ad0);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_ad8=this._graphic;if(!tool){return;}var _ad9=!!this._modified;this._clear();_ac3.disconnect(this._mapPanEndHandle);_ac3.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_ad8,{isModified:_ad9});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_ada){},onDeactivate:function(tool,_adb,info){},onGraphicMoveStart:function(_adc){},onGraphicFirstMove:function(_add){this._modified=true;},onGraphicMove:function(_ade,_adf){},onGraphicMoveStop:function(_ae0,_ae1){},onGraphicClick:function(_ae2,info){},onVertexMoveStart:function(_ae3,_ae4){},onVertexFirstMove:function(_ae5,_ae6){this._modified=true;},onVertexMove:function(_ae7,_ae8,_ae9){},onVertexMoveStop:function(_aea,_aeb,_aec){},onVertexAdd:function(_aed,_aee){this._modified=true;},onVertexClick:function(_aef,_af0){},onVertexMouseOver:function(_af1,_af2){},onVertexMouseOut:function(_af3,_af4){},onVertexDelete:function(_af5,_af6){this._modified=true;},onScaleStart:function(_af7){},onScaleFirstMove:function(_af8){this._modified=true;},onScale:function(_af9,info){},onScaleStop:function(_afa,info){},onRotateStart:function(_afb){},onRotateFirstMove:function(_afc){this._modified=true;},onRotate:function(_afd,info){},onRotateStop:function(_afe,info){},_enableMove:function(_aff){var map=this._map,type=_aff.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _aca(_aff,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_b00){var map=this._map,type=_b00.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_acb.create(_b00,map,this);return true;}return false;},_enableBoxEditing:function(_b01,_b02,_b03){var map=this._map,type=_b01.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_b01,map,this,_b02,_b03,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _b04=this._graphicMover;if(_b04){_b04.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _b05=this._vertexEditor;if(_b05){_b05.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_b06){if(_b06){this._refreshMoveables();}},_refreshMoveables:function(_b07){var _b08=_ac4.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_ac7.isDefined);_ac4.forEach(_b08,function(mov){mov.refresh(_b07);});},_beginOperation:function(_b09){_ac4.forEach(this._getAffectedTools(_b09),function(tool){tool.suspend();});},_endOperation:function(_b0a){_ac4.forEach(this._getAffectedTools(_b0a),function(tool){tool.resume();});},_getAffectedTools:function(_b0b){var _b0c=[];switch(_b0b){case "MOVE":_b0c=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_b0c=[this._boxEditor];break;case "BOX":_b0c=[this._vertexEditor];break;}_b0c=_ac4.filter(_b0c,_ac7.isDefined);return _b0c;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_ac6);}return EDT;});},"esri/toolbars/_VertexMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_b0d,lang,_b0e,has,_b0f,_b10,_b11,_b12,_b13,_b14,_b15){var VM=_b0d(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(_b16,_b17,_b18,_b19,_b1a,_b1b,_b1c,_b1d){this.point=_b16;this.symbol=_b17;this.relatedGraphic=_b18;this.segIndex=_b19;this.ptIndex=_b1a;this.segLength=_b1b;this.editor=_b1c;this.map=_b1c.map;this._scratchGL=_b1c.toolbar._scratchGL;this._placeholder=_b1d||false;this._type=_b18.geometry.type;this._init();this._enable();},refresh:function(_b1e){if(_b1e||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _b1f=new _b13(this.point.toJson());var _b20=new _b14(_b1f,this.symbol);switch(this._type){case "multipoint":_b20._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_b20);break;}this.graphic=_b20;},_enable:function(){var _b21=this.graphic.getDojoShape();if(_b21){_b21._hasMover=true;this._moveable=this._getMoveable(_b21);var node=_b21.getEventSource();if(node){_b10.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _b22=this._moveable;if(_b22){_b0e.disconnect(this._startHandle);_b0e.disconnect(this._firstHandle);_b0e.disconnect(this._movingHandle);_b0e.disconnect(this._stopHandle);var _b23=_b22.shape;if(_b23){var node=_b23.getEventSource();if(node){_b10.set(node,"cursor",null);}}_b22.destroy();this._moveable=null;}},_needRefresh:function(){var _b24=this.graphic.getDojoShape(),need=false;if(_b24){switch(this._type){case "multipoint":var _b25=this.relatedGraphic.getDojoShape();if(_b25){var _b26=_b25.children[this.ptIndex];if(_b24!==_b26){_b24=_b26;this.graphic._shape=_b24;need=true;}}break;case "polyline":case "polygon":need=!_b24._hasMover;break;}}return need;},_getMoveable:function(_b27){var _b28=new _b11(_b27,_b0f("mac")&&_b0f("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_b0e.connect(_b28,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_b0e.connect(_b28,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_b0e.connect(_b28,"onMoving",this,this._movingHandler);this._stopHandle=_b0e.connect(_b28,"onMoveStop",this,this._moveStopHandler);return _b28;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_b29){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_b29.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_b2a){var _b2b=_b2a.shape;var _b2c=this._getControlEdges();var _b2d=this._scratchGL._div;var i,_b2e=[],_b2f=_b2a.host.shape._wrapOffsets[0]||0;for(i=0;i<_b2c.length;i++){var edge=_b2c[i];edge.x1+=_b2f;edge.x2+=_b2f;_b2e.push([_b2d.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_b2b._lines=_b2e;_b2a.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_b30){var _b31=_b30.shape,tx=_b31.getTransform();var i,_b32=_b31._lines;for(i=0;i<_b32.length;i++){var line=_b32[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_b33){var _b34=_b33.shape,_b35=this.editor.toolbar,tx=_b34.getTransform(),map=this.map,host=this.graphic,_b36=_b35._geo?_b15.geographicToWebMercator(host.geometry):host.geometry;var i,_b37=_b34._lines;if(_b37){for(i=0;i<_b37.length;i++){_b37[i][0].removeShape();}_b34._lines=null;}var ph=false,_b38=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_b38=false;}var _b39;if(map.snappingManager){_b39=map.snappingManager._snappingPoint;}var _b3a=_b39||map.toMap(map.toScreen(_b36).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_b34.setTransform(null);host.setGeometry(_b35._geo?_b15.webMercatorToGeographic(_b3a,true):_b3a);this.constructor.onMoveStop(this,tx);_b35.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_b38){_b35.onVertexClick(this.relatedGraphic,info);}if(ph){_b35.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _b3b=this.relatedGraphic.geometry;var _b3c=this.segIndex,_b3d=this.ptIndex,_b3e=this.segLength;var _b3f=this._scratchGL._div;var _b40=_b3f.getTransform();var sdx=_b40.dx,sdy=_b40.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _b41=[];var _b42=this.editor._getControlPoints(this,_b3b,_b3c,_b3d,_b3e);if(_b42[0]){_b41.push({x1:x,y1:y,x2:_b42[0].x-sdx,y2:_b42[0].y-sdy});}if(_b42[1]){_b41.push({x1:x,y1:y,x2:_b42[1].x-sdx,y2:_b42[1].y-sdy});}return _b41;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_b12);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"dijit/_WidgetBase":function(){define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./Destroyable","./registry"],function(_b43,_b44,_b45,_b46,_b47,_b48,dom,_b49,_b4a,_b4b,_b4c,_b4d,has,_b4e,lang,on,_b4f,_b50,_b51,win,_b52,_b53){has.add("dijit-legacy-requires",!_b4e.isAsync);if(has("dijit-legacy-requires")){_b4f(0,function(){var _b54=["dijit/_base/manager"];_b43(_b54);});}var _b55={};function _b56(obj){var ret={};for(var attr in obj){ret[attr.toLowerCase()]=true;}return ret;};function _b57(attr){return function(val){_b49[val?"set":"remove"](this.domNode,attr,val);this._set(attr,val);};};return _b48("dijit._WidgetBase",[_b50,_b52],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:_b57("lang"),dir:"",_setDirAttr:_b57("dir"),textDir:"","class":"",_setClassAttr:{node:"domNode",type:"class"},style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(val){this._set("ownerDocument",val);},attributeMap:{},_blankGif:_b46.blankGif||_b43.toUrl("dojo/resources/blank.gif"),postscript:function(_b58,_b59){this.create(_b58,_b59);},create:function(_b5a,_b5b){this.srcNodeRef=dom.byId(_b5b);this._connects=[];this._supportingWidgets=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_b5a){this.params=_b5a;lang.mixin(this,_b5a);}this.postMixInProperties();if(!this.id){this.id=_b53.getUniqueId(this.declaredClass.replace(/\./g,"_"));if(this.params){delete this.params.id;}}this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:win.doc);this.ownerDocumentBody=win.body(this.ownerDocument);_b53.add(this);this.buildRendering();var _b5c;if(this.domNode){this._applyAttributes();var _b5d=this.srcNodeRef;if(_b5d&&_b5d.parentNode&&this.domNode!==_b5d){_b5d.parentNode.replaceChild(this.domNode,_b5d);_b5c=true;}this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(_b5c){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var ctor=this.constructor,list=ctor._setterAttrs;if(!list){list=(ctor._setterAttrs=[]);for(var attr in this.attributeMap){list.push(attr);}var _b5e=ctor.prototype;for(var _b5f in _b5e){if(_b5f in this.attributeMap){continue;}var _b60="_set"+_b5f.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();})+"Attr";if(_b60 in _b5e){list.push(_b5f);}}}var _b61={};for(var key in this.params||{}){_b61[key]=this[key];}_b44.forEach(list,function(attr){if(attr in _b61){}else{if(this[attr]){this.set(attr,this[attr]);}}},this);for(key in _b61){this.set(key,_b61[key]);}},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div");}if(this.baseClass){var _b62=this.baseClass.split(" ");if(!this.isLeftToRight()){_b62=_b62.concat(_b44.map(_b62,function(name){return name+"Rtl";}));}_b4a.add(this.domNode,_b62);}},postCreate:function(){},startup:function(){if(this._started){return;}this._started=true;_b44.forEach(this.getChildren(),function(obj){if(!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)){obj.startup();obj._started=true;}});},destroyRecursive:function(_b63){this._beingDestroyed=true;this.destroyDescendants(_b63);this.destroy(_b63);},destroy:function(_b64){this._beingDestroyed=true;this.uninitialize();function _b65(w){if(w.destroyRecursive){w.destroyRecursive(_b64);}else{if(w.destroy){w.destroy(_b64);}}};_b44.forEach(this._connects,lang.hitch(this,"disconnect"));_b44.forEach(this._supportingWidgets,_b65);if(this.domNode){_b44.forEach(_b53.findWidgets(this.domNode,this.containerNode),_b65);}this.destroyRendering(_b64);_b53.remove(this.id);this._destroyed=true;},destroyRendering:function(_b66){if(this.bgIframe){this.bgIframe.destroy(_b66);delete this.bgIframe;}if(this.domNode){if(_b66){_b49.remove(this.domNode,"widgetId");}else{_b4b.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_b66){_b4b.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_b67){_b44.forEach(this.getChildren(),function(_b68){if(_b68.destroyRecursive){_b68.destroyRecursive(_b67);}});},uninitialize:function(){return false;},_setStyleAttr:function(_b69){var _b6a=this.domNode;if(lang.isObject(_b69)){_b4d.set(_b6a,_b69);}else{if(_b6a.style.cssText){_b6a.style.cssText+="; "+_b69;}else{_b6a.style.cssText=_b69;}}this._set("style",_b69);},_attrToDom:function(attr,_b6b,_b6c){_b6c=arguments.length>=3?_b6c:this.attributeMap[attr];_b44.forEach(lang.isArray(_b6c)?_b6c:[_b6c],function(_b6d){var _b6e=this[_b6d.node||_b6d||"domNode"];var type=_b6d.type||"attribute";switch(type){case "attribute":if(lang.isFunction(_b6b)){_b6b=lang.hitch(this,_b6b);}var _b6f=_b6d.attribute?_b6d.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);if(_b6e.tagName){_b49.set(_b6e,_b6f,_b6b);}else{_b6e.set(_b6f,_b6b);}break;case "innerText":_b6e.innerHTML="";_b6e.appendChild(this.ownerDocument.createTextNode(_b6b));break;case "innerHTML":_b6e.innerHTML=_b6b;break;case "class":_b4a.replace(_b6e,_b6b,this[attr]);break;}},this);},get:function(name){var _b70=this._getAttrNames(name);return this[_b70.g]?this[_b70.g]():this[name];},set:function(name,_b71){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _b72=this._getAttrNames(name),_b73=this[_b72.s];if(lang.isFunction(_b73)){var _b74=_b73.apply(this,Array.prototype.slice.call(arguments,1));}else{var _b75=this.focusNode&&!lang.isFunction(this.focusNode)?"focusNode":"domNode",_b76,map,tag;tag=this[_b75]&&this[_b75].tagName;if(tag){_b76=_b55[tag]||(_b55[tag]=_b56(this[_b75]));}map=name in this.attributeMap?this.attributeMap[name]:_b72.s in this?this[_b72.s]:((_b76&&_b72.l in _b76&&typeof _b71!="function")||/^aria-|^data-|^role$/.test(name))?_b75:null;if(map!=null){this._attrToDom(name,_b71,map);}this._set(name,_b71);}return _b74||this;},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();});return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr",l:uc.toLowerCase()});},_set:function(name,_b77){var _b78=this[name];this[name]=_b77;if(this._created&&_b77!==_b78){if(this._watchCallbacks){this._watchCallbacks(name,_b78,_b77);}this.emit("attrmodified-"+name,{detail:{prevValue:_b78,newValue:_b77}});}},emit:function(type,_b79,_b7a){_b79=_b79||{};if(_b79.bubbles===undefined){_b79.bubbles=true;}if(_b79.cancelable===undefined){_b79.cancelable=true;}if(!_b79.detail){_b79.detail={};}_b79.detail.widget=this;var ret,_b7b=this["on"+type];if(_b7b){ret=_b7b.apply(this,_b7a?_b7a:[_b79]);}if(this._started&&!this._beingDestroyed){on.emit(this.domNode,type.toLowerCase(),_b79);}return ret;},on:function(type,func){var _b7c=this._onMap(type);if(_b7c){return _b45.after(this,_b7c,func,true);}return this.own(on(this.domNode,type,func))[0];},_onMap:function(type){var ctor=this.constructor,map=ctor._onMap;if(!map){map=(ctor._onMap={});for(var attr in ctor.prototype){if(/^on/.test(attr)){map[attr.replace(/^on/,"").toLowerCase()]=attr;}}}return map[typeof type=="string"&&type.toLowerCase()];},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getChildren:function(){return this.containerNode?_b53.findWidgets(this.containerNode):[];},getParent:function(){return _b53.getEnclosingWidget(this.domNode.parentNode);},connect:function(obj,_b7d,_b7e){return this.own(_b47.connect(obj,_b7d,this,_b7e))[0];},disconnect:function(_b7f){_b7f.remove();},subscribe:function(t,_b80){return this.own(_b51.subscribe(t,lang.hitch(this,_b80)))[0];},unsubscribe:function(_b81){_b81.remove();},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):_b4c.isBodyLtr(this.ownerDocument);},isFocusable:function(){return this.focus&&(_b4d.get(this.domNode,"display")!="none");},placeAt:function(_b82,_b83){var _b84=!_b82.tagName&&_b53.byId(_b82);if(_b84&&_b84.addChild&&(!_b83||typeof _b83==="number")){_b84.addChild(this,_b83);}else{var ref=_b84?(_b84.containerNode&&!/after|before|replace/.test(_b83||"")?_b84.containerNode:_b84.domNode):dom.byId(_b82,this.ownerDocument);_b4b.place(this.domNode,ref,_b83);if(!this._started&&(this.getParent()||{})._started){this.startup();}}return this;},getTextDir:function(text,_b85){return _b85;},applyTextDir:function(){},defer:function(fcn,_b86){var _b87=setTimeout(lang.hitch(this,function(){_b87=null;if(!this._destroyed){lang.hitch(this,fcn)();}}),_b86||0);return {remove:function(){if(_b87){clearTimeout(_b87);_b87=null;}return null;}};}});});},"dojo/dnd/Moveable":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../dom","../dom-class","../Evented","../on","../topic","../touch","./common","./Mover","../_base/window"],function(_b88,_b89,_b8a,lang,dom,_b8b,_b8c,on,_b8d,_b8e,dnd,_b8f,win){var _b90=_b89("dojo.dnd.Moveable",[_b8c],{handle:"",delay:0,skip:false,constructor:function(node,_b91){this.node=dom.byId(node);if(!_b91){_b91={};}this.handle=_b91.handle?dom.byId(_b91.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_b91.delay>0?_b91.delay:0;this.skip=_b91.skip;this.mover=_b91.mover?_b91.mover:_b8f;this.events=[on(this.handle,_b8e.press,lang.hitch(this,"onMouseDown")),on(this.handle,"dragstart",lang.hitch(this,"onSelectStart")),on(this.handle,"selectstart",lang.hitch(this,"onSelectStart"))];},markupFactory:function(_b92,node,Ctor){return new Ctor(node,_b92);},destroy:function(){_b88.forEach(this.events,function(_b93){_b93.remove();});this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dnd.isFormElement(e)){return;}if(this.delay){this.events.push(on(this.handle,_b8e.move,lang.hitch(this,"onMouseMove")),on(this.handle,_b8e.release,lang.hitch(this,"onMouseUp")));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}_b8a.stop(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}_b8a.stop(e);},onMouseUp:function(e){for(var i=0;i<2;++i){this.events.pop().remove();}_b8a.stop(e);},onSelectStart:function(e){if(!this.skip||!dnd.isFormElement(e)){_b8a.stop(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_b94){_b8d.publish("/dnd/move/start",_b94);_b8b.add(win.body(),"dojoMove");_b8b.add(this.node,"dojoMoveItem");},onMoveStop:function(_b95){_b8d.publish("/dnd/move/stop",_b95);_b8b.remove(win.body(),"dojoMove");_b8b.remove(this.node,"dojoMoveItem");},onFirstMove:function(){},onMove:function(_b96,_b97){this.onMoving(_b96,_b97);var s=_b96.node.style;s.left=_b97.l+"px";s.top=_b97.t+"px";this.onMoved(_b96,_b97);},onMoving:function(){},onMoved:function(){}});return _b90;});},"esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_b98,lang,_b99,_b9a,has,Menu,_b9b,_b9c,_b9d,_b9e,_b9f,_ba0){var GVE=_b98(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_ba1,map,_ba2){this.graphic=_ba1;this.map=map;this.toolbar=_ba2;var _ba3=_ba2._options;this._symbol1=_ba3.vertexSymbol;this._symbol2=_ba3.ghostVertexSymbol;var _ba4=_ba3.ghostLineSymbol;this._lineStroke={style:_ba4.style,width:_ba4.width,color:_ba4.color};this._canDel=_ba3.allowDeleteVertices;this._canAdd=_ba3.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_ba5){if(_ba5){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_b99.connect(_b9d,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_b99.connect(_b9d,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _ba6=this._getGraphicsLayer();this._mouseOverHandle=_b99.connect(_ba6,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_b99.connect(_ba6,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _ba7=(this._ctxDelete=new _b9b({label:_ba0.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_b99.connect(_ba7,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_ba7);this._ctxMenu.startup();}},_removeControllers:function(){_b99.disconnect(this._firstMoveHandle);_b99.disconnect(this._moveStopHandle);_b99.disconnect(this._mouseOverHandle);_b99.disconnect(this._mouseOutHandle);_b99.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_ba8,_ba9,_baa){var i,j,_bab=this.graphic,_bac=[];for(i=0;i<_ba8.length;i++){var _bad=_ba8[i],_bae=[];for(j=0;j<_bad.length;j++){_bae.push(new _b9d(_bad[j],_ba9,_bab,i,j,_bad.length,this,_baa));}_bac.push(_bae);}return _bac;},_remove:function(_baf){if(_baf){_b9a.forEach(_baf,function(_bb0){_b9a.forEach(_bb0,function(_bb1){_bb1.destroy();});});}},_refresh:function(_bb2){if(_bb2){_b9a.forEach(_bb2,function(_bb3){_b9a.forEach(_bb3,function(_bb4){_bb4.refresh();});});}},_isNew:function(_bb5){return (_b9a.indexOf(this._vertexMovers[_bb5.segIndex],_bb5)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _bb6=this._selectedMover,_bb7=_bb6.ptIndex;this._updateRelatedGraphic(_bb6,_bb6.relatedGraphic,_bb6.graphic.geometry,_bb6.segIndex,_bb6.ptIndex,_bb6.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_bb6);}this._deleteVertex(_bb6);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _bb8=evt.graphic,_bb9=this._findMover(_bb8);if(_bb9){this.toolbar.onVertexMouseOver(this.graphic,_bb9._getInfo());if(!_bb9._placeholder){this._selectedMover=_bb9;if(this._canDel){this._bindCtxNode(_bb8.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _bba=evt.graphic,_bbb=this._findMover(_bba);if(_bbb){this.toolbar.onVertexMouseOut(this.graphic,_bbb._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_bbc){var i,_bbd=[],_bbe=this._mpVertexMovers;_b9a.forEach(this._vertexMovers,function(_bbf){_bbd=_bbd.concat(_bbf);});if(_bbe){_b9a.forEach(_bbe,function(_bc0){_bbd=_bbd.concat(_bc0);});}for(i=0;i<_bbd.length;i++){var _bc1=_bbd[i];if(_bc1.graphic===_bbc){return _bc1;}}},_firstMoveHandler:function(_bc2){if(!this._isNew(_bc2)&&this._canAdd){this._hideRelatedMidpoints(_bc2);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_bc3,tx){var add=this._isNew(_bc3);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_bc3);}return;}this._updateRelatedGraphic(_bc3,_bc3.relatedGraphic,_bc3.graphic.geometry,_bc3.segIndex,_bc3.ptIndex,_bc3.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_bc3);}else{this._repositionRelatedMidpoints(_bc3);this._showRelatedMidpoints(_bc3);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_bc4){var i,_bc5=this._getAdjacentMidpoints(_bc4.ptIndex,_bc4.segLength),_bc6=this._mpVertexMovers[_bc4.segIndex];for(i=0;i<_bc5.length;i++){var mvr=_bc6[_bc5[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_bc7){var i,_bc8=this._getAdjacentMidpoints(_bc7.ptIndex,_bc7.segLength),_bc9=this._mpVertexMovers[_bc7.segIndex];for(i=0;i<_bc8.length;i++){_bc9[_bc8[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_bca){var i,_bcb=this._getAdjacentMidpoints(_bca.ptIndex,_bca.segLength),_bcc=this._mpVertexMovers[_bca.segIndex];for(i=0;i<_bcb.length;i++){var _bcd=this._getAdjacentVertices(_bcb[i],_bca.segLength);var _bce=_bca.relatedGraphic.geometry.getPoint(_bca.segIndex,_bcd[0]),_bcf=_bca.relatedGraphic.geometry.getPoint(_bca.segIndex,_bcd[1]);var _bd0=new _b9e({x:(_bce.x+_bcf.x)/2,y:(_bce.y+_bcf.y)/2,spatialReference:_bce.spatialReference.toJson()});_bcc[_bcb[i]].graphic.setGeometry(_bd0);}},_addMidpoints:function(_bd1){var _bd2=_bd1.segIndex,_bd3=_bd1.ptIndex,_bd4=_bd1.segLength;var _bd5=_bd3+1;var i,_bd6=_bd4+1;this._mpVertexMovers[_bd2].splice(_bd3,1);var _bd7=this._vertexMovers[_bd2];for(i=0;i<_bd5;i++){_bd7[i].segLength+=1;}for(i=_bd5;i<_bd7.length;i++){_bd7[i].ptIndex+=1;_bd7[i].segLength+=1;}_bd1.ptIndex=_bd5;_bd1.segLength=_bd7.length+1;_bd7.splice(_bd5,0,_bd1);_bd1.graphic.setSymbol(this._symbol1);_bd7=this._mpVertexMovers[_bd2];for(i=0;i<_bd3;i++){_bd7[i].segLength+=1;}for(i=_bd3;i<_bd4-1;i++){_bd7[i].ptIndex+=1;_bd7[i].segLength+=1;}var _bd8=this._getAdjacentVertices(_bd3,_bd6);var _bd9=this._getAdjacentVertices(_bd3+1,_bd6);var _bda,_bdb;_bda=_bd1.relatedGraphic.geometry.getPoint(_bd1.segIndex,_bd8[0]);_bdb=_bd1.relatedGraphic.geometry.getPoint(_bd1.segIndex,_bd8[1]);var _bdc=new _b9e({x:(_bda.x+_bdb.x)/2,y:(_bda.y+_bdb.y)/2,spatialReference:_bda.spatialReference.toJson()});_bda=_bd1.relatedGraphic.geometry.getPoint(_bd1.segIndex,_bd9[0]);_bdb=_bd1.relatedGraphic.geometry.getPoint(_bd1.segIndex,_bd9[1]);var _bdd=new _b9e({x:(_bda.x+_bdb.x)/2,y:(_bda.y+_bdb.y)/2,spatialReference:_bda.spatialReference.toJson()});var mvr1=new _b9d(_bdc,this._symbol2,this.graphic,_bd1.segIndex,_bd3,_bd6,this,true);var mvr2=new _b9d(_bdd,this._symbol2,this.graphic,_bd1.segIndex,_bd3+1,_bd6,this,true);_bd7.splice(_bd3,0,mvr1,mvr2);},_deleteVertex:function(_bde){var i,_bdf=_bde.segIndex,_be0=_bde.ptIndex;var _be1=this._vertexMovers[_bdf];for(i=0;i<_be0;i++){_be1[i].segLength-=1;}for(i=_be0+1;i<_be1.length;i++){var mvr=_be1[i];mvr.ptIndex-=1;mvr.segLength-=1;}_be1.splice(_be0,1);var info=_bde._getInfo();_bde.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_be2,map,_be3){var type=_be2.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_be2,map,_be3);break;case "polyline":return new GVE.PolylineVertexEditor(_be2,map,_be3);break;case "polygon":return new GVE.PolygonVertexEditor(_be2,map,_be3);break;}}});GVE.MultipointVertexEditor=_b98(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_b99.connect(_b9d,"onMoveStart",this,this._moveStartHandler);_b99.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_b99.disconnect(this._moveStartHandle);},_getSegments:function(_be4){var i,_be5=_be4.points,_be6=[],sr=_be4.spatialReference;for(i=0;i<_be5.length;i++){var _be7=_be5[i];_be6.push(new _b9e({x:_be7[0],y:_be7[1],spatialReference:sr.toJson()}));}return [_be6];},_getMidpointSegments:function(_be8){return [];},_getControlPoints:function(_be9,_bea,_beb,_bec,_bed){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _bee=evt.graphic,_bef=this._findMover(evt);if(_bef){this.toolbar.onVertexMouseOver(_bee,_bef._getInfo());this._selectedMover=_bef;if(this._canDel){this._bindCtxNode(_bef.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _bf0=evt.graphic,_bf1=this._findMover(evt);if(_bf1){this.toolbar.onVertexMouseOut(_bf0,_bf1._getInfo());}},_findMover:function(evt){var i,_bf2=[].concat(this._vertexMovers[0]),_bf3=evt.target;for(i=0;i<_bf2.length;i++){var _bf4=_bf2[i];if(_bf4.graphic.getDojoShape().getNode()===_bf3){return _bf4;}}},_moveStartHandler:function(_bf5){var geom=_bf5.relatedGraphic.geometry,_bf6=_bf5.ptIndex;var _bf7=_bf5.segLength-1;var _bf8=geom.points;var _bf9=_bf8.splice(_bf6,1);_bf8.push(_bf9[0]);var j,_bfa=this._vertexMovers[0];for(j=_bf7;j>_bf6;j--){_bfa[j].ptIndex-=1;}_bf9=_bfa.splice(_bf6,1);_bfa.push(_bf9[0]);_bf9[0].ptIndex=_bf7;},_moveStopHandler:function(_bfb){this._updateRelatedGraphic(_bfb,_bfb.relatedGraphic,_bfb.graphic.geometry,_bfb.segIndex,_bfb.ptIndex,_bfb.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_bfc,_bfd,_bfe,_bff,_c00,_c01,add,del){var geom=_bfd.geometry;if(del){geom.removePoint(_c00);}else{geom.setPoint(_c00,_bfe);}_bfd.setGeometry(geom);},_deleteMidpoints:function(_c02){}});GVE.PolylineVertexEditor=_b98(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_c03){var i,j,_c04=_c03.paths,_c05=[];for(i=0;i<_c04.length;i++){var path=_c04[i],_c06=[];for(j=0;j<path.length;j++){_c06.push(_c03.getPoint(i,j));}_c05.push(_c06);}return _c05;},_getMidpointSegments:function(_c07){var i,j,_c08=_c07.paths,_c09=[],sr=_c07.spatialReference;for(i=0;i<_c08.length;i++){var path=_c08[i],_c0a=[];for(j=0;j<path.length-1;j++){var _c0b=_c07.getPoint(i,j),_c0c=_c07.getPoint(i,j+1);var midX=(_c0b.x+_c0c.x)/2,midY=(_c0b.y+_c0c.y)/2;var _c0d=new _b9e({x:midX,y:midY,spatialReference:sr.toJson()});_c0a.push(_c0d);}_c09.push(_c0a);}return _c09;},_getControlPoints:function(_c0e,_c0f,_c10,_c11,_c12){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_c0e)){idx1=_c11;idx2=_c11+1;if(idx1>=0){pt1=map.toScreen(_c0f.getPoint(_c10,idx1));}if(idx2<=_c12){pt2=map.toScreen(_c0f.getPoint(_c10,idx2));}}else{idx1=_c11-1;idx2=_c11+1;if(idx1>=0){pt1=map.toScreen(_c0f.getPoint(_c10,idx1));}if(idx2<_c12){pt2=map.toScreen(_c0f.getPoint(_c10,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_c13,_c14){var _c15=[];var idx1=_c13-1;if(idx1>=0){_c15.push(idx1);}var idx2=_c13;if(idx2<_c14-1){_c15.push(idx2);}return _c15;},_getAdjacentVertices:function(_c16,_c17){return [_c16,_c16+1];},_deleteMidpoints:function(_c18){var _c19=_c18.segIndex,_c1a=_c18.ptIndex,_c1b=_c18.segLength;var _c1c=this._mpVertexMovers[_c19],_c1d=_c1c.length-1;var _c1e=this._getAdjacentMidpoints(_c1a,_c1b).sort();var i,min=_c1e[0];for(i=0;i<min;i++){_c1c[i].segLength-=1;}for(i=min+1;i<_c1c.length;i++){var mvr=_c1c[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_c1e.length===1){_c1c.splice(min,1)[0].destroy();}else{var _c1f=this._getAdjacentVertices(min,_c1d);var _c20=_c18.relatedGraphic.geometry.getPoint(_c18.segIndex,_c1f[0]);var _c21=_c18.relatedGraphic.geometry.getPoint(_c18.segIndex,_c1f[1]);var _c22=new _b9e({x:(_c20.x+_c21.x)/2,y:(_c20.y+_c21.y)/2,spatialReference:_c20.spatialReference.toJson()});var mvr1=new _b9d(_c22,this._symbol2,this.graphic,_c18.segIndex,min,_c1d,this,true);var _c23=_c1c.splice(min,_c1e.length,mvr1);for(i=0;i<_c23.length;i++){_c23[i].destroy();}}},_updateRelatedGraphic:function(_c24,_c25,_c26,_c27,_c28,_c29,add,del){var geom=_c25.geometry;if(add){geom.insertPoint(_c27,_c28+1,_b9f.fromJson(_c26.toJson()));}else{if(del){geom.removePoint(_c27,_c28);}else{geom.setPoint(_c27,_c28,_b9f.fromJson(_c26.toJson()));}}_c25.setGeometry(geom);}});GVE.PolygonVertexEditor=_b98(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_c2a){var i,j,_c2b=_c2a.rings,_c2c=[];for(i=0;i<_c2b.length;i++){var ring=_c2b[i],_c2d=[];for(j=0;j<ring.length-1;j++){_c2d.push(_c2a.getPoint(i,j));}_c2c.push(_c2d);}return _c2c;},_getMidpointSegments:function(_c2e){var i,j,_c2f=_c2e.rings,_c30=[],sr=_c2e.spatialReference;for(i=0;i<_c2f.length;i++){var ring=_c2f[i],_c31=[];for(j=0;j<ring.length-1;j++){var _c32=_c2e.getPoint(i,j),_c33=_c2e.getPoint(i,j+1);var midX=(_c32.x+_c33.x)/2,midY=(_c32.y+_c33.y)/2;var _c34=new _b9e({x:midX,y:midY,spatialReference:sr.toJson()});_c31.push(_c34);}_c30.push(_c31);}return _c30;},_getControlPoints:function(_c35,_c36,_c37,_c38,_c39){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_c35)){idx1=_c38;idx2=(_c38+1)%_c39;}else{idx1=_c38-1;idx1=idx1<0?(_c39+idx1)%_c39:idx1;idx2=(_c38+1)%_c39;}pt1=map.toScreen(_c36.getPoint(_c37,idx1));pt2=map.toScreen(_c36.getPoint(_c37,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_c3a,_c3b){var idx1=_c3a-1;idx1=idx1<0?(_c3b+idx1)%_c3b:idx1;var idx2=_c3a;return [idx1,idx2];},_getAdjacentVertices:function(_c3c,_c3d){return [_c3c,(_c3c+1)%_c3d];},_deleteMidpoints:function(_c3e){var _c3f=_c3e.segIndex,_c40=_c3e.ptIndex,_c41=_c3e.segLength;var _c42=this._mpVertexMovers[_c3f],_c43=_c42.length-1,_c44=this._getAdjacentMidpoints(_c40,_c41).sort(),_c45,_c46,_c47,_c48,i,mvr1,mvr,min=_c44[0],max=_c44[_c44.length-1];if(_c40===0){_c45=this._getAdjacentVertices(_c43-1,_c43);_c46=_c3e.relatedGraphic.geometry.getPoint(_c3e.segIndex,_c45[0]);_c47=_c3e.relatedGraphic.geometry.getPoint(_c3e.segIndex,_c45[1]);_c48=new _b9e({x:(_c46.x+_c47.x)/2,y:(_c46.y+_c47.y)/2,spatialReference:_c46.spatialReference.toJson()});mvr1=new _b9d(_c48,this._symbol2,this.graphic,_c3e.segIndex,_c43-1,_c43,this,true);_c42.splice(max,1,mvr1)[0].destroy();_c42.splice(min,1)[0].destroy();for(i=0;i<_c42.length-1;i++){mvr=_c42[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_c45=this._getAdjacentVertices(min,_c43);_c46=_c3e.relatedGraphic.geometry.getPoint(_c3e.segIndex,_c45[0]);_c47=_c3e.relatedGraphic.geometry.getPoint(_c3e.segIndex,_c45[1]);_c48=new _b9e({x:(_c46.x+_c47.x)/2,y:(_c46.y+_c47.y)/2,spatialReference:_c46.spatialReference.toJson()});mvr1=new _b9d(_c48,this._symbol2,this.graphic,_c3e.segIndex,min,_c43,this,true);var _c49=_c42.splice(min,_c44.length,mvr1);for(i=0;i<_c49.length;i++){_c49[i].destroy();}for(i=0;i<min;i++){_c42[i].segLength-=1;}for(i=min+1;i<_c42.length;i++){mvr=_c42[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_c4a,_c4b,_c4c,_c4d,_c4e,_c4f,add,del){var geom=_c4b.geometry;if(add){geom.insertPoint(_c4d,_c4e+1,_b9f.fromJson(_c4c.toJson()));}else{if(del){geom.removePoint(_c4d,_c4e);if(_c4e===0){geom.setPoint(_c4d,_c4f-1,_b9f.fromJson(geom.getPoint(_c4d,0).toJson()));}}else{geom.setPoint(_c4d,_c4e,_b9f.fromJson(_c4c.toJson()));if(_c4e===0){geom.setPoint(_c4d,_c4f,_b9f.fromJson(_c4c.toJson()));}}}_c4b.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_b9c);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_b9c);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_b9c);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_b9c);}return GVE;});},"*now":function(r){r(["dojo/i18n!*preload*esri/dijit/editing/nls/TemplatePicker-all*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/dijit/editing/TemplatePicker-all",["esri/layers/FeatureLayer","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/editing/TemplatePicker"],function(_c50,Draw,Edit,_c51){return {};});