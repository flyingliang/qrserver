{{template "header" .}}
 
{{with .device}}
<div class="container">
	 <div class="panel panel-info">
  <!-- Default panel contents -->
  <div class="panel-heading">设备详细信息</div>
  <div class="panel-body">
  
  <!--提示框-->
  <div  id="msg" class="alert alert-warning alert-dismissable" style="display:none">
     <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
     <p id="msgcontent"></p>
 </div>

 <form class="form-horizontal" role="form" action="/deviceparams/update/{{.SensorId}}" type="post">
 	 <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button id="refreshparams" type="button" class="btn btn-success">重新读取</button>
      &nbsp;&nbsp;
      <button id="setparams" type="button" class="btn btn-primary">设置参数</button>
      &nbsp;&nbsp;
      <button id="setsave" type="submit" class="btn btn-warning" style="display:none">保存设置</button>
    </div>
  </div>
{{with .SetParams}}
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SonsorId">传感器编号</label>
    <div class="col-sm-6">
      <input id="SensorId" type="text" class="form-control" name="SensorId"  placeholder="SensorId" value="{{.SensorId}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SiteName">站点名称</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SiteName" name="SiteName" placeholder="SiteName" value="{{.SiteName}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Longitude">经度</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Longitude" name="Longitude" placeholder="Longitude" value="{{.Longitude}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Latitude">纬度</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Latitude" name="Latitude" placeholder="Latitude" value="{{.Latitude}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SiteType">场地类型</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SiteType" name="SiteType" placeholder="SiteType" value="{{.SiteType}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="ObserveObject">观测对象</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="ObserveObject" name="ObserveObject" placeholder="ObserveObject" value="{{.ObserveObject}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Accelerometer">加速度计型号</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Accelerometer" name="Accelerometer" placeholder="Accelerometer" value="{{.Accelerometer}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Direction">安装方向</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Direction"  name="Direction" placeholder="Direction" value="{{.Direction}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="RangeType">量程选择</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="RangeType" name="RangeType" placeholder="RangeType" value="{{.RangeType}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Period">采样周期</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Period" name="Period" placeholder="Period" value="{{.Period}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="RegionCode">行政区划代码</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="RegionCode" name="RegionCode" placeholder="RegionCode" value="{{.RegionCode}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Custom1">预留1</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Custom1" name="Custom1" placeholder="Custom1" value="{{.Custom1}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="Custom2">预留2</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="Custom2" name="Custom2" placeholder="Custom2" value="{{.Custom2}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="PGATrigger">PGA触发</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="PGATrigger" name="PGATrigger" placeholder="PGATrigger" value="{{.PGATrigger}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="PGATrgThreshold">PGA阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="PGATrgThreshold" name="PGATrgThreshold" placeholder="PGATrgThreshold" value="{{.PGATrgThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SITrigger">SI触发</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SITrigger" name="SITrigger" placeholder="SITrigger" value="{{.SITrigger}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SITrgThreshold">SI阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SITrgThreshold" name="SITrgThreshold" placeholder="SITrgThreshold" value="{{.SITrgThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="CombTrigger">组合触发</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="CombTrigger" name="CombTrigger" placeholder="CombTrigger" value="{{.CombTrigger}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="ReserveTrigger">预留触发</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="ReserveTrigger" name="ReserveTrigger" placeholder="ReserveTrigger" value="{{.ReserveTrigger}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="ReserveTrgThreshold">预留阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="ReserveTrgThreshold" name="ReserveTrgThreshold" placeholder="ReserveTrgThreshold" value="{{.ReserveTrgThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="PGAAlert">PGA报警</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="PGAAlert" name="PGAAlert" placeholder="PGAAlert" value="{{.PGAAlert}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="PGAAlertThreshold">PGA报警阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="PGAAlertThreshold" name="PGAAlertThreshold" placeholder="PGAAlertThreshold" value="{{.PGAAlertThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SIAlert">SI报警</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SIAlert" name="SIAlert"  placeholder="SIAlert" value="{{.SIAlert}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="SIAlertThreshold">SI报警阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="SIAlertThreshold" name="SIAlertThreshold" placeholder="SIAlertThreshold" value="{{.SIAlertThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="CombAlert">组合报警</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="CombAlert" name="CombAlert" placeholder="CombAlert" value="{{.CombAlert}}" disabled>
    </div>
  </div>	
  <div class="form-group">
    <label class="col-sm-2 control-label" for="ReserveAlert">预留报警</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="ReserveAlert" name="ReserveAlert" placeholder="ReserveAlert" value="{{.ReserveAlert}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="ReserveAlertThreshold">预留报警阀值</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="ReserveAlertThreshold" name="ReserveAlertThreshold" placeholder="ReserveAlertThreshold" value="{{.ReserveAlertThreshold}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="DA1">DA输出1</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="DA1" name="DA1" placeholder="DA1" value="{{.DA1}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="DA2">DA输出2</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="DA2" name="DA2"  placeholder="DA2" value="{{.DA2}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="IO1">IO输出1</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="IO1" name="IO1" placeholder="IO1" value="{{.IO1}}" disabled>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-2 control-label" for="IO2">IO输出2</label>
    <div class="col-sm-6">
      <input type="text" class="form-control" id="IO2" name="IO2" placeholder="IO2" value="{{.IO2}}" disabled>
    </div>
  </div>
 
  {{end}}

</form>
</div>
</div>
</div>
{{template "scripts"}}

<script>
	$(document).ready(function(){
		
		{{if .Online}}
		//刷新参数按钮
    $('#refreshparams').bind('click', function() {
    	$('#refreshparams').attr('disabled',true);
      $.ajax({
             type: "GET",
             url: "/deviceparams/refresh/{{.SensorId}}",
             dataType:"json",
             //data: "name=John&location=Boston",
             success: function(json){
               if(json.Ok==true){
               	//读取成功后,刷新页面获取最新数据
               	 alert("成功读取");
               	 window.location.reload(true)
                }else{
                	$("#msgcontent").html(json.Msg)
             	    $('#msg').show()
                }
              },
             error: function(error) {
             	$("#msgcontent").html("读取参数失败,报告管理员")
             	$('#msg').show()
             }
           });
        $('#refreshparams').attr('disabled',false);  
    });

    //设置参数按钮
    var setchange=false;
    
    $("#setparams").bind('click',function(){
         $("#setsave").toggle();
         if(setchange==false){
         	setchange=true;
         	$("#setparams").text("取消设置");
         	$(":text").attr('disabled',false);
         	//$("#SensorId").attr('disabled',true);
        }else{
        	setchange=false;
         	$("#setparams").text("设置参数");
         	$(":text").attr('disabled',true);
        }
    });
    
  {{else}}
  	//不在线,不能执行操作
    $('#refreshparams').attr('disabled',true); 
    $('#setparams').attr('disabled',true);  
    
    $("#msgcontent").html("设备未连线,无法进行读写操作")
    $('#msg').show()
  {{end}}

 });
</script>
 
 {{end}}
{{template "footer"}}
